<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1280, user-scalable=yes" />
    <style>
    /* Lu√¥n gi·ªØ thanh cu·ªôn d·ªçc tr√™n to√†n trang */
    html {
      overflow-y: scroll;          /* √©p hi·ªÉn th·ªã thanh cu·ªôn */
      scrollbar-gutter: stable;    /* gi·ªØ b·ªë c·ª•c kh√¥ng b·ªã d·ªãch khi hi·ªán thanh cu·ªôn */
    }

    /* ƒê·∫£m b·∫£o body lu√¥n chi·∫øm ƒë·ªß chi·ªÅu cao */
    body {
      min-height: 100vh;}
	/* WebKit scrollbar styling (Chrome/Edge/Safari/Android) */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,.25); border-radius: 4px; }
::-webkit-scrollbar-track { background: transparent; }

  </style>
  <title>CVRO Succession Planning - Workshop Playbook</title>
  <!-- PNG fallback -->
<link rel="icon" type="image/png" href="./assets/Favicon-32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="./assets/Favicon-16.png" sizes="16x16" />

<!-- SVG (∆∞u ti√™n) -->
<link rel="icon" type="image/svg+xml" href="./assets/Favicon.svg?v=4" />

<!-- Safari pinned tab (t√πy ch·ªçn) -->
<link rel="mask-icon" href="./assets/Favicon.svg" color="#F68C2C">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { 'ashley-orange': '#F68C2C', 'ashley-orange-dark': '#E67A1A' } } }}
  </script>
  <style>
    body{box-sizing:border-box}
    .fade-in{animation:fadeIn .25s ease-in}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
	/* ·∫®n thanh cu·ªôn ngang ri√™ng cho ph·∫ßn header (v·∫´n c√≥ th·ªÉ cu·ªôn b·∫±ng ng√≥n tay) */
header .no-scrollbar::-webkit-scrollbar {
  display: none;
}
header .no-scrollbar {
  -ms-overflow-style: none; /* cho IE v√† Edge c≈© */
  scrollbar-width: none;    /* cho Firefox */
}

  </style>
</head>
<body class="bg-gray-50 font-sans">
  <!-- H·ªôp c√¢u h·ªèi b·∫£o m·∫≠t -->

<!-- Header -->
<header class="bg-white shadow-sm border-b sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex flex-nowrap justify-center items-center gap-4 h-16 overflow-x-auto whitespace-nowrap text-center no-scrollbar">


      <!-- Logo -->
      <div class="flex-shrink-0">
        <img src="assets/ahr-logo.png" alt="Asia Human Resources Logo" class="h-12">
      </div>

      <!-- Navigation -->
      <nav class="flex flex-wrap justify-center items-center space-x-4">
        <button data-tab="home" onclick="showTab('home', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium border-b-2 border-ashley-orange">Home</button>
        <button data-tab="framework" onclick="showTab('framework', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">Framework (6 Stages)</button>
        <button data-tab="tools" onclick="showTab('tools', event)" class="nav-tab text-gray-700 hover:text-ashley-orange px-3 py-2 text-sm font-medium">Management Hub</button>
      </nav>

      <!-- Extra Buttons -->
      <div class="flex flex-wrap justify-center items-center gap-2">
        <a
          data-link-id="video"
          href="#"
          target="_blank"
          class="inline-flex items-center gap-2 bg-white text-ashley-orange px-4 py-2 rounded-xl text-sm font-medium border border-ashley-orange hover:bg-ashley-orange hover:text-white transition whitespace-nowrap">
          üé• Program Overview
        </a>

        <a
          href="#"
          onclick="showQuestionModal(); return false;"
          class="inline-flex items-center gap-2 bg-white text-ashley-orange px-4 py-2 rounded-xl text-sm font-medium border border-ashley-orange hover:bg-ashley-orange hover:text-white transition whitespace-nowrap">
          ‚ùì I Have A Question!
        </a>
      </div>

      <!-- Search -->
      <button onclick="openSearchModal()" class="inline-flex bg-white border px-3 py-2 rounded-xl text-sm hover:bg-ashley-orange hover:text-white transition ml-2">
        üîé Search
      </button>

    </div>
  </div>
  <!-- Orange Divider (slightly thicker) -->
<div class="h-12 w-full bg-ashley-orange mt-1"></div>
</header>


  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

<!-- HOME TAB -->
<section id="home-tab" class="tab-content">
  <!-- ====== Header ====== -->
  <div class="text-center mb-10">
    <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
      CVRO Succession Planning ‚Äì Workshop Playbook
    </h1>
    <p class="text-lg text-gray-600 mb-2">
      Build a future-ready talent pipeline by empowering employees, ensuring business continuity, and minimizing transition risks.
    </p>
  </div>

<!-- ====== Framework Overview ====== -->
<div class="text-center mb-10">
  <h2 class="text-3xl font-bold text-ashley-orange mb-6">
    6 Key Stages in the Succession Planning Process
  </h2>

  <!-- 3-column layout: Left steps ‚Äì Image ‚Äì Right steps -->
  <div class="max-w-5xl mx-auto flex items-center justify-center gap-12 md:gap-16 mb-6">

    <!-- LEFT SIDE: Stage 1, 6, 5 (right aligned) -->
    <div class="flex-1 flex flex-col justify-between h-56 text-right items-end">
      <!-- Stage 1 -->
      <button type="button"
              onclick="goToFrameworkStep(1)"
              class="group text-right">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 1
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          Identify Critical Positions &amp;<br>
          Success Profile
        </p>
      </button>

      <!-- Stage 6 -->
      <button type="button"
              onclick="goToFrameworkStep(6)"
              class="group text-right">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 6
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          Continuous Review &amp;<br>
          Yearly Talent Pool Refresh
        </p>
      </button>

      <!-- Stage 5 -->
      <button type="button"
              onclick="goToFrameworkStep(5)"
              class="group text-right">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 5
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          Talent Review Presentation
        </p>
      </button>
    </div>

    <!-- CENTER: circle image -->
    <div class="flex-shrink-0">
      <img src="assets/circle.png"
           alt="Succession 2025 Circle"
           class="w-48 md:w-56 lg:w-60 h-auto mx-auto">
    </div>

    <!-- RIGHT SIDE: Stage 2, 3, 4 (left aligned) -->
    <div class="flex-1 flex flex-col justify-between h-56 text-left items-start">
      <!-- Stage 2 -->
      <button type="button"
              onclick="goToFrameworkStep(2)"
              class="group text-left">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 2
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          Identify Talent Pool
        </p>
      </button>

      <!-- Stage 3 -->
      <button type="button"
              onclick="goToFrameworkStep(3)"
              class="group text-left">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 3
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          Gap Assessment
        </p>
      </button>

      <!-- Stage 4 -->
      <button type="button"
              onclick="goToFrameworkStep(4)"
              class="group text-left">
        <p class="font-semibold text-gray-900 group-hover:text-ashley-orange transition">
          Stage 4
        </p>
        <p class="text-gray-800 text-sm leading-snug">
          IDP Execution ‚Äì Closing the GAP
        </p>
      </button>
    </div>
  </div>
  <p class="text-gray-700 max-w-3xl mx-auto mt-10">
    The succession planning process is designed as a <strong>6-Stage framework</strong>,
    <u>continuously improved</u> each year to stay aligned with organizational needs
    and to optimize process effectiveness.
  </p>
</div>

<!-- ====== Annual Succession Planning Circle ====== -->
<div class="text-center mt-16 mb-16">
  <h2 class="text-3xl font-bold text-ashley-orange mb-6">
    Annual Succession Planning Cycle
  </h2>
  <img src="assets/annual_circle.png" 
       alt="Annual Succession Planning Cycle" 
       class="mx-auto w-[80%] h-auto">
</div>


  <!-- ====== CTA Buttons ====== -->
  <div class="text-center flex flex-wrap gap-3 justify-center">
    <button onclick="showTab('framework', event)" 
      class="bg-white text-ashley-orange border-2 border-ashley-orange px-6 py-3 rounded-xl font-medium hover:bg-ashley-orange hover:text-white transition">
      üìã Framework Navigator
    </button>
    <button onclick="showTab('tools', event)" 
      class="bg-white text-ashley-orange border-2 border-ashley-orange px-6 py-3 rounded-xl font-medium hover:bg-ashley-orange hover:text-white transition">
      üìÅ Management Hub
    </button>
  </div>
</section>


   
    <!-- FRAMEWORK TAB -->
    <section id="framework-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">6‚ÄëStage Framework</h2>
        <p class="text-gray-600 mb-6">6 Key Stages Succession Planning Process</p>

        <!-- Stepper -->
        <div class="bg-white rounded-xl border p-6 mb-6">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center space-x-4">
              <div class="step-indicator w-8 h-8 bg-ashley-orange text-white rounded-full flex items-center justify-center text-sm font-bold">1</div>
              <div class="step-line w-16 h-1 bg-ashley-orange"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">2</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">3</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">4</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">5</div>
              <div class="step-line w-16 h-1 bg-gray-300"></div>
              <div class="step-indicator w-8 h-8 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold">6</div>
            </div>
            <div id="stepLabel" class="text-sm text-gray-500">Stage 1 of 6</div>
          </div>
          <div class="flex flex-wrap gap-2 mb-4">
            <button onclick="showStep(1, event)" class="step-btn bg-ashley-orange text-white px-3 py-1 rounded text-sm">Stage 1</button>
            <button onclick="showStep(2, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Stage 2</button>
            <button onclick="showStep(3, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Stage 3</button>
            <button onclick="showStep(4, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Stage 4</button>
            <button onclick="showStep(5, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Stage 5</button>
            <button onclick="showStep(6, event)" class="step-btn bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm">Stage 6</button>
          </div>
        </div>

        <!-- STAGE 1 CONTENT -->
        <div id="step-1" class="step-content">
          <div class="bg-white rounded-xl border p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">STAGE 1: Identify Critical Positions & Define Success Profile</h3>
            <p class="text-gray-600 mb-6">To ensure organizational continuity <strong>by identifying the most business-critical positions for succession planning</strong> and clearly <strong>defining the expectations</strong> for successors.</p>
            <div class="border-b mb-6">
              <nav class="flex flex-wrap gap-5">
                <button onclick="showStepTab('overview', event)" class="step-tab-btn border-b-2 border-ashley-orange text-ashley-orange py-2 px-1 text-sm font-medium">Overview</button>
                <button onclick="showStepTab('criteria', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Part A: Identify Critical Positions</button>
                <button onclick="showStepTab('profile', event)" class="step-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Part B: Define Success Profile for Selected Positions</button>
              </nav>
            </div>

<!-- Overview Tab -->
<div id="s1-overview-tab" class="step-tab-content">
  <div class="space-y-6">

    <!-- Header -->
    <div class="bg-white italic">
      <p class="text-sm text-gray-700"> Overview of Stage 1 to ensure continuity by identifying business-critical roles and defining clear success expectations.
      </p>
    </div>

    <!-- Part A -->
    <details class="group bg-orange-50 border-l-4 border-ashley-orange rounded-r-lg">
      <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
        <span class="font-semibold text-ashley-orange text-base flex items-center gap-2">
          üß≠ Part A ‚Äì Identify Critical Positions
        </span>
        <!-- Chevron -->
        <svg class="h-5 w-5 text-ashley-orange transition-transform duration-200 ease-out">
          <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
        </svg>
      </summary>
      <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
        <p class="mb-2">
    HoDs assess positions within their departments to identify which are <span class="font-medium">business-critical</span> for succession planning.  
    Each role is rated based on <span class="font-medium">five equally weighted criteria</span>:
  </p>
   <ul class="list-disc pl-5 space-y-1">
    <li>Succession Urgency & Internal Readiness</li>
    <li>Cost Efficiency (difficulty or cost of replacement)</li>
    <li>Leadership & Culture Impact</li>
    <li>Strategic Contribution</li>
    <li>Skill Scarcity & Market Competition</li>
  </ul>
<p class="mt-3 text-xs text-gray-700">
    Scoring note: Rate each criterion from 1 to 5.  
    The final score is the <span class="font-medium">average</span> of all five criteria (20% each).
  </p>
  </div>
    </details>

    <!-- Part B -->
    <details class="group bg-blue-50 border-l-4 border-blue-400 rounded-r-lg">
      <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
        <span class="font-semibold text-blue-700 text-base flex items-center gap-2">
          üéØ Part B ‚Äì Define Success Profile
        </span>
        <!-- Chevron -->
        <svg class="h-5 w-5 text-blue-600 transition-transform duration-200 ease-out">
          <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
        </svg>
      </summary>
      <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
        <p class="mb-2">
          Departments finalize the <span class="font-medium">Success Profile</span> for each selected role:
        </p>
        <ul class="list-disc pl-5 space-y-1">
          <li><span class="font-medium">Competency requirements:</span> leadership & technical skills (criteria in the Performance Evaluation System).</li>
          <li><span class="font-medium">Job qualifications:</span> education, experience, certifications, tools (from departmental JDs; consolidate into the template).</li>
        </ul>
        <p class="mt-3">
          The finalized profile serves as the benchmark for <span class="font-medium">Stage 3 ‚Äì Gap Assessment</span>.
        </p>
      </div>
    </details>

<!-- STAGE 1 summary line -->
<div class="border-2 border-ashley-orange rounded-2xl p-4 bg-white text-sm text-gray-800 shadow-sm">
  <span class="font-bold text-ashley-orange">Part A clarifies</span>
  <span class="font-bold"> which positions should be prioritized for succession</span>;
  <span class="font-bold text-blue-700"> Part B defines</span>
  <span class="font-bold"> what successors are expected to grow toward.</span>
</div>
</div>
<!-- Scoped styles for chevron rotation (no impact to other tabs) -->
<style>
  #s1-overview-tab details[open] > summary svg { transform: rotate(180deg); }
</style>
</div>
<!-- Part A: Identify Critical Positions -->
<div id="s1-criteria-tab" class="step-tab-content hidden">
  <div class="space-y-6">
    <div>
      <p class="font-semibold text-gray-700 text-base mb-4">
        CVRO Department Heads (HOD) are responsible for evaluating positions within their teams 
		using below criteria:
      </p>
    </div>

<!-- Section Title -->
<h2 class="text-xl font-semibold text-[#F68C2C]">üìä CVRO Customized Position Evaluation Criteria (Equal 20% each)</h2>

<!-- 5 Info Boxes with Popovers -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">

  <!-- Box 1 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-succession', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Succession Urgency & Internal Readiness (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-succession"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How soon will this role likely be vacant, and is there an internal successor ready?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> ‚Äì Vacancy ve		y likely within months (retirement, resignation, promotion, transfer) and no successor ready.</li>
        <li><b>4</b> ‚Äì Vacancy likely within 6‚Äì12 months;  successor exists but needs significant development.</li>
        <li><b>3</b> ‚Äì Vacancy possible in 1‚Äì2y, successor exists but needs moderate upskilling.</li>
        <li><b>2</b> ‚Äì No planned change but medium risk; candidate nearly ready.</li>
        <li><b>1</b> ‚Äì Stable long-term, no anticipated change; candidate fully ready.</li>
      </ul>
    </div>
  </div>

  <!-- Box 2 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-cost', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Cost Efficiency (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-cost"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">(How much cost is saved internally vs external? (including ramp-up & hidden costs)?)</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> ‚Äì Internal saves huge cost, minimal ramp-up.</li>
        <li><b>4</b> ‚Äì Noticeable saving, moderate training cost.</li>
        <li><b>3</b> ‚Äì Moderate saving, some training cost.</li>
        <li><b>2</b> ‚Äì Slight saving, low training cost.</li>
        <li><b>1</b> ‚Äì No cost advantage; same as external.</li>
      </ul>
    </div>
  </div>

  <!-- Box 3 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-leadership', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Leadership & Culture Impact (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-leadership"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How strongly does this role inspire, influence, and shape company values, leadership culture, and team aspiration?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> ‚Äì Critical leadership role with strong influence on company values, leadership culture, and team aspiration. Inspires and motivates across the organization.</li>
        <li><b>4</b> ‚Äì Strong influence on department‚Äôs leadership culture and maintaining motivation.</li>
        <li><b>3</b> ‚Äì Moderate leadership/culture influence; role models desired behaviors.</li>
        <li><b>2</b> ‚Äì Minor leadership/culture influence; helps maintain team stability.</li>
        <li><b>1</b> ‚Äì Minimal influence.</li>
      </ul>
    </div>
  </div>

  <!-- Box 4 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-strategy', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Strategic Contribution (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-strategy"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">If vacant, how would it affect company‚Äôs strategy?</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> ‚Äì Cross-department, multi-functional strategic impact.</li>
        <li><b>4</b> ‚Äì Significant impact on one major department.</li>
        <li><b>3</b> ‚Äì Manageable impact, limited to certain areas.</li>
        <li><b>2</b> ‚Äì Minor or indirect impact.</li>
        <li><b>1</b> ‚Äì Minimal or negligible impact.</li>
      </ul>
    </div>
  </div>

  <!-- Box 5 -->
  <div class="help-wrap relative">
    <button type="button"
            onclick="toggleHelp('pop-scarcity', event)"
            class="w-full h-full text-left bg-white border rounded-xl p-4 hover:shadow-md transition flex flex-col justify-between">
      <div class="flex items-center justify-between mb-2">
        <h5 class="font-semibold text-gray-900 text-sm">
          Skill Scarcity & Market Competition (20%)
        </h5>
        <span class="text-ashley-orange font-bold text-base leading-none">?</span>
      </div>
      <p class="text-xs text-gray-500">Click to view details</p>
    </button>
    <div id="pop-scarcity"
         class="score-help hidden absolute left-0 top-full mt-2 w-80 bg-white border rounded-lg shadow-lg p-3 z-50">
      <p class="text-xs font-semibold mb-2">How rare are the skills required for this role, and how difficult is it to hire externally?)</p>
      <ul class="text-xs text-gray-700 space-y-1">
        <li><b>5</b> ‚Äì Highly specialized skills, extremely hard to hire externally.</li>
        <li><b>4</b> ‚Äì Rare, difficult to hire.</li>
        <li><b>3</b> ‚Äì Moderate availability.</li>
        <li><b>2</b> ‚Äì Common, easy to hire.</li>
        <li><b>1</b> ‚Äì Very common skills.</li>
      </ul>
    </div>
  </div>
</div>

<!-- Script -->
<script>
  function toggleHelp(id, e){
    if (e) e.stopPropagation();
    document.querySelectorAll('.score-help').forEach(el=>{
      if(el.id!==id) el.classList.add('hidden');
    });
    const el=document.getElementById(id);
    if(el) el.classList.toggle('hidden');
  }
  document.addEventListener('click', (ev)=>{
    if(!ev.target.closest('.help-wrap')){
      document.querySelectorAll('.score-help').forEach(el=>el.classList.add('hidden'));
    }
  });
</script>
  <!-- 4 box ph√¢n lo·∫°i -->
  <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
      <h4 class="font-bold text-red-900 mb-1">1. Critical Role</h4>
      <p class="text-red-800 text-sm mb-2">‚â•4.2 points</p>
      <p class="text-red-700 text-xs">Need to have the strategic consideration from top leadership.</p>
    </div>
    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
      <h4 class="font-bold text-orange-900 mb-1">2. High Importance</h4>
      <p class="text-orange-800 text-sm mb-2">3.5‚Äì4.19 points</p>
      <p class="text-orange-700 text-xs">Requires successor planning application.</p>
    </div>
    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
      <h4 class="font-bold text-yellow-900 mb-1">3. Moderate Importance</h4>
      <p class="text-yellow-800 text-sm mb-2">2.8‚Äì3.49 points</p>
      <p class="text-yellow-700 text-xs">Important but not urgent; succession planning optional.</p>
    </div>
    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
      <h4 class="font-bold text-green-900 mb-1">4. Low Importance</h4>
      <p class="text-green-800 text-sm mb-2">&lt;2.8 points</p>
      <p class="text-green-700 text-xs">Less critical at this stage</p>
    </div>
  </div>

  <div class="mt-4 bg-blue-50 p-4 rounded-lg">
    <p class="text-blue-800 text-sm"><strong>Note:</strong> HoDs may flex classifications with documented rationale.</p>
  </div>


<!-- ===================== Department Scoring Calculator (as its own bordered card) ===================== -->
<section id="s1-calculator" class="mt-8 border-2 border-gray-300 rounded-2xl bg-white overflow-hidden">
  <!-- Header c·ªßa card -->
  <div class="px-5 py-4 border-b-2 border-gray-200 flex flex-col sm:flex-row justify-between gap-2 sm:items-center">
    <div class="flex items-center gap-3">
      <span class="inline-flex items-center justify-center w-8 h-8 rounded-lg bg-ashley-orange text-white text-lg">üìä</span>
      <div>
        <h2 class="text-lg font-semibold text-gray-900">Department Scoring Calculator</h2>
        <p class="text-xs text-gray-500">Part A ‚Äì Identify Critical Positions</p>
      </div>
    </div>

    <div class="flex items-center gap-3 flex-wrap">
      <label class="inline-flex items-center gap-2 text-sm text-gray-700">
        <input id="openEmailCheckbox" type="checkbox" class="h-4 w-4 rounded border-gray-300" checked>
        üìß Open email draft after export
      </label>
      <button id="btnExportXLSX"
              class="px-4 py-2 rounded-xl bg-ashley-orange text-white hover:bg-ashley-orange-dark transition">
        ‚¨á Download Excel
      </button>
      <button id="btnEmailAHR"
              class="px-4 py-2 rounded-xl bg-white border text-gray-700 hover:bg-gray-100 transition">
        ‚úâÔ∏è Email AHR
      </button>
    </div>
  </div>

  <!-- Body c·ªßa card -->
  <div class="p-5">
    <!-- Department selector -->
    <div class="flex flex-col sm:flex-row gap-3 items-start sm:items-center mb-4">
      <label class="text-sm font-medium text-gray-700">Select Department</label>
      <select id="deptSelect"
              class="border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-300 min-w-64">
        <option value="" selected disabled>‚Äî Loading departments‚Ä¶ ‚Äî</option>
      </select>
      <div class="flex items-center gap-2">
        <button id="btnAddRow"
                class="px-4 py-2 rounded-xl bg-white border text-gray-700 hover:bg-gray-100 transition">
          ‚ûï Add Role
        </button>
        <button id="btnReset"
                class="px-4 py-2 rounded-xl bg-white border text-gray-700 hover:bg-gray-100 transition">
          ‚ôª Reset
        </button>
      </div>
    </div>

    <!-- Table wrapper -->
    <div class="overflow-x-auto border rounded-2xl">
      <table class="min-w-[1000px] w-full text-sm bg-white">
        <thead class="bg-gray-50">
          <tr class="text-gray-800">
            <th class="px-3 py-3 text-center w-5 bg-orange-50">No.</th>
            <th class="px-3 py-3 text-center w-40 bg-orange-50">Role</th>
            <th class="px-3 py-3 text-center bg-orange-50">Succession Urgency &<br/>Internal Readiness</th>
            <th class="px-3 py-3 text-center bg-orange-50">Cost Efficiency</th>
            <th class="px-3 py-3 text-center bg-orange-50">Leadership & Culture<br/>Impact</th>
            <th class="px-3 py-3 text-center bg-orange-50">Strategic Impact</th>
            <th class="px-3 py-3 text-center bg-orange-50">Skill Scarcity & External<br/>Hiring Difficulty</th>
            <th class="px-3 py-3 text-center w-30 text-[#F68C2C] bg-orange-50">Total</th>
            <th class="px-3 py-3 text-center w-30 text-[#F68C2C] bg-orange-50">Result</th>
            <th class="px-3 py-3 text-center w-30 text-[#F68C2C] bg-orange-50">Include in Succession Planning?</th>
            <th class="px-3 py-3 text-center w-50 text-[#F68C2C] bg-orange-50">HoD Adjustment Rationale</th>
            <th class="px-3 py-3 text-center bg-orange-50">Remove?</th>
          </tr>
        </thead>
        <tbody id="scoreRows"></tbody>
      </table>
    </div>

    <p class="text-xs text-gray-500 mt-3">
      * Score per criterion: 1‚Äì5. Total score = average of the 5 criteria (20% weight each).
    </p>
  </div>
</section>

<!-- ========== JS cho Official Scoring Table (THAY C·∫¢ PH·∫¶N N√ÄY) ========== -->
<!-- SheetJS (xu·∫•t Excel) -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
  /* ========= 1) Data model (auto-load from ./assets) ========= */
  // K·ª≥ v·ªçng 1 trong 2 file t·ªìn t·∫°i trong ./assets/:
  //   a) dept_roles.json
  //      - D·∫°ng 1 (object): { "ahr": { "name":"Asia Human Resources", "roles":[...] }, ... }
  //      - D·∫°ng 2 (array):  [ { "code":"ahr","name":"Asia Human Resources","roles":[...] }, ... ]
  //   b) departments_roles.csv  (fallback n·∫øu kh√¥ng c√≥ JSON)
  //      Header: code,name,role
  //      Nhi·ªÅu d√≤ng role cho c√πng 1 code/name
  //
  // V√≠ d·ª• CSV:
  // code,name,role
  // ahr,Asia Human Resources,Senior Team Leader of Human Resources
  // ahr,Asia Human Resources,Talent Development Project Leader
  // ...

  let DEPT_MAP = {};  // { code: { name: string, roles: string[] } }

  async function loadDeptData() {
    // ∆Øu ti√™n JSON
    try {
      const r = await fetch('./assets/dept_roles.json', { cache: 'no-store' });
      if (r.ok) {
        const data = await r.json();
        if (Array.isArray(data)) {
          // array: [{code,name,roles}]
          data.forEach(d => {
            if (!d?.code) return;
            DEPT_MAP[d.code] = { name: d.name ?? d.code, roles: Array.isArray(d.roles) ? d.roles : [] };
          });
        } else if (data && typeof data === 'object') {
          // object map
          Object.entries(data).forEach(([code, val]) => {
            if (!code) return;
            const name = val?.name ?? code;
            const roles = Array.isArray(val?.roles) ? val.roles : [];
            DEPT_MAP[code] = { name, roles };
          });
        }
      } else {
        throw new Error('dept_roles.json not found');
      }
    } catch (e) {
      // Fallback: CSV
      await loadDeptDataFromCSV('./assets/departments_roles.csv');
    }

    // N·∫øu v·∫´n r·ªóng ‚Üí g·∫Øn t·∫°m ƒë·ªÉ trang kh√¥ng l·ªói
    if (!Object.keys(DEPT_MAP).length) {
      console.warn('No dept data found in ./assets. Please add dept_roles.json or departments_roles.csv');
    }

    hydrateDeptSelect();
  }

  async function loadDeptDataFromCSV(url) {
    try {
      const r = await fetch(url, { cache: 'no-store' });
      if (!r.ok) throw new Error('CSV not found');
      const text = await r.text();
      parseDeptCSV(text);
    } catch (e) {
      console.warn('CSV load failed:', e);
    }
  }

  function parseDeptCSV(csvText) {
    const lines = csvText.split(/\r?\n/).filter(l => l.trim().length);
    if (!lines.length) return;
    // l·∫•y header
    const header = lines[0].split(',').map(h => h.trim().toLowerCase());
    const idxCode = header.indexOf('code');
    const idxName = header.indexOf('name');
    const idxRole = header.indexOf('role');
    if (idxCode < 0 || idxName < 0 || idxRole < 0) {
      console.warn('CSV header must include code,name,role');
      return;
    }
    for (let i = 1; i < lines.length; i++) {
      const cols = splitCSVLine(lines[i]);
      const code = (cols[idxCode] || '').trim();
      const name = (cols[idxName] || '').trim() || code;
      const role = (cols[idxRole] || '').trim();
      if (!code || !role) continue;
      if (!DEPT_MAP[code]) DEPT_MAP[code] = { name, roles: [] };
      if (!DEPT_MAP[code].roles.includes(role)) DEPT_MAP[code].roles.push(role);
      // n·∫øu name kh√°c tr∆∞·ªõc th√¨ c·∫≠p nh·∫≠t theo d√≤ng CSV m·ªõi nh·∫•t
      DEPT_MAP[code].name = name || DEPT_MAP[code].name;
    }
  }

  // parser CSV ƒë∆°n gi·∫£n (h·ªó tr·ª£ d·∫•u ph·∫©y trong "...")
  function splitCSVLine(line) {
    const out = [];
    let cur = '', inQ = false;
    for (let i = 0; i < line.length; i++) {
      const ch = line[i];
      if (ch === '"') {
        if (inQ && line[i+1] === '"') { cur += '"'; i++; }
        else inQ = !inQ;
      } else if (ch === ',' && !inQ) {
        out.push(cur); cur = '';
      } else {
        cur += ch;
      }
    }
    out.push(cur);
    return out;
  }

  function hydrateDeptSelect() {
    const sel = document.getElementById('deptSelect');
    if (!sel) return;
    sel.innerHTML = '<option value="" selected disabled>‚Äî Choose a department ‚Äî</option>';

    const entries = Object.entries(DEPT_MAP).sort((a, b) => a[1].name.localeCompare(b[1].name, 'en'));
    entries.forEach(([code, v]) => {
      const opt = document.createElement('option');
      opt.value = code;
      opt.textContent = v.name || code;
      sel.appendChild(opt);
    });
  }

  /* ========= 2) Ph√¢n lo·∫°i ========= */
  function classify(score){
    if (score >= 4.2)  return {label:'Critical Role',       bg:'bg-red-50',    text:'text-red-800',    border:'border-red-500'};
    if (score >= 3.5)  return {label:'High Importance',     bg:'bg-orange-50', text:'text-orange-800', border:'border-orange-500'};
    if (score >= 2.8)  return {label:'Moderate Importance', bg:'bg-yellow-50', text:'text-yellow-800', border:'border-yellow-500'};
    return               {label:'Low Importance',           bg:'bg-green-50',  text:'text-green-800',  border:'border-green-500'};
  }

  /* ========= 3) Include cell ========= */
  function renderIncludeCell(tr, label){
    const cell = tr.querySelector('.include-cell');
    if (!cell) return;
    cell.innerHTML = '';
    if (!label) return;

    if (label === 'Low Importance'){
      cell.innerHTML = `<span class="text-gray-400 text-base select-none">‚úñ</span>`;
      const rat = tr.querySelector('.rationale-input');
      const warn = tr.querySelector('.rationale-warn');
      if (rat){ rat.disabled = true; rat.value=''; rat.classList.remove('border-red-400','ring-1','ring-red-300'); }
      tr.classList.remove('bg-red-50'); warn?.classList.add('hidden');
      return;
    }
    const checked = (label === 'High Importance') ? 'checked' : '';
    cell.innerHTML = `<input type="checkbox" class="include-checkbox h-4 w-4" ${checked}>`;
    const rat = tr.querySelector('.rationale-input');
    if (rat){ rat.disabled = false; }
    const cb = cell.querySelector('.include-checkbox');
    if (cb){ cb.addEventListener('change', () => requireRationaleIfIncluded(tr)); }
  }

  function requireRationaleIfIncluded(tr){
    const cb   = tr.querySelector('.include-checkbox');
    const rat  = tr.querySelector('.rationale-input');
    const warn = tr.querySelector('.rationale-warn');
    const resultText = tr.querySelector('.result-pill')?.textContent.trim();

    if (!cb){
      tr.classList.remove('bg-red-50');
      warn?.classList.add('hidden');
      if (rat){ rat.disabled = true; rat.value=''; rat.classList.remove('border-red-400','ring-1','ring-red-300'); }
      return;
    }
    if (rat) rat.disabled = false;

    const exempt  = (resultText === 'High Importance');
    const needWarn = cb.checked && !exempt && (!rat?.value || !rat.value.trim());

    if (needWarn){
      tr.classList.add('bg-red-50');
      warn?.classList.remove('hidden');
      rat?.classList.add('border-red-400','ring-1','ring-red-300');
    } else {
      tr.classList.remove('bg-red-50');
      warn?.classList.add('hidden');
      rat?.classList.remove('border-red-400','ring-1','ring-red-300');
    }
  }

  function clampTo1to5(inp){
    const raw = String(inp.value).trim();
    if (raw === '') return null;
    let n = Math.round(parseFloat(raw));
    if (isNaN(n)) { inp.value = ''; return null; }
    if (n < 1) n = 1;
    if (n > 5) n = 5;
    inp.value = n;
    return n;
  }

  function recomputeRow(tr){
    const inputs = Array.from(tr.querySelectorAll('.score-input'));
    const values = inputs.map(inp => clampTo1to5(inp));
    const valid  = values.every(v => v !== null);

    const totalEl = tr.querySelector('.total-cell');
    const pill    = tr.querySelector('.result-pill');

    if (valid){
      const avg = (values.reduce((a,b)=>a+b,0) / 5);
      totalEl.textContent = avg.toFixed(2);
      const c = classify(avg);
      pill.textContent = c.label;
      pill.className   = `result-pill inline-block px-2 py-1 rounded border text-xs ${c.bg} ${c.text} ${c.border}`;
      renderIncludeCell(tr, c.label);
    } else {
      totalEl.textContent = '‚Äî';
      pill.textContent    = '‚Äî';
      pill.className      = 'result-pill inline-block px-2 py-1 rounded border text-xs';
      renderIncludeCell(tr, null);
      tr.classList.remove('bg-red-50');
      tr.querySelector('.rationale-warn')?.classList.add('hidden');
      tr.querySelector('.rationale-input')?.classList.remove('border-red-400','ring-1','ring-red-300');
    }
    requireRationaleIfIncluded(tr);
  }
function autosizeRole(el) {
  el.style.height = 'auto';
  el.style.height = el.scrollHeight + 'px';
}
function autosizeAllRoles(){
  document.querySelectorAll('#scoreRows .role-input, #scoreRows .rationale-input')
    .forEach(ta => autosizeRole(ta));
}

function attachDelegatedHandlers(){
  const tbody = document.getElementById('scoreRows');
  if (!tbody) return;

tbody.addEventListener('input', e => {
  const t = e.target;
  if (t.classList.contains('role-input')) {
    autosizeRole(t);
    saveDebounced();
  }
  if (t.classList.contains('score-input')){
    clampTo1to5(t);
    const tr = t.closest('tr'); if (tr) recomputeRow(tr);
    saveDebounced();
  }
  if (t.classList.contains('rationale-input')){
  autosizeRole(t);  // NEW: t·ª± gi√£n
  const tr = t.closest('tr'); if (tr) requireRationaleIfIncluded(tr);
  saveDebounced();
}
});

  tbody.addEventListener('change', e => {
  const t = e.target;
  if (t.classList.contains('score-input')){
    clampTo1to5(t);
    const tr = t.closest('tr'); if (tr) recomputeRow(tr);
    saveDebounced();
  }
  if (t.classList.contains('rationale-input') || t.classList.contains('include-checkbox')){
    const tr = t.closest('tr'); if (tr) requireRationaleIfIncluded(tr);
    saveDebounced();
  }
});


  tbody.addEventListener('wheel', e => {
    if (e.target && e.target.classList.contains('score-input')) e.preventDefault();
  }, { passive:false });

  // ===== NEW: Click th√πng r√°c xo√° d√≤ng (ƒë·∫∑t ƒê√öNG CH·ªñ) =====
  tbody.addEventListener('click', e => {
  const btn = e.target.closest('.btn-del-row');
  if (!btn) return;
  const tr = btn.closest('tr');
  if (tr) {
    tr.remove();
    renumberRows();
    saveDebounced();
  }
});
}

  // ===== NEW: Helpers t·∫°o/xo√°/ƒë√°nh s·ªë d√≤ng =====
function createRow(role = '', index = 0) {
  const tr = document.createElement('tr');
  tr.className = 'border-t align-top';
  tr.innerHTML = `
    <td class="px-3 py-2 text-gray-600 row-index">${index}</td>
<td class="px-3 py-2 align-top">
  <textarea
  class="role-input w-full border rounded-lg px-2 py-1 leading-snug whitespace-pre-wrap break-words resize-none overflow-hidden min-h-[38px]"
  rows="1"
  placeholder="Enter position name...">${role}</textarea>

</td>
    ${[1,2,3,4,5].map(() => `
      <td class="px-2 py-2">
        <input type="number" min="1" max="5" step="1" inputmode="numeric"
               class="score-input w-20 text-center border rounded-lg px-2 py-1" placeholder="1‚Äì5">
      </td>`).join('')}
    <td class="px-3 py-2 text-center font-semibold"><span class="total-cell">‚Äî</span></td>
    <td class="px-3 py-2"><div class="result-pill inline-block px-2 py-1 rounded border text-xs">‚Äî</div></td>
    <td class="px-3 py-2 text-center include-cell"></td>
    <td class="px-3 py-2">
      <div class="space-y-1">
        <textarea
  class="rationale-input w-full border rounded-lg px-2 py-1 leading-snug whitespace-pre-wrap break-words resize-none overflow-hidden min-h-[38px]"
  rows="2"
  placeholder="Add note‚Ä¶"></textarea>
        <p class="rationale-warn hidden text-xs text-red-600">Rationale required when included.</p>
      </div>
    </td>
    <td class="px-3 py-2 text-center">
      <button type="button" class="btn-del-row text-gray-400 hover:text-red-600" title="Delete row">üóëÔ∏è</button>
    </td>
  `;
  recomputeRow(tr);
  return tr;
}

function renumberRows() {
  document.querySelectorAll('#scoreRows tr .row-index').forEach((td, i) => {
    td.textContent = i + 1;
  });
}
// ===== NEW: LocalStorage helpers =====
const STORAGE_PREFIX = 'SP_CALC_V1_';
const getKey = (code) => STORAGE_PREFIX + (code || 'unknown');

function saveState(deptCode){
  const data = [];
  document.querySelectorAll('#scoreRows tr').forEach(tr => {
    const role = tr.querySelector('.role-input')?.value.trim() || '';
    if (!role) return;
    const scores = Array.from(tr.querySelectorAll('.score-input'))
                    .map(i => i.value === '' ? null : Number(i.value));
    const includeCb = tr.querySelector('.include-checkbox');
    const include = includeCb ? !!includeCb.checked : null;
    const rationale = tr.querySelector('.rationale-input')?.value || '';
    data.push({ role, scores, include, rationale });
  });
  try { localStorage.setItem(getKey(document.getElementById('deptSelect')?.value), JSON.stringify(data)); } catch(e){}
}

function loadState(deptCode){
  try {
    const raw = localStorage.getItem(getKey(deptCode));
    if (!raw) return null;
    const arr = JSON.parse(raw);
    return Array.isArray(arr) ? arr : null;
  } catch(e){ return null; }
}

function clearState(deptCode){
  try { localStorage.removeItem(getKey(deptCode)); } catch(e){}
}

// Debounce ƒë·ªÉ tr√°nh ghi li√™n t·ª•c
let __saveTimer = null;
function saveDebounced(){
  const code = document.getElementById('deptSelect')?.value;
  if (!code) return;
  clearTimeout(__saveTimer);
  __saveTimer = setTimeout(() => saveState(code), 300);
}
// ===== NEW: Nh·ªõ ph√≤ng ban l·∫ßn cu·ªëi =====
const LAST_DEPT_KEY = 'SP_CALC_LAST_DEPT';

function addRoleRow(roleName = '') {
  const tbody = document.getElementById('scoreRows');
  const tr = createRow(roleName, (tbody.children.length + 1));
  tbody.appendChild(tr);
  const ta = tr.querySelector('.role-input');
if (ta) requestAnimationFrame(() => autosizeRole(ta));
const rat = tr.querySelector('.rationale-input');              // NEW
if (rat) requestAnimationFrame(() => autosizeRole(rat));       // NEW
renumberRows();
saveDebounced();
}

function renderRoles(deptCode){
  const dept = DEPT_MAP[deptCode];
  const rolesFromCSV = dept?.roles || [];
  const tbody = document.getElementById('scoreRows');
  if (!tbody) return;

  const saved = loadState(deptCode);
  tbody.innerHTML = '';

  const rowsToRender = (saved && saved.length) ? saved
                     : rolesFromCSV.map(r => ({ role: r, scores:[null,null,null,null,null], include:null, rationale:'' }));

  rowsToRender.forEach((item, idx) => {
    const tr = createRow(item.role, idx + 1);
    tbody.appendChild(tr);

    // G√°n ƒëi·ªÉm ƒë√£ l∆∞u
    const scoreInputs = tr.querySelectorAll('.score-input');
    (item.scores || []).forEach((v, i) => {
      if (v !== null && scoreInputs[i]) scoreInputs[i].value = v;
    });

    // T√≠nh l·∫°i ƒë·ªÉ hi·ªán Total & Result
    recomputeRow(tr);

    // G√°n include ƒë√£ l∆∞u (n·∫øu c√≥)
    if (item.include === true) {
      const cb = tr.querySelector('.include-checkbox');
      if (cb) cb.checked = true;
    }

    // G√°n rationale ƒë√£ l∆∞u
const rat = tr.querySelector('.rationale-input');
if (rat && item.rationale) rat.value = item.rationale;
// autosize ngay sau khi set value
if (rat) requestAnimationFrame(() => autosizeRole(rat));


    // Autosize Role textarea
    const ta = tr.querySelector('.role-input');
    if (ta) requestAnimationFrame(() => autosizeRole(ta));
  });

  renumberRows();
  requestAnimationFrame(autosizeAllRoles);
}

 // ========= Init =========
  document.addEventListener('DOMContentLoaded', () => {
    attachDelegatedHandlers();
// ===== Add Role + Reset + Dept change
const btnAdd = document.getElementById('btnAddRow');
if (btnAdd) {
  btnAdd.addEventListener('click', () => addRoleRow(''));
}

const btnReset = document.getElementById('btnReset');
if (btnReset){
  btnReset.addEventListener('click', () => {
    const code = document.getElementById('deptSelect')?.value;
    if (!code) return;
    clearState(code);          // xo√° d·ªØ li·ªáu ƒë√£ l∆∞u
    renderRoles(code);         // render l·∫°i t·ª´ CSV/JSON g·ªëc
    requestAnimationFrame(autosizeAllRoles);
  });
}


const deptSelect = document.getElementById('deptSelect');
if (deptSelect){
  deptSelect.addEventListener('change', (e) => {
    const code = e.target.value;
    try { localStorage.setItem(LAST_DEPT_KEY, code); } catch(e){}
    renderRoles(code);                  // ∆∞u ti√™n load t·ª´ LocalStorage n·∫øu c√≥
    requestAnimationFrame(autosizeAllRoles);
  });
}



    loadDeptData(); // n·∫°p d·ªØ li·ªáu ph√≤ng ban
// Khi load xong danh s√°ch dept (hydrateDeptSelect ƒë√£ ƒëi·ªÅn options),
// t·ª± ch·ªçn l·∫°i ph√≤ng ban cu·ªëi c√πng n·∫øu c√≥ v√† render ngay.
const tryRestoreDept = () => {
  const sel = document.getElementById('deptSelect');
  if (!sel || !Object.keys(DEPT_MAP).length) return;

  // 1) l·∫•y dept l·∫ßn cu·ªëi
  let code = null;
  try { code = localStorage.getItem(LAST_DEPT_KEY) || null; } catch(e){}

  // 2) n·∫øu c√≥ v√† t·ªìn t·∫°i trong DEPT_MAP -> set select + render
  if (code && DEPT_MAP[code]) {
    sel.value = code;
    renderRoles(code);
    requestAnimationFrame(autosizeAllRoles);
    return;
  }

  // (t√πy ch·ªçn) n·∫øu mu·ªën auto ch·ªçn dept ƒë·∫ßu ti√™n khi ch∆∞a c√≥ l·ª±a ch·ªçn tr∆∞·ªõc ƒë√≥:
  // const first = Object.keys(DEPT_MAP)[0];
  // if (first) { sel.value = first; renderRoles(first); requestAnimationFrame(autosizeAllRoles); }
};

// V√¨ loadDeptData() l√† async (fetch JSON/CSV), ta ƒë·ª£i m·ªôt "tick" ƒë·ªÉ hydrate xong select:
setTimeout(tryRestoreDept, 0);

  // Export Excel + m·ªü Outlook (n·∫øu checkbox b·∫≠t)
  (function () {
    const btnExport = document.getElementById('btnExportXLSX');
    if (!btnExport) return;

    btnExport.addEventListener('click', () => {
      const deptEl   = document.getElementById('deptSelect');
      const deptKey  = deptEl?.value || 'Department';
      const deptName = (window.DEPT_MAP?.[deptKey]?.name)
                    || (deptEl?.options[deptEl.selectedIndex]?.text)
                    || 'Department';

      // Thu d·ªØ li·ªáu b·∫£ng
      const rows = [];
      let totalRoles = 0;
      let includedCount = 0;

      document.querySelectorAll('#scoreRows tr').forEach(tr => {
        const role = tr.querySelector('.role-input')?.value.trim()
           || tr.querySelector('.role-cell')?.textContent.trim()
           || '';

        if (!role) return;
        totalRoles++;

        const scores = Array.from(tr.querySelectorAll('.score-input')).map(i => i.value || '');
        const total  = tr.querySelector('.total-cell')?.textContent || '';
        const result = tr.querySelector('.result-pill')?.textContent || '';
        const includeCb = tr.querySelector('.include-checkbox');
        const include = includeCb ? (includeCb.checked ? 'Yes' : 'No')
                      : (tr.querySelector('.include-cell')?.textContent.trim() === '‚úñ' ? 'Not allowed (Low)' : '');
        const rationale = tr.querySelector('.rationale-input')?.value || '';

        if (include === 'Yes') includedCount++;

        rows.push({
          Department: deptName,
          Role: role,
          'Succession Urgency (1-5)': scores[0],
          'Cost Efficiency (1-5)':     scores[1],
          'Leadership & Culture (1-5)':scores[2],
          'Strategic Impact (1-5)':    scores[3],
          'Skill Scarcity (1-5)':      scores[4],
          Total: total,
          Result: result,
          'Include in Succession Planning?': include,
          'HoD Adjustment Rationale': rationale
        });
      });

      // T·∫°o file Excel
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(rows);
      XLSX.utils.book_append_sheet(wb, ws, 'Scoring');

      const d  = new Date();
      const y2 = String(d.getFullYear()).slice(-2);
      const mm = String(d.getMonth() + 1).padStart(2, '0');
      const dd = String(d.getDate()).padStart(2, '0');
      const dateCode    = `${y2}${mm}${dd}`;               // v√≠ d·ª• 251009
      const dateDisplay = `${d.getFullYear()}-${mm}-${dd}`; // v√≠ d·ª• 2025-10-09

      const safeDept = deptName.replace(/\s+/g, '_');
      const filename = `Critical_Position_Evaluation_Form_${safeDept}_${dateCode}.xlsx`;

      XLSX.writeFile(wb, filename);

      // M·ªü Outlook n·∫øu ƒë∆∞·ª£c tick
      const openMail = document.getElementById('openEmailCheckbox')?.checked;
      if (!openMail) return;

      setTimeout(() => {
        const to = 'anguyen@ashleyfurniture.com,ltrankhanh@ashleyfurniture.com, hphamhong@ashleyfurniture.com';
        const subject = `CVRO ‚Äì Critical Position Scoring (${deptName}, ${dateDisplay})`;

        // So·∫°n email body (plain text nh∆∞ng v·∫´n c√≥ ‚Äúin ƒë·∫≠m‚Äù gi·∫£ l·∫≠p)
        const bodyLines = [
  'Dear team,',
  '',
  `The Critical Position Scoring form for the ${deptName} department has just been finalized and exported on ${dateDisplay}.`,
  '',
  `‚Ä¢ Total roles evaluated: ${totalRoles}`,
  `‚Ä¢ Roles included in succession planning: ${includedCount}`,
  '',
  `‚ö†Ô∏è IMPORTANT‚ö†Ô∏è: Please attach the file below (downloaded automatically) before sending.`,
  `File: ${filename}`,
  '',
  'Thank you,',
  deptName
];

const bodyPlain = bodyLines.join('\r\n');

// T·∫°o mailto URL
const mailto =
  `mailto:${encodeURIComponent(to)}`
  + `?subject=${encodeURIComponent(subject)}`
  + `&body=${encodeURIComponent(bodyPlain)}`;

window.location.href = mailto;
      }, 500);
    });
  })();
  // ====== N√∫t Email AHR (m·ªü so·∫°n email t·ª± ƒë·ªông) ======
const btnEmail = document.getElementById('btnEmailAHR');
if (btnEmail){
  btnEmail.addEventListener('click', () => {
    const deptEl   = document.getElementById('deptSelect');
    const deptKey  = deptEl?.value || 'Department';
    const deptName = (window.DEPT_MAP?.[deptKey]?.name)
                  || (deptEl?.options[deptEl.selectedIndex]?.text)
                  || 'Department';

    // ƒê·∫øm t·ªïng roles & s·ªë role ƒë∆∞·ª£c tick include
    let totalRoles = 0, includedCount = 0;
    document.querySelectorAll('#scoreRows tr').forEach(tr => {
  const role = tr.querySelector('.role-input')?.value.trim()
              || tr.querySelector('.role-cell')?.textContent.trim()
              || '';
  if (!role) return;
  totalRoles++;
  const cb = tr.querySelector('.include-checkbox');
  if (cb && cb.checked) includedCount++;
});

    // T·∫°o c√°c bi·∫øn ng√†y & t√™n file (tr√πng v·ªõi export)
    const d  = new Date();
    const y2 = String(d.getFullYear()).slice(-2);
    const mm = String(d.getMonth() + 1).padStart(2, '0');
    const dd = String(d.getDate()).padStart(2, '0');
    const dateDisplay = `${d.getFullYear()}-${mm}-${dd}`;
    const safeDept = deptName.replace(/\s+/g, '_');
    const filename = `Critical_Position_Evaluation_Form_${safeDept}_${y2}${mm}${dd}.xlsx`;

    // Mailto
    const to = 'anguyen@ashleyfurniture.com,ltrankhanh@ashleyfurniture.com, hphamhong@ashleyfurniture.com';
    const subject = `CVRO ‚Äì Critical Position Scoring (${deptName}, ${dateDisplay})`;

    // L∆∞u √Ω: mailto th∆∞·ªùng l√† plain text; bold HTML c√≥ th·ªÉ b·ªã b·ªè qua trong Outlook.
    const body = [
      'Dear team,',
      '',
      `The Critical Position Scoring form for the ${deptName} department has just been finalized and exported on ${dateDisplay}.`,
      '',
      `‚Ä¢ Total roles evaluated: ${totalRoles}`,
      `‚Ä¢ Roles included in succession planning: ${includedCount}`,
      '',
      '‚ö†Ô∏èIMPORTANT‚ö†Ô∏è: Please attach the file below before sending. (You may remove this line after attaching.)',
      `File: ${filename}`,
      '',
      'Thank you,',
      deptName
    ].join('\r\n');

    const mailto =
      `mailto:${encodeURIComponent(to)}`
      + `?subject=${encodeURIComponent(subject)}`
      + `&body=${encodeURIComponent(body)}`;

    window.location.href = mailto;
  });
}
  // g·ªçi autosize khi to√†n trang load xong (ch·∫Øc ch·∫Øn hi·ªÉn th·ªã ƒë·ªß)
  window.addEventListener('load', autosizeAllRoles);
});
</script>
</div>
</div>

<!-- Part B: Define Success Profile for Selected Positions -->
<div id="s1-profile-tab" class="step-tab-content hidden">
  <div class="mb-4">
    <p class="font-semibold text-gray-700 text-base mb-2">
      Each department must review and finalize the Success Profile for each selected role intended for succession planning.
    </p>
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
      <div class="flex items-center gap-2">
        <span class="bg-ashley-orange text-white px-2 py-1 rounded text-xs font-bold">EXAMPLE</span>
        <span class="text-yellow-800 font-medium">The content below is an example for the Team Leader Positions.</span>
      </div>
    </div>
  </div>

  <!-- ================== Section 1 (STATIC) ================== -->
  <section id="sec-competency" class="border-2 border-gray-300 rounded-xl bg-white example-watermark">
    <div class="px-5 py-4 border-b-2 border-gray-200">
      <h3 class="text-ashley-orange font-extrabold text-lg">Section 1: Competency Requirements</h3>
    </div>

	<div class="overflow-x-auto max-w-[100vw]">
	  <table class="min-w-[1100px] w-auto text-sm">

<div class="overflow-x-auto max-w-[100vw]">
<div class="overflow-x-auto">
  <table class="w-full text-sm table-auto">
    <thead class="bg-gray-50">
      <tr class="text-gray-800">
        <th class="px-3 py-3 text-left w-[15%]">Areas</th>
        <th class="px-3 py-3 text-center w-[5%]">No.</th>
        <th class="px-3 py-3 text-left w-[15]">Competency Name</th>
        <th class="px-3 py-3 text-left w-[65%]">Competency Description</th>
      </tr>
    </thead>


    <tbody class="align-top">
<tbody class="align-top">
  <!-- ===== Business/ Management Skills ===== -->
  <tr>
    <td class="border-t px-3 py-2 font-medium area-cell align-middle" rowspan="4">Business/ Management Skills</td>
    <td class="border-t px-3 py-2 text-center align-middle">1</td>
    <td class="border-t px-3 py-2 align-middle">Business Knowledge</td>
    <td class="border-t px-3 py-2">Demonstrates a keen understanding of basic business operations and the organizational levers (systems, processes, departments, functions) that drive profitable growth, draws from personal experience to quickly evaluate business plans and processes to identify data or recommendations that need further investigation.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">2</td>
    <td class="border-t px-3 py-2 align-middle">Customer Focus</td>
    <td class="border-t px-3 py-2">Ensuring that the internal or external customer‚Äôs perspective is a driving force behind strategic priorities, business decisions, organizational processes, and individual activities, crafting and implementing service practices that meet customers‚Äô and own organization‚Äôs needs, promoting and operationalizing customer service as a value.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">3</td>
    <td class="border-t px-3 py-2 align-middle">Decision Making</td>
    <td class="border-t px-3 py-2">Identifying and understanding problems and opportunities by gathering, analyzing, and interpreting quantitative and qualitative information, choosing the best course of action by establishing clear decision criteria, generating and evaluating alternatives, and making timely decisions, taking action that is consistent with available facts and constraints and optimizes probable consequences.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">4</td>
    <td class="border-t px-3 py-2 align-middle">Operational Excellence</td>
    <td class="border-t px-3 py-2">The systematic approach and integrated management philosophy that enhances the efficiency, quality, and effectiveness of the company's operations.</td>
  </tr>

  <!-- ===== Interpersonal Effectiveness ===== -->
  <tr>
    <td class="border-t px-3 py-2 font-medium area-cell align-middle" rowspan="3">Interpersonal Effectiveness</td>
    <td class="border-t px-3 py-2 text-center align-middle">5</td>
    <td class="border-t px-3 py-2 align-middle">Communication</td>
    <td class="border-t px-3 py-2">Conveying information and ideas clearly and concisely to individuals or groups in an engaging manner that helps them understand and retain the message, listening actively to others.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">6</td>
    <td class="border-t px-3 py-2 align-middle">Emotional Intelligence Essentials</td>
    <td class="border-t px-3 py-2">Establishing and sustaining trusting relationships by accurately perceiving and interpreting own and others‚Äô emotions and behavior, leveraging insights to effectively manage own responses so that one‚Äôs behavior matches one‚Äôs values and delivers intended results.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">7</td>
    <td class="border-t px-3 py-2 align-middle">Cross-team Collaboration</td>
    <td class="border-t px-3 py-2">The ability to effectively work across diverse teams, departments, and geographical locations to achieve common goals.</td>
  </tr>

  <!-- ===== Personal Attributes ===== -->
  <tr>
    <td class="border-t px-3 py-2 font-medium area-cell align-middle" rowspan="3">Personal Attributes</td>
    <td class="border-t px-3 py-2 text-center align-middle">8</td>
    <td class="border-t px-3 py-2 align-middle">Personal Courage</td>
    <td class="border-t px-3 py-2">Proactively confronting difficult issues, making valiant choices and taking bold action in the face of opposition or fear.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">9</td>
    <td class="border-t px-3 py-2 align-middle">Positive Approach</td>
    <td class="border-t px-3 py-2">Demonstrating a positive attitude in the face of difficult or challenging situations, providing an uplifting (yet realistic) outlook on what the future holds and the opportunities it might present.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">10</td>
    <td class="border-t px-3 py-2 align-middle">Adaptability</td>
    <td class="border-t px-3 py-2">Maintaining effectiveness when experiencing major changes in work responsibilities or environment (e.g., people, processes, structure, or culture), adjusting effectively to change by exploring the benefits, trying new approaches, and collaborating with others to make the change successful.</td>
  </tr>

  <!-- ===== Leadership Impact ===== -->
  <tr>
    <td class="border-t px-3 py-2 font-medium area-cell align-middle" rowspan="5">Leadership Impact</td>
    <td class="border-t px-3 py-2 text-center align-middle">11</td>
    <td class="border-t px-3 py-2 align-middle">Coaching and Developing Others</td>
    <td class="border-t px-3 py-2">Providing feedback, instruction, and development guidance to help others excel in their current or future job responsibilities, planning and supporting the development of individual skills and abilities.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">12</td>
    <td class="border-t px-3 py-2 align-middle">Driving Innovation</td>
    <td class="border-t px-3 py-2">Creating an environment (culture) that inspires people to generate novel solutions with measurable value for existing and potential customers (internal or external), encouraging experimentation with new ways to solve work problems and seize opportunities that result in unique and differentiated solutions.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">13</td>
    <td class="border-t px-3 py-2 align-middle">Driving for Results</td>
    <td class="border-t px-3 py-2">Setting high goals for personal and group accomplishment, using measurement methods to monitor progress toward goals, tenaciously working to meet or exceed goals while deriving satisfaction from that achievement and continuous improvement.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">14</td>
    <td class="border-t px-3 py-2 align-middle">Facilitating Change</td>
    <td class="border-t px-3 py-2">Encouraging others to implement better approaches to address problems and opportunities, leading the implementation and acceptance of change within the workplace.</td>
  </tr>
  <tr>
    <td class="border-t px-3 py-2 text-center align-middle">15</td>
    <td class="border-t px-3 py-2 align-middle">Delegation and Empowerment</td>
    <td class="border-t px-3 py-2">Identifying and leveraging opportunities to accelerate results and build capability by assigning tasks and decision-making responsibilities to individuals or teams with clear boundaries, expectations, support, and follow-up.</td>
  </tr>
</tbody>

    </tbody>
  </table>
</div>

    <!-- Conclusion note -->
    <div class="px-5 py-4 border-t-2 border-gray-200 bg-yellow-50 rounded-b-xl">
      <p class="text-sm text-gray-800">
        <span class="font-semibold">Available in the Performance Evaluation System:</span>
        Review &amp; finalize the competency requirements of the successor role, including both leadership competencies and technical skills.
      </p>
    </div>
  </section>

    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-6">
      <div class="flex items-center gap-2">
        <span class="bg-ashley-orange text-white px-2 py-1 rounded text-xs font-bold">EXAMPLE</span>
        <span class="text-yellow-800 font-medium">The content below is an example extracted from the Job Description of the position Team Leader of Product Engineering.</span>
      </div>
    </div>

  <!-- ================== Section 2 (STATIC) ================== -->
  <section id="sec-qualifications" class="border-2 border-gray-300 rounded-xl bg-white mt-6 example-watermark">
    <div class="px-5 py-4 border-b-2 border-gray-200">
      <h3 class="text-blue-700 font-extrabold text-lg">Section 2: Job Qualifications</h3>
    </div>

<div class="p-5 grid md:grid-cols-2 gap-6 text-sm">
  <div class="flex flex-col">
    <label class="block font-medium">Years of Experience Required</label>
    <p class="text-xs text-gray-500 mt-1">Minimum years of relevant experience.</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
      At least 5 years of experience in Engineering, Lean, or project management; furniture manufacturing background required; leadership experience required.
    </p>
  </div>

  <div class="flex flex-col">
    <label class="block font-medium">Educational Background (if any)</label>
    <p class="text-xs text-gray-500 mt-1">Required degree(s) and field(s).</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
      College and above; major in Engineering, Lean, or Industrial Management.
    </p>
  </div>

  <div class="flex flex-col">
    <label class="block font-medium">Certifications (if any)</label>
    <p class="text-xs text-gray-500 mt-1">Any industry or function-related certifications required.</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
      Not specified in JD.
    </p>
  </div>


  <div class="flex flex-col">
    <label class="block font-medium">Language/Communication Skills</label>
    <p class="text-xs text-gray-500 mt-1">Requirements for English level, reporting ability, or customer-facing communication.</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
	Effective English communication skills.
	</p>
  </div>
  
  
  <div class="flex flex-col">
    <label class="block font-medium">Functional/ Technical Knowledge</label>
    <p class="text-xs text-gray-500 mt-1">Systems, tools, or processes required.</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
	NEWGO process; PPR reviews; drawings evaluation; AIS, CTN, RPDF review; vendor communication; PPR tracking; quality/process projects; AutoCAD; MS Office.
    </p>
  </div>

  <div class="flex flex-col">
    <label class="block font-medium">Other Role-Specific Requirements</label>
    <p class="text-xs text-gray-500 mt-1">Include availability to travel, shift flexibility, domain knowledge, etc.</p>
    <p class="mt-2 px-3 py-2 bg-white rounded border">
	Work under high demands; manage multiple tasks; empathy; factory environment; lifting up to 50 lbs; bending/stooping; exposure to dirt, dust, chemicals, and noise.
    </p>
  </div>
</div>


    <div class="px-5 py-4 border-t-2 border-gray-200 bg-yellow-50 rounded-b-xl">
      <p class="text-sm text-gray-800">
        <span class="font-semibold">Available in departmental JDs: </span>
        Review the essential Job qualifications. This section must be reviewed and consolidated into the template
      </p>
    </div>
  </section>
<!-- ===== Success Profile Folder Section (2-column layout) ===== -->
<div class="mt-6 mb-6 grid md:grid-cols-2 gap-6 items-center">

  <!-- Left: Title + Description -->
  <div class="text-left space-y-1">
    <h4 class="font-semibold text-gray-900 text-sm">
      Success Profile ‚Äì Department Templates (2025)
    </h4>
    <p class="text-xs text-gray-600">
      Success Profile templates for prioritized roles in Part A ‚Äî to be reviewed by HoDs as guided in the Success Profile tab.
      The link will be unlocked during the workshop on November 18.
    </p>
  </div>

  <!-- Right: Button + Badge -->
  <div id="folderWrap" class="flex items-center gap-3 justify-start md:justify-end">
    
    <a id="btnFolderLink"
       data-link-id="stage1B"
       href="#"
       target="_blank"
       class="inline-flex items-center gap-2
              bg-white text-[#F68C2C] border border-[#F68C2C]
              hover:bg-orange-50
              px-4 py-2 rounded-lg text-sm font-medium transition
              pointer-events-none opacity-60">
       üìÅ Success Profile Folder
    </a>

    <!-- Badge -->
    <span id="folderBadge"
          class="text-xs font-medium
                 text-[#C25A00] bg-[#FFF3E6]
                 border border-[#F68C2C]/30
                 px-3 py-1 rounded-full inline-flex items-center gap-1">
      ‚è≥ Opens soon
    </span>
  </div>
</div>
</div>

<!-- ===== Watermark CSS (KEEP) ===== -->
<style>
  #sec-competency.example-watermark,
  #sec-qualifications.example-watermark { position: relative; }
  #sec-competency.example-watermark::before,
  #sec-qualifications.example-watermark::before {
    content: "EXAMPLE";
    position: absolute;
    inset: 0;
    pointer-events: none;
    font-weight: 700;
    font-size: clamp(3rem, 12vw, 8rem);
    line-height: 1;
    letter-spacing: 0.15em;
    color: rgba(246, 140, 44, 0.10);
    text-shadow: 0 0 10px rgba(246, 140, 44, 0.10);
    display: grid;
    place-items: center;
    transform: rotate(-18deg);
  }
</style>
<script>
  document.addEventListener('DOMContentLoaded', () => {

    const unlockAtFolder = new Date('2025-11-18T00:00:00+07:00').getTime(); //gi·ªù m·ªü folder
    const folderBtn   = document.getElementById('btnFolderLink');
    const folderBadge = document.getElementById('folderBadge');

    function updateFolderState() {
      if (!folderBtn) return;
      const now = Date.now();

      if (now >= unlockAtFolder) {
        // ======= UNLOCKED STYLE (cam ƒë·∫≠m gi·ªëng Stage 2) =======
        folderBtn.classList.remove(
          'bg-white','text-[#F68C2C]','border','border-[#F68C2C]',
          'hover:bg-orange-50','pointer-events-none','opacity-60'
        );
        folderBtn.classList.add(
          'bg-[#F68C2C]','hover:bg-[#E67A1A]','text-white','shadow-sm'
        );

        if (folderBadge) folderBadge.style.display = 'none';

      } else {
        // ======= LOCKED STYLE =======
        folderBtn.classList.add('pointer-events-none','opacity-60');
        if (folderBadge) {
          folderBadge.textContent = '‚è≥ Opens soon';
          folderBadge.style.display = 'inline-flex';
        }
      }
    }

    updateFolderState();
    setInterval(updateFolderState, 60000);
  });
</script>
</div>
</div>
<!-- STAGE 2 ‚Äì Identify Talent Pool (Collapsible style, 3 colorful rounds) -->
<div id="step-2" class="step-content hidden">
          <div class="bg-white rounded-xl border p-6 mb-6">
  <h3 class="text-2xl font-bold text-gray-900 mb-2">STAGE 2: Identify Talent Pool</h3>
  <p class="text-gray-600 mb-6">To <strong> identifies the Talent Pool through 3 structured rounds. </strong> It ensures fairness and transparency, empowers employees to take initiative, and confirms the right fit for succession planning.</p>
	
<!-- ROUND 1 -->
<details class="group bg-green-50 border-l-4 border-green-500 rounded-r-lg mb-4">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-green-700 text-base flex items-center gap-2">
      üß© Round 1 ‚Äì HoD Nomination
    </span>
    <svg class="h-5 w-5 text-green-600 transition-transform duration-200 ease-out group-open:rotate-90">
      <path fill="currentColor"
        d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z" />
    </svg>
  </summary>

  <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
    <p class="mb-2">
      AHR filters employees using the <span class="font-medium">9-Box Grid</span> from the 2025 Performance Evaluation and shares the
      <strong>Green Zone list</strong> with each HoD for nomination.
    </p>

    <!-- === 9-Box + Group 1 & 2 visual layout === -->
    <div class="mt-4 bg-white rounded-xl border p-4">
      <div class="grid md:grid-cols-5 gap-4">
        <!-- Left: 9-Box thumbnail (optional) -->
        <div class="md:col-span-2">
          <img src="./assets/9box_sample.png" alt="9-Box Grid"
               class="w-full h-auto rounded-lg border shadow-sm object-cover">
        </div>

        <!-- Right: Group cards -->
        <div class="md:col-span-3 space-y-4">

          <!-- Group 1 - Green Zone -->
          <div class="rounded-lg border border-emerald-500">
            <div class="bg-emerald-500 text-white rounded-t-lg px-4 py-2">
              <h5 class="font-semibold">
                Group 1 ‚Äì Green Zone
                <span class="opacity-90 font-normal">(Superstar, High Professional, Rising Star)</span>
              </h5>
            </div>
            <div class="bg-white rounded-b-lg px-4 py-3 border-t border-emerald-200">
              <p class="text-gray-800">
                Employees with <span class="font-semibold">above-average performance/competency</span> scores.
                Suggested as <span class="text-emerald-700 font-semibold">priority for Talent Pool</span> consideration.
              </p>
            </div>
          </div>

          <!-- Group 2 - Blue Zone -->
          <div class="rounded-lg border border-blue-700">
            <div class="bg-blue-700 text-white rounded-t-lg px-4 py-2">
              <h5 class="font-semibold">
                Group 2 ‚Äì Blue Zone
                <span class="opacity-90 font-normal">(Valued Contributor)</span>
              </h5>
            </div>
            <div class="bg-white rounded-b-lg px-4 py-3 border-t border-blue-200">
              <p class="text-gray-800">
                Employees who may be considered if they show <span class="font-semibold">outstanding traits</span>,
                <span class="font-semibold">strong learning agility</span>, and <span class="font-semibold">ambition for growth</span>.
                Suggested as <span class="text-blue-700 font-semibold">optional pool</span> if needed.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- === End Group layout === -->

    <div class="bg-white border border-green-200 rounded-lg p-3 text-sm mt-4">
      <p class="text-gray-700">
        <strong>Guidelines:</strong> HoDs will receive only the Green Zone list and may tick nominees for Round 2 directly.
        If they wish to include additional names from Blue Zone, rationale must be provided.  
        Exclusion of Green Zone names does not require justification, but AHR recommends that no rationale be related to gender,
        pregnancy, or any other personal factor.
      </p>
    </div>

    <p class="mt-3 text-gray-700">
      HoDs use the <strong>Pre-Nomination Checklist</strong> and <strong>Candidate List</strong> to finalize the nomination.
      This step acts as a <em>pre-screening stage</em> to identify employees with development potential before the self-application phase.
    </p>
	<!-- === Round 1 Action Button === -->
	<div class="mt-4 flex flex-wrap gap-2">
	  <a
	  	 data-link-id="round1_example"
		 href="#"
	     target="_blank"
	     class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-green-700">
	    [EXAMPLE] Successor Pre-Nomination Checklist & Candidate List
	  </a>
	</div>
</div>
</details>

  <!-- ROUND 2 -->
  <details class="group bg-blue-50 border-l-4 border-blue-500 rounded-r-lg mb-4">
    <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
      <span class="font-semibold text-blue-700 text-base flex items-center gap-2">
        üìù Round 2 ‚Äì Candidate Self-Application
      </span>
      <svg class="h-5 w-5 text-blue-600 transition-transform duration-200 ease-out group-open:rotate-90">
        <path fill="currentColor"
          d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z" />
      </svg>
    </summary>

    <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
      <ul class="list-disc pl-5 space-y-1 mb-3">
        <li>HoD-nominated employees are invited by AHR to apply via online MS Form.</li>
        <li>Applicants must complete the <strong>Candidate Profile Template</strong>, including:</li>
      </ul>

<!-- ====== ROUND 2 ‚Äì Candidate Self-Application (Final, no detailed instruction list) ====== -->
<div class="bg-white border border-blue-200 rounded-xl p-5 text-sm">

  <!-- Header controls -->
  <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
    <div class="flex flex-wrap items-center gap-2">
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">1. üë§ Basic Info</span>
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">2. üóÇÔ∏è Preferences</span>
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">3. ‚ùì Reason</span>
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">4. üß≠ Role Qs</span>
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">5. üöö Mobility</span>
      <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">6. ‚ö° Aspiration</span>
    </div>

    <div class="flex items-center gap-2">
      <button type="button"
        class="px-3 py-1.5 rounded-lg border border-blue-300 text-blue-700 hover:bg-blue-50"
        onclick="showInstructions()">Show Instructions</button>

      <!-- Show Example menu -->
      <div class="relative">
        <button id="exampleBtn" onclick="toggleMenu()" class="px-3 py-1.5 rounded-lg border border-blue-300 text-blue-700 hover:bg-blue-50 flex items-center gap-1">
          Show Example
          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div id="exampleMenu" class="hidden absolute right-0 mt-1 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-10">
          <button onclick="loadExample('pd')" class="w-full text-left px-4 py-2 text-sm hover:bg-blue-50">Product Development</button>
          <button onclick="loadExample('qa')" class="w-full text-left px-4 py-2 text-sm hover:bg-blue-50">Quality Assurance</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Info panel (short message only) -->
  <div id="infoPanel" class="mb-4 rounded-lg border border-blue-200 bg-blue-50 p-4 text-xs text-blue-900">
    <div class="font-semibold mb-1">Instructions</div>
    Fill in each section carefully and completely. Use the <strong>SBI (Situation‚ÄìBehavior‚ÄìImpact)</strong> format to support your examples whenever possible.
  </div>

  <!-- ===== ROW 1: Basic Info | Role-Specific Questions ===== -->
  <div class="md:flex gap-4 mb-4">
    <!-- Basic Info -->
    <div class="flex-1">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2"><span>üë§</span><h4 class="font-semibold text-gray-900">Basic Info</h4></div>
        <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2">
          <div><dt class="text-gray-500">Full name</dt><dd id="bi-name" class="font-medium text-gray-900">‚Äî</dd></div>
          <div><dt class="text-gray-500">Department</dt><dd id="bi-dept" class="font-medium text-gray-900">‚Äî</dd></div>
          <div class="sm:col-span-2"><dt class="text-gray-500">Current role</dt><dd id="bi-role" class="font-medium text-gray-900">‚Äî</dd></div>
        </dl>
      </div>
    </div>

    <!-- Role-Specific Questions with tabs -->
    <div class="flex-1">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span>üß≠</span><h4 class="font-semibold text-gray-900">Role-Specific Questions</h4>
          </div>
          <!-- mini tabs -->
          <div id="roleTabs" class="flex rounded-lg overflow-hidden border">
            <button id="tabMgr" type="button"
              class="px-3 py-1 text-xs font-medium bg-blue-600 text-white"
              onclick="setRoleTab('mgr')">Managerial</button>
            <button id="tabIC" type="button"
              class="px-3 py-1 text-xs font-medium bg-white text-blue-700"
              onclick="setRoleTab('ic')">Non-managerial</button>
          </div>
        </div>

        <!-- Managerial panel -->
        <div id="panelMgr" class="space-y-3">
          <p class="text-gray-800">
            <span class="font-semibold">Leadership Style & Team Motivation:</span> Describe how you lead and inspire others to achieve shared goals. Explain how you communicate direction, build trust, and maintain motivation and accountability within your team
          </p>
          <div id="mgrAnswers" class="space-y-2 text-gray-800"></div>
          <div class="bg-blue-50 border border-blue-200 rounded p-3 text-xs text-blue-800">
            Tip: Use a recent example that demonstrates how you guided your team, resolved challenges, and celebrated results.
          </div>
        </div>

        <!-- Non-managerial panel -->
        <div id="panelIC" class="space-y-3 hidden">
          <p class="text-gray-800">
            <span class="font-semibold">Technical Expertise & Problem-Solving:</span> Describe the key technical skills that make you effective in your role and how you apply them to overcome complex work challenges.
          </p>
          <div id="icAnswers" class="space-y-2 text-gray-800"></div>
          <div class="bg-blue-50 border border-blue-200 rounded p-3 text-xs text-blue-800">
            Tip: Highlight specific tools, methods, or examples that show your ability to solve problems and deliver practical results.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== ROW 2: Preferences | Mobility ===== -->
  <div class="md:flex gap-4 mb-4">
    <!-- Preferences -->
    <div class="flex-1 relative">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2"><span>üóÇÔ∏è</span><h4 class="font-semibold text-gray-900">Succession Preferences</h4></div>
        <div id="onePrefBadge" class="hidden absolute top-3 right-4 bg-blue-100 text-blue-800 text-[11px] font-medium px-2 py-0.5 rounded-full border border-blue-200">Only 1 preference provided</div>
        <p class="text-xs text-gray-600 mb-3">
          You may list <span class="font-medium">one or two</span> preferences. If two, at least one must be in your current department (either 1st or 2nd).
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <div class="bg-blue-50/60 border border-blue-200 rounded-lg p-3">
            <div class="text-xs text-blue-700 mb-1 font-semibold">1st Preference</div>
            <div id="pref1" class="font-medium text-gray-900">‚Äî</div>
          </div>
          <div class="bg-blue-50/60 border border-blue-200 rounded-lg p-3 relative">
            <div class="text-xs text-blue-700 mb-1 font-semibold">2nd Preference</div>
            <div id="pref2" class="font-medium text-gray-900">‚Äî</div>
            <div id="crossNotice" class="hidden absolute top-2 right-2 bg-yellow-100 text-yellow-700 text-[10px] px-2 py-0.5 rounded-full">Cross-Dept</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mobility -->
    <div class="flex-1">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2"><span>üöö</span><h4 class="font-semibold text-gray-900">Mobility & Availability</h4></div>
        <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2">
          <div><dt class="text-gray-500">Willing to relocate?</dt><dd id="mob-relocate" class="font-medium text-gray-900">‚Äî</dd></div>
          <div><dt class="text-gray-500">Open to change dept?</dt><dd id="mob-change" class="font-medium text-gray-900">‚Äî</dd></div>
        </dl>
      </div>
    </div>
  </div>

  <!-- ===== ROW 3: Reason | Aspiration ===== -->
  <div class="md:flex gap-4">
    <div class="flex-1">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2"><span>‚ùì</span><h4 class="font-semibold text-gray-900">Reason for Each Preference</h4></div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <div><div class="text-xs text-gray-500 mb-1">Reason (1st)</div><p id="rs1" class="text-gray-800">‚Äî</p></div>
          <div><div class="text-xs text-gray-500 mb-1">Reason (2nd)</div><p id="rs2" class="text-gray-800">‚Äî</p></div>
        </div>
      </div>
    </div>

    <div class="flex-1">
      <div class="h-full border rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2"><span>‚ö°</span><h4 class="font-semibold text-gray-900">Career Aspiration & Motivation</h4></div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <div><div class="text-xs text-gray-500 mb-1">Short-term (1 year)</div><p id="asp-short" class="text-gray-800">‚Äî</p></div>
          <div><div class="text-xs text-gray-500 mb-1">Mid-term (2‚Äì3 years)</div><p id="asp-mid" class="text-gray-800">‚Äî</p></div>
        </div>
	    <div class="bg-blue-50 border border-blue-200 rounded p-3 text-xs text-blue-800 mt-3">
			<p>Note: This program is a <strong>Talent Development initiative</strong> (not a promotion program).</p>
	 		<p class="mt-1">Preferences will be visible to relevant HoDs for career discussion & alignment.</p>
		</div>
      </div>
    </div>
  </div>
</div>
<script>
/* ===== Helpers ===== */
function toggleMenu(){ document.getElementById('exampleMenu').classList.toggle('hidden'); }
function setText(id, val){ document.getElementById(id).innerText = (val && String(val).trim()) ? val : '‚Äî'; }

/* Tabs */
function setRoleTab(mode){
  const mgr = document.getElementById('panelMgr');
  const ic  = document.getElementById('panelIC');
  const tMgr = document.getElementById('tabMgr');
  const tIC  = document.getElementById('tabIC');
  if(mode === 'mgr'){
    mgr.classList.remove('hidden'); ic.classList.add('hidden');
    tMgr.classList.add('bg-blue-600','text-white'); tMgr.classList.remove('bg-white','text-blue-700');
    tIC.classList.add('bg-white','text-blue-700');  tIC.classList.remove('bg-blue-600','text-white');
  }else{
    ic.classList.remove('hidden'); mgr.classList.add('hidden');
    tIC.classList.add('bg-blue-600','text-white'); tIC.classList.remove('bg-white','text-blue-700');
    tMgr.classList.add('bg-white','text-blue-700'); tMgr.classList.remove('bg-blue-600','text-white');
  }
}

/* Show Instructions (reset) */
function showInstructions(){
  // header h∆∞·ªõng d·∫´n
  document.getElementById('infoPanel').innerHTML =
    '<div class="font-semibold mb-1">Instructions</div>Fill in each section carefully and completely. Use the <strong>SBI (Situation‚ÄìBehavior‚ÄìImpact)</strong> format to support your examples whenever possible.';

  // reset d·ªØ li·ªáu
  clearCards();
  document.getElementById('mgrAnswers').innerHTML = '';
  document.getElementById('icAnswers').innerHTML  = '';

  // HI·ªÜN l·∫°i c√°c h∆∞·ªõng d·∫´n ƒë√£ b·ªã ·∫©n l√∫c load example
  const mgrP   = document.querySelector('#panelMgr > p');
  const mgrTip = document.querySelector('#panelMgr > .bg-blue-50');
  if (mgrP)   mgrP.classList.remove('hidden');
  if (mgrTip) mgrTip.classList.remove('hidden');

  const icP    = document.querySelector('#panelIC > p');
  const icTip  = document.querySelector('#panelIC > .bg-blue-50'); // tip non-managerial (hi·ªán t·∫°i l√† div)
  if (icP)    icP.classList.remove('hidden');
  if (icTip)  icTip.classList.remove('hidden');

  // tabs tr·∫°ng th√°i m·∫∑c ƒë·ªãnh
  document.getElementById('tabIC').classList.remove('hidden');
  document.getElementById('roleTabs').classList.remove('opacity-50','pointer-events-none');
  setRoleTab('mgr');

  // badge
  document.getElementById('crossNotice').classList.add('hidden');
  document.getElementById('onePrefBadge').classList.add('hidden');
}

/* ===== Example data (ƒë·ªß tr∆∞·ªùng SBI) ===== */
const examples = {
  pd: {
    name:'Tran Minh Anh',
    dept:'Product Development',
    role:'Product Developer',
    pref1:'Team Leader of Product Development',
    pref2:'Senior Team Leader of Product Engineering',
    cross:true,
    relocate:'Yes (MY/CN ok)',
    change:'Yes',
    rs1:'Lead innovation & launch readiness for PD projects.',
    rs2:'Bridge design‚Äìmanufacturing as technical leader.',
    aspShort:'Own full NPI cycle with tighter vendor coordination.',
    aspMid:'Grow into cross-functional technical leadership.',

    // Managerial
    mgrA1:'Empowering & structured; set clear goals, enable creative problem-solving.',
    mgrS:'Team morale dropped during a delayed sample build.',
    mgrB:'Introduced daily 10-min syncs, spotlighted wins, unblocked issues quickly.',
    mgrI:'Team delivered 1 week earlier; engagement scores +18% in pulse check.',

    // Non-managerial
    icA1:'CAD (SolidWorks), DFM/A, rapid prototyping, BOM control, 8D root cause.',
    icS:'Prototype failed drop test due to weak base joint.',
    icB:'Redesigned joint with gusset; coordinated 24-hour 3D-print with vendor.',
    icI:'Passed retest; rework ‚Üì20%; design added to PD guidelines.'
  },
  qa: {
    name:'Nguyen Hoang Long',
    dept:'Quality Assurance',
    role:'Quality Assurance CI',
    pref1:'Vendor Champion',
    pref2:'‚Äî',
    cross:false,
    relocate:'Open within VN',
    change:'Within QA only',
    rs1:'Elevate supplier quality performance across regions.',
    rs2:'‚Äî',
    aspShort:'Strengthen audit readiness and vendor coaching.',
    aspMid:'Drive regional quality excellence as Vendor Champion.',

    // Managerial
    mgrA1:'Supportive yet data-driven; set standards, enable autonomy, coach via data.',
    mgrS:'High defect rate at a priority vendor (PPM +30%).',
    mgrB:'Launched defect-blitz with visual boards & peer coaching; weekly Gemba.',
    mgrI:'Defects ‚àí15% in 2 months; vendor sustained SPC at target.'
    // QA kh√¥ng c√≥ non-managerial
  }
};

/* ===== Load example & render ===== */
function loadExample(type){
  toggleMenu();
  const ex = examples[type];

  // Header
  document.getElementById('infoPanel').innerHTML =
    `<div class="font-semibold mb-1">${ex.name} ‚Äì ${ex.role}</div>Example case loaded.`;

  // Fill cards
  setText('bi-name', ex.name);  setText('bi-dept', ex.dept);  setText('bi-role', ex.role);
  setText('pref1', ex.pref1);   setText('pref2', ex.pref2);
  setText('rs1', ex.rs1);       setText('rs2', ex.rs2);
  setText('mob-relocate', ex.relocate); setText('mob-change', ex.change);
  setText('asp-short', ex.aspShort);    setText('asp-mid', ex.aspMid);

  // Badges
  const cross = document.getElementById('crossNotice');
  ex.cross ? cross.classList.remove('hidden') : cross.classList.add('hidden');
  const onePref = document.getElementById('onePrefBadge');
  (!ex.pref2 || ex.pref2 === '‚Äî') ? onePref.classList.remove('hidden') : onePref.classList.add('hidden');

  /* ==== Managerial (2 c√¢u: c√¢u 2 c√≥ SBI s√°t c√¢u h·ªèi) ==== */
  document.getElementById('mgrAnswers').innerHTML = `
    <div class="bg-white border rounded p-3 shadow-[0_0_0_1px_rgba(59,130,246,0.15)] space-y-3">
      <div class="text-[11px] font-semibold uppercase tracking-wide text-blue-700">
        How would you describe your leadership style?
      </div>
      <div>‚Ä¢ ${ex.mgrA1 || '‚Äî'}</div>

      <div class="text-[11px] font-semibold uppercase tracking-wide text-blue-700">
        Share an example of a time you successfully motivated a team.
      </div>
      <div class="mt-1 space-y-0.5 text-gray-800">
        <div><strong>Situation:</strong> ${ex.mgrS || '‚Äî'}</div>
        <div><strong>Behavior:</strong> ${ex.mgrB || '‚Äî'}</div>
        <div><strong>Impact:</strong> ${ex.mgrI || '‚Äî'}</div>
      </div>
    </div>`;

  /* ==== Non-managerial (ch·ªâ PD c√≥) ==== */
  let icHTML = '';
  if (ex.icA1 || ex.icS || ex.icB || ex.icI){
    icHTML = `
      <div class="bg-white border rounded p-3 shadow-[0_0_0_1px_rgba(59,130,246,0.15)] space-y-3">
        <div class="text-[11px] font-semibold uppercase tracking-wide text-blue-700">
          Which technical skills make you a strong candidate for this role?
        </div>
        <div>‚Ä¢ ${ex.icA1 || '‚Äî'}</div>

        <div class="text-[11px] font-semibold uppercase tracking-wide text-blue-700">
          Share an example of how you solved a complex work-related problem.
        </div>
        <div class="mt-1 space-y-0.5 text-gray-800">
          <div><strong>Situation:</strong> ${ex.icS || '‚Äî'}</div>
          <div><strong>Behavior:</strong> ${ex.icB || '‚Äî'}</div>
          <div><strong>Impact:</strong> ${ex.icI || '‚Äî'}</div>
        </div>
      </div>`;
  }
  document.getElementById('icAnswers').innerHTML = icHTML;

  /* ·∫®n h∆∞·ªõng d·∫´n v√¨ ƒë√£ c√≥ example */
  const mgrP  = document.querySelector('#panelMgr > p');
  const mgrTip= document.querySelector('#panelMgr > .bg-blue-50');
  if (mgrP)  mgrP.classList.add('hidden');
  if (mgrTip)mgrTip.classList.add('hidden');
  const icP   = document.querySelector('#panelIC > p');
  const icList= document.querySelector('#panelIC > ul');
  if (icP)   icP.classList.add('hidden');
  if (icList)icList.classList.add('hidden');
  const icTip = document.querySelector('#panelIC > .bg-blue-50');
  if (icTip) icTip.classList.add('hidden');


  /* Hi·ªÉn th·ªã tab: PD c√≥ 2 tab; QA ch·ªâ Managerial */
  if(icHTML){
    document.getElementById('tabIC').classList.remove('hidden');
    document.getElementById('roleTabs').classList.remove('opacity-50','pointer-events-none');
  }else{
    document.getElementById('tabIC').classList.add('hidden');
    document.getElementById('panelIC').classList.add('hidden');
    document.getElementById('roleTabs').classList.add('opacity-50','pointer-events-none');
  }

  /* √âP v·ªÅ tab Managerial & ·∫®N IC khi v·ª´a load (ƒëi·ªÉm b·∫°n h·ªèi) */
  setRoleTab('mgr');                         // lu√¥n m·ªü Managerial
  document.getElementById('panelIC').classList.add('hidden'); // ch·∫Øc ch·∫Øn ·∫©n IC
  document.getElementById('tabMgr').focus();                   // focus n√∫t Managerial
}

/* Reset c√°c th·∫ª khi b·∫•m Show Instructions */
function clearCards(){
  ['bi-name','bi-dept','bi-role','pref1','pref2','rs1','rs2','mob-relocate','mob-change','asp-short','asp-mid']
    .forEach(id => document.getElementById(id).innerText = '‚Äî');
}
</script>
      <div class="mt-4 flex flex-wrap gap-2">
  <!-- Link to MS Form -->
  <a
  	data-link-id="round2_ms_form"
	href="#"
	target="_blank"
	class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700">
    Open Application Form
  </a>

  <!-- Link to Talent NextGen Booklet -->
  <a
  	data-link-id="round2_booklet"
	href="#"
	target="_blank"
    class="bg-white border border-blue-400 text-blue-600 px-4 py-2 rounded-lg text-sm hover:bg-blue-50">
    Talent NextGen Program Introduction Booklet
  </a>
</div>
    </div>
  </details>

  <!-- ROUND 3 -->
  <details class="group bg-orange-50 border-l-4 border-ashley-orange rounded-r-lg mb-4">
    <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
      <span class="font-semibold text-ashley-orange text-base flex items-center gap-2">
        ü§ù Round 3 ‚Äì HoD Review & Position Matching
      </span>
      <svg class="h-5 w-5 text-ashley-orange transition-transform duration-200 ease-out group-open:rotate-90">
        <path fill="currentColor"
          d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z" />
      </svg>
    </summary>

    <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
      <p class="mb-3">From successor applications, HoDs receive <strong>segmented lists</strong> for review:</p>

		 <!-- Equal-width cards -->
		<div class="grid md:grid-cols-3 gap-4 mb-4">
		  <div class="bg-ashley-orange text-white p-4 rounded-xl text-center font-semibold shadow-sm">
		    Internal Applicants<br>
		    <span class="text-sm opacity-90">(same department)</span>
		  </div>
		  <div class="bg-amber-600 text-white p-4 rounded-xl text-center font-semibold shadow-sm">
		    Incoming Applicants<br>
		    <span class="text-sm opacity-90">(from other departments)</span>
		  </div>
		  <div class="bg-orange-700 text-white p-4 rounded-xl text-center font-semibold shadow-sm">
		    Outgoing Applicants<br>
		    <span class="text-sm opacity-90">(to other departments)</span>
		  </div>
		</div>
		
		<!-- Review process list -->
		<ul class="list-disc pl-5 text-gray-800 space-y-1 mb-4">
		  <li>HoD reviews candidate profiles and <strong>selects successors based on fit with the Success Profile.</strong></li>
		  <li>Considers <strong>department capacity</strong> to provide follow-up development for each position (from Stage 1).</li>
		  <li>AHR consolidates endorsed candidates for <strong>Gap Assessment (Stage 3)</strong>.</li>
		  <li><strong>Non-selected applicants</strong> receive a thank-you message and development encouragement.</li>
		</ul>
		
		<!-- Important notes (moved below, orange title) -->
		<div class="bg-white border border-orange-200 rounded-lg p-3 mt-4">
		  <p class="font-medium text-ashley-orange mb-1">Important notes:</p>
		  <ul class="list-disc pl-5 text-gray-700 space-y-1">
		    <li>Cross-department applications should be handled with <strong>sensitivity</strong> and clear communication.</li>
		    <li>Employees are encouraged to apply <strong>cross-functionally</strong> when roles align with their skills and long-term career goals.</li>
		    <li>HoDs should view cross-applications as <strong>growth potential</strong> ‚Äî not dissatisfaction or disengagement.</li>
		  </ul>
		</div>
<!-- ============ Example + How-to Video Section ============ -->
<div class="mt-4 flex items-center gap-3 flex-wrap">

  <!-- üß© Example Button -->
  <button id="btnOpenExample"
    class="inline-flex items-center gap-2 bg-[#F68C2C] hover:bg-[#E67A1A] text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm transition">
    üß© View Example Scenario
  </button>

  <!-- üé• How-to Video Wrapper (button + badge outside) -->
  <div id="howtoWrap" class="flex items-center gap-2">
    <a id="btnHowToVideo"
      data-link-id="round3_video"
	  href="#"
      target="_blank"
      class="inline-flex items-center gap-2 bg-white text-[#F68C2C] border border-[#F68C2C] hover:bg-orange-50 px-4 py-2 rounded-lg text-sm font-medium transition pointer-events-none opacity-60">
      üé• How-to Video
    </a>

    <!-- External badge -->
    <span id="videoBadge"
      class="text-xs font-medium text-[#C25A00] bg-[#FFF3E6] border border-[#F68C2C]/30 px-3 py-1 rounded-full inline-flex items-center gap-1">
      ‚è≥ Opens soon
    </span>
  </div>
</div>

<!-- ============ Example Scenario (Modal) ============ -->
<div id="exampleModal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-hidden="true">
  <!-- Backdrop: fixed ƒë·ªÉ lu√¥n ph·ªß full m√†n h√¨nh khi scroll -->
  <div id="exampleBackdrop" class="fixed inset-0 bg-black/40"></div>

  <!-- Wrapper: cho ph√©p modal ƒëi theo scroll, cƒÉn gi·ªØa -->
  <div class="relative z-10 flex min-h-full items-start justify-center px-4 py-8">
    <div class="bg-white rounded-2xl shadow-2xl border border-orange-200 overflow-hidden max-w-2xl w-full">
      <!-- Header -->
      <div class="flex items-center justify-between px-6 py-3 bg-orange-50 border-b border-orange-100">
        <h3 class="text-base font-semibold text-orange-700">
          üß© Round 3 Example Scenario ‚Äì HoD Review & Position Matching
        </h3>
        <button id="btnCloseExample"
          class="inline-flex items-center justify-center w-8 h-8 rounded-lg hover:bg-orange-100 text-orange-700"
          aria-label="Close">‚úñ</button>
      </div>

      <!-- Body (kh√¥ng inner-scroll) -->
      <div class="p-6 text-sm text-gray-800 space-y-5 leading-relaxed">
        <p>
          In the <strong>Engineering Department</strong>, the HoD reviews candidates for the successor role
          <em>Senior Process Engineer</em> using three lists ‚Äî internal, incoming, and outgoing applicants.
        </p>

        <!-- Pills (3 candidate groups) -->
        <div class="flex flex-wrap gap-2">
          <span class="px-2.5 py-1 rounded-full border bg-orange-50 text-orange-700">Internal</span>
          <span class="px-2.5 py-1 rounded-full border bg-orange-50 text-orange-700">Incoming</span>
          <span class="px-2.5 py-1 rounded-full border bg-orange-50 text-orange-700">Outgoing</span>
        </div>

        <p>
          After evaluating all profiles against the <strong>Success Profile</strong>,
          a shortlist of three candidates is created. The HoD endorses <strong>two candidates</strong>
          for this <strong>two-year cycle</strong> based on the department‚Äôs capacity for
          structured development.
        </p>

        <!-- Mini matching snapshot -->
        <div class="rounded-xl border border-gray-200">
          <div class="px-4 py-2.5 border-b bg-white rounded-t-xl font-medium">
            Senior Process Engineer ‚Äî Quick Snapshot
          </div>

          <div class="p-4">
            <div class="overflow-x-auto">
              <table class="min-w-full text-sm bg-white border border-gray-200 rounded-lg">
                <thead class="bg-gray-50 text-gray-600">
                  <tr>
                    <th class="px-3 py-2 text-left">Candidate</th>
                    <th class="px-3 py-2 text-left">Segment</th>
                    <th class="px-3 py-2 text-left">Fit vs. Success Profile</th>
                    <th class="px-3 py-2 text-left">Decision</th>
                  </tr>
                </thead>
                <tbody class="divide-y">
                  <tr>
                    <td class="px-3 py-2">Nguyen A</td>
                    <td class="px-3 py-2">Internal</td>
                    <td class="px-3 py-2">High</td>
                    <td class="px-3 py-2">
                      <span class="inline-flex items-center gap-1 text-green-600 font-medium">
                        <span>‚úÖ</span> Endorsed
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td class="px-3 py-2">Tran B</td>
                    <td class="px-3 py-2">Incoming</td>
                    <td class="px-3 py-2">High</td>
                    <td class="px-3 py-2">
                      <span class="inline-flex items-center gap-1 text-green-600 font-medium">
                        <span>‚úÖ</span> Endorsed
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td class="px-3 py-2">Le C</td>
                    <td class="px-3 py-2">Outgoing</td>
                    <td class="px-3 py-2">Low</td>
                    <td class="px-3 py-2">
                      <span class="inline-flex items-center gap-1 text-gray-600 font-medium">
                        <span>‚è≥</span> Not prioritized (this cycle)
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Summary chips -->
            <div class="mt-3 flex flex-wrap items-center gap-2">
              <span class="text-xs px-2 py-1 rounded bg-green-50 border border-green-200 text-green-700">
                Capacity OK (2/2)
              </span>
              <span class="text-xs px-2 py-1 rounded bg-blue-50 border border-blue-200 text-blue-700">
                AHR: Consolidate for Gap Assessment
              </span>
              <span class="text-xs px-2 py-1 rounded bg-gray-50 border text-gray-700">
                Non-selected: Thank-you note
              </span>
            </div>

            <!-- Note -->
            <div class="mt-3 text-xs text-gray-600">
              <strong>Note:</strong> Two candidates are endorsed, while one is not prioritized for this cycle.
              The final decision is based on <em>potential, readiness, and the department‚Äôs development capacity</em>
              to provide meaningful follow-up and coaching over the next two years.
            </div>
          </div>
        </div>

        <!-- Practical guidance -->
        <p class="text-gray-700">
          In actual practice, HoDs will complete this process in the Excel file
          <strong>‚ÄúHoD Role Matching Template‚Äù</strong>. A <em>How-to Video</em> will be provided to guide to complete the file.
        </p>

        <p>
          AHR then consolidates the confirmed names to prepare for the next step ‚Äî
          <strong>Gap Assessment</strong>. Candidates who are not selected in this round will receive a
          thank-you message recognizing their effort and encouraging continued career growth within Ashley.
        </p>
      </div>

      <!-- Footer -->
      <div class="px-6 py-3 bg-gray-50 border-t flex justify-end">
        <button id="btnCloseExample2"
          class="inline-flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-1.5 rounded-lg">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- ============ Script ============ -->
<script>
  /* ===== Modal logic (OPEN/CLOSE) ===== */
  document.addEventListener('DOMContentLoaded', () => {
    const modal      = document.getElementById('exampleModal');
    const openBtn    = document.getElementById('btnOpenExample');
    const closeBtn   = document.getElementById('btnCloseExample');
    const closeBtn2  = document.getElementById('btnCloseExample2');
    const backdrop   = document.getElementById('exampleBackdrop');

    function openModal() {
      if (!modal) return;
      modal.classList.remove('hidden');
      modal.setAttribute('aria-hidden', 'false');
      document.body.classList.add('overflow-hidden');
    }
    function closeModal() {
      if (!modal) return;
      modal.classList.add('hidden');
      modal.setAttribute('aria-hidden', 'true');
      document.body.classList.remove('overflow-hidden');
    }

    if (openBtn)   openBtn.addEventListener('click', openModal);
    if (closeBtn)  closeBtn.addEventListener('click', closeModal);
    if (closeBtn2) closeBtn2.addEventListener('click', closeModal);
    if (backdrop)  backdrop.addEventListener('click', closeModal);
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal && !modal.classList.contains('hidden')) closeModal();
    });
  });

  /* ===== How-to Video timer (enable button on/after unlockAt) ===== */
  const unlockAt = new Date('2026-01-21T00:00:00+07:00').getTime();//gi·ªù video
  const videoBtn = document.getElementById('btnHowToVideo');
  const videoBadge = document.getElementById('videoBadge');

  function updateVideoState() {
    if (!videoBtn) return;
    const now = Date.now();
    if (now >= unlockAt) {
      // Enable + restyle
      videoBtn.classList.remove('bg-white','text-[#F68C2C]','border','border-[#F68C2C]','hover:bg-orange-50','pointer-events-none','opacity-60');
      videoBtn.classList.add('bg-[#F68C2C]','hover:bg-[#E67A1A]','text-white','shadow-sm');
      if (videoBadge) videoBadge.style.display = 'none';
    } else {
      // Locked
      if (videoBadge) {
        videoBadge.textContent = '‚è≥ Opens soon';
        videoBadge.style.display = 'inline-flex';
      }
      videoBtn.classList.add('pointer-events-none','opacity-60');
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    updateVideoState();
    setInterval(updateVideoState, 60000);
  });
</script>
      </div>
  </details>

	<!-- STAGE 2 summary line -->
	<div class="border-2 border-ashley-orange rounded-2xl p-4 bg-white text-sm text-gray-800 shadow-sm">
	  <span class="font-bold text-green-700">Round 1</span>
	  <span class="font-bold"> shortlists nominees based on potential, </span>
	  <span class="font-bold text-blue-700">Round 2</span>
	  <span class="font-bold"> empowers employees to apply, and </span>
	  <span class="font-bold text-ashley-orange">Round 3</span>
	  <span class="font-bold"> confirms the final endorsed list for Stage 3 ‚Äì Gap Assessment.</span>
	</div>
</div>
</div>

<!-- STAGE 3 CONTENT -->
<div id="step-3" class="step-content hidden">
  <div class="bg-white rounded-xl border p-6 mb-6">
    <h3 class="text-2xl font-bold text-gray-900 mb-2">STAGE 3: Gap Assessment</h3>
    <p class="text-gray-600 mb-6">
      To <strong>evaluate the readiness and development gaps of endorsed candidates</strong> 
      through structured self-assessment and HoD validation, comparing their current capabilities 
      against the defined Success Profile ‚Äî with the goal of <strong>identifying a focused group 
      of high-potential, high-readiness successors</strong> for prioritized and targeted 
      development investment.
    </p>

 <!-- PART A (reworked) -->
<details class="group bg-orange-50 border-l-4 border-ashley-orange rounded-r-lg mb-5">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-ashley-orange text-base flex items-center gap-2">
      üìù Part A ‚Äì Candidate Self-Assessment
    </span>
    <svg class="h-5 w-5 text-ashley-orange transition-transform duration-200 ease-out group-open:rotate-90">
      <path fill="currentColor"
        d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
    </svg>
  </summary>

  <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
	<p class="mb-3">
	  Candidates self-assess their <strong>competency levels</strong> and <strong>job qualifications</strong> 
	  based on the <strong> targeted successor position</strong>,
	  identifying key strengths and development actions.
	</p>
<!-- 2 orange action buttons -->
<div class="grid md:grid-cols-2 gap-3">
  <!-- Button 1 -->
  <button type="button" id="btnOpenCompetency"
    class="w-full text-left rounded-xl border border-orange-200 bg-white/70 hover:bg-white hover:border-ashley-orange transition p-4 shadow-sm">
    <div class="flex items-center justify-between mb-0.5">
      <h4 class="font-semibold text-gray-900 leading-tight">For Competency Requirements</h4>
      <span class="text-ashley-orange font-medium underline decoration-transparent hover:decoration-inherit">View details</span>
    </div>
    <p class="text-gray-600">
      Self-rate each competency (Scale 1‚Äì3) and explain the chosen rating.
    </p>
  </button>

  <!-- Button 2 -->
  <button type="button" id="btnOpenJQ"
    class="w-full text-left rounded-xl border border-orange-200 bg-white/70 hover:bg-white hover:border-ashley-orange transition p-4 shadow-sm">
    <div class="flex items-center justify-between mb-0.5">
      <h4 class="font-semibold text-gray-900 leading-tight">For Job Qualifications</h4>
      <span class="text-ashley-orange font-medium underline decoration-transparent hover:decoration-inherit">View details</span>
    </div>
    <p class="text-gray-600">
	Self-rate each job qualification (Scale 1‚Äì3) and explain the chosen rating.
	</p>
  </button>
</div>
</div>
</details>

<!-- ===== MODAL: Competency Requirements ===== -->
<div id="modalCompetency" class="fixed inset-0 z-50 hidden overflow-y-auto">
  <!-- Backdrop -->
  <div class="fixed inset-0 bg-black/40" data-close="modalCompetency"></div>

  <!-- Modal wrapper -->
  <div class="relative z-10 flex min-h-full items-start justify-center px-4 py-8">

    <!-- Modal content -->
    <div class="relative bg-white rounded-2xl shadow-2xl border border-orange-200 overflow-hidden max-w-4xl w-full">

      <!-- Header -->
      <div class="flex items-center justify-between px-6 py-3 bg-orange-50 border-b border-orange-100">
        <h3 class="text-base font-semibold text-orange-700">Competency Self-Assessment ‚Äì Instruction</h3>
        <button class="w-8 h-8 rounded-lg hover:bg-orange-100 text-orange-700" data-close="modalCompetency">‚úñ</button>
      </div>

      <!-- Body -->
      <div class="p-6 text-sm text-gray-800 space-y-5">

        <!-- Instruction Scale (1‚Äì3) -->
        <section>
          <div class="font-medium text-gray-900 mb-2">
            Instruction Scale (1‚Äì3): Candidate self-rating their 
            <span class="text-ashley-orange">current competency vs. target successor position</span>.
          </div>

          <div class="grid grid-cols-3 gap-3">
            <div class="rounded-lg border border-orange-200 bg-orange-50 text-center p-3">
              <div class="text-lg font-bold text-gray-900">1</div>
              <div class="text-xs text-gray-700">Far Below Expectations</div>
            </div>
            <div class="rounded-lg border border-orange-200 bg-orange-50 text-center p-3">
              <div class="text-lg font-bold text-gray-900">2</div>
              <div class="text-xs text-gray-700">Below Expectations</div>
            </div>
            <div class="rounded-lg border border-orange-300 bg-orange-100 text-center p-3">
              <div class="text-lg font-bold text-gray-900">3</div>
              <div class="text-xs text-gray-700">Meets Expectations</div>
            </div>
          </div>
        </section>

        <!-- What to explain -->
        <section>
          <div class="font-medium text-gray-900 mb-2">What to explain for each rating</div>
          <div class="grid grid-cols-3 gap-3">
            <div class="col-span-2 rounded-lg border border-orange-200 bg-orange-50 p-4 text-center">
              <div class="font-semibold mb-1">If 1‚Äì2</div>
              <div class="text-gray-800 text-xs">
                Describe the main gaps, challenges, or situations where the competency is not yet effective.
              </div>
            </div>

            <div class="col-span-1 rounded-lg border border-orange-300 bg-orange-100 p-4 text-center">
              <div class="font-semibold mb-1">If 3</div>
              <div class="text-gray-800 text-xs">
                Explain what requirements are met, and highlight any remaining areas for improvement.
              </div>
            </div>
          </div>
        </section>

        <!-- EXAMPLE TABLE ‚Äì Competency Self-Assessment -->
        <section>
          <div class="font-medium text-gray-900 mb-2">
            <span class="text-ashley-orange">Example</span> ‚Äì How to explain rating for the 
			<span class="text-ashley-orange">Competency Requirements </span>Self-Assessment
		  </div>
          <p class="text-xs text-gray-700 mb-2">
		  This table uses the Team Leader of Product Engineering role as a sample to illustrate how a candidate may self-rate and explain their readiness.
          </p>

          <div class="overflow-x-auto">
            <table class="min-w-full text-xs bg-white border border-orange-300 rounded-lg table-fixed">
              <thead class="bg-orange-200 text-gray-900">
                <tr>
                  <th class="px-3 py-2 text-left border-b border-orange-300 w-[12%]">Areas</th>
                  <th class="px-3 py-2 text-center border-b border-orange-300 w-[5%]">No.</th>
				<th class="px-3 py-2 text-left border-b border-orange-300 w-[26%]">
				  <div class="flex items-center justify-between">
				    <span>Competency Name</span>
				    <button 
				      type="button"
				      id="toggleAllBtn"
				      class="text-ashley-orange text-[11px] font-semibold hover:underline"
				      onclick="toggleAllCompetencies()">
				      Show all
				    </button>
				  </div>
				</th>
                  <th class="px-3 py-2 text-center border-b border-orange-300 w-[5%]">Self-Rating</th>
                  <th class="px-3 py-2 text-left border-b border-orange-300 w-[52%]">Example Explanation (Candidate)</th>
                </tr>
              </thead>

<tbody class="divide-y divide-orange-200">

  <!-- BUSINESS / MANAGEMENT SKILLS -->
  <!-- 1 Business Knowledge -->
  <tr>
    <td class="px-3 py-2 align-center" rowspan="4">Business / Management Skills</td>
    <td class="px-3 py-2 text-center align-center">1</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c1')">
        Business Knowledge
      </button>
      <div id="c1" class="mt-1 text-[11px] text-gray-600 hidden">
        Demonstrates a keen understanding of basic business operations and the organizational levers (systems, processes, departments, functions) that drive profitable growth, draws from personal experience to quickly evaluate business plans and processes to identify data or recommendations that need further investigation.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> In cost/vendor reviews, I grasp technical data but not full business impact.<br>
  <strong>[B]</strong> I analyze engineering details but depend on others for financial insight.<br>
  <strong>[I]</strong> This limits end-to-end evaluation, so I need more exposure to business drivers.
</td>
  </tr>

  <!-- 2 Customer Focus -->
  <tr>
    <td class="px-3 py-2 text-center align-center">2</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c2')">
        Customer Focus
      </button>
      <div id="c2" class="mt-1 text-[11px] text-gray-600 hidden">
        Ensuring that the internal or external customer‚Äôs perspective is a driving force behind strategic priorities, business decisions, organizational processes, and individual activities, crafting and implementing service practices that meet customers‚Äô and own organization‚Äôs needs, promoting and operationalizing customer service as a value.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> I consult internal customers before finalizing proposals.<br>
  <strong>[B]</strong> I adjust solutions based on their feedback to match expectations.<br>
  <strong>[I]</strong> This improves alignment; I aim to involve them earlier in new processes.
</td>
  </tr>

  <!-- 3 Decision Making -->
  <tr>
    <td class="px-3 py-2 text-center align-center">3</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c3')">
        Decision Making
      </button>
      <div id="c3" class="mt-1 text-[11px] text-gray-600 hidden">
        Identifying and understanding problems and opportunities by gathering, analyzing, and interpreting quantitative and qualitative information, choosing the best course of action by establishing clear decision criteria, generating and evaluating alternatives, and making timely decisions, taking action that is consistent with available facts and constraints and optimizes probable consequences.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Trials often require quick, informed decisions.<br>
  <strong>[B]</strong> I review data, compare options, and choose the most practical path.<br>
  <strong>[I]</strong> Decisions are solid; I‚Äôm working on improving speed under pressure.
</td>
  </tr>

  <!-- 4 Operational Excellence -->
  <tr>
    <td class="px-3 py-2 text-center align-center">4</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c4')">
        Operational Excellence
      </button>
      <div id="c4" class="mt-1 text-[11px] text-gray-600 hidden">
        The systematic approach and integrated management philosophy that enhances the efficiency, quality, and effectiveness of the company's operations.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> I join troubleshooting and waste-reduction activities.<br>
  <strong>[B]</strong> I contribute ideas but haven‚Äôt led a full improvement project yet.<br>
  <strong>[I]</strong> Impact is limited; I need experience owning CI projects end-to-end.
</td>
  </tr>

  <!-- INTERPERSONAL EFFECTIVENESS -->
  <!-- 5 Communication -->
  <tr>
    <td class="px-3 py-2 align-center" rowspan="3">Interpersonal Effectiveness</td>
    <td class="px-3 py-2 text-center align-center">5</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c5')">
        Communication
      </button>
      <div id="c5" class="mt-1 text-[11px] text-gray-600 hidden">
        Conveying information and ideas clearly and concisely to individuals or groups in an engaging manner that helps them understand and retain the message, listening actively to others.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> I explain technical issues in cross-functional meetings.<br>
  <strong>[B]</strong> I tailor explanations to different audiences for clarity.<br>
  <strong>[I]</strong> Communication is effective; written updates can still be sharper.
</td>
  </tr>

  <!-- 6 Emotional Intelligence Essentials -->
  <tr>
    <td class="px-3 py-2 text-center align-center">6</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c6')">
        Emotional Intelligence Essentials
      </button>
      <div id="c6" class="mt-1 text-[11px] text-gray-600 hidden">
        Establishing and sustaining trusting relationships by accurately perceiving and interpreting own and others‚Äô emotions and behavior, leveraging insights to effectively manage own responses so that one‚Äôs behavior matches one‚Äôs values and delivers intended results.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Under deadline pressure, team stress increases.<br>
  <strong>[B]</strong> I stay calm but sometimes react too quickly.<br>
  <strong>[I]</strong> This affects interactions; I‚Äôm learning to pause and listen more.
</td>
  </tr>

  <!-- 7 Cross-team Collaboration -->
  <tr>
    <td class="px-3 py-2 text-center align-center">7</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c7')">
        Cross-team Collaboration
      </button>
      <div id="c7" class="mt-1 text-[11px] text-gray-600 hidden">
        The ability to effectively work across diverse teams, departments, and geographical locations to achieve common goals.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> I work closely with QA and Vendor on daily issues.<br>
  <strong>[B]</strong> I coordinate well but rarely lead broader cross-team projects.<br>
  <strong>[I]</strong> To increase impact, I need stronger engagement with PD and SCO Team.
</td>
  </tr>

  <!-- PERSONAL ATTRIBUTES -->
  <!-- 8 Personal Courage -->
  <tr>
    <td class="px-3 py-2 align-center" rowspan="3">Personal Attributes</td>
    <td class="px-3 py-2 text-center align-center">8</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c8')">
        Personal Courage
      </button>
      <div id="c8" class="mt-1 text-[11px] text-gray-600 hidden">
        Proactively confronting difficult issues, making valiant choices and taking bold action in the face of opposition or fear.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> In meetings, challenging senior views can be difficult.<br>
  <strong>[B]</strong> I speak confidently in small groups but hesitate in larger forums.<br>
  <strong>[I]</strong> This limits influence; using data helps me express concerns more firmly.
</td>
  </tr>

  <!-- 9 Positive Approach -->
  <tr>
    <td class="px-3 py-2 text-center align-center">9</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c9')">
        Positive Approach
      </button>
      <div id="c9" class="mt-1 text-[11px] text-gray-600 hidden">
        Demonstrating a positive attitude in the face of difficult or challenging situations, providing an uplifting (yet realistic) outlook on what the future holds and the opportunities it might present.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> When issues arise, team morale can drop.<br>
  <strong>[B]</strong> I stay solution-oriented and encourage learning from mistakes.<br>
  <strong>[I]</strong> This keeps momentum; I‚Äôm improving how I acknowledge concerns.
</td>
  </tr>

  <!-- 10 Adaptability -->
  <tr>
    <td class="px-3 py-2 text-center align-center">10</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c10')">
        Adaptability
      </button>
      <div id="c10" class="mt-1 text-[11px] text-gray-600 hidden">
        Maintaining effectiveness when experiencing major changes in work responsibilities or environment (e.g., people, processes, structure, or culture), adjusting effectively to change by exploring the benefits, trying new approaches, and collaborating with others to make the change successful.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Priorities shift quickly with vendor or quality changes.<br>
  <strong>[B]</strong> I adjust plans fast and help operators adapt to updates.<br>
  <strong>[I]</strong> Work stays on track; I aim to communicate changes earlier.
</td>
  </tr>

  <!-- LEADERSHIP IMPACT -->
  <!-- 11 Coaching and Developing Others -->
  <tr>
    <td class="px-3 py-2 align-center" rowspan="5">Leadership Impact</td>
    <td class="px-3 py-2 text-center align-center">11</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c11')">
        Coaching and Developing Others
      </button>
      <div id="c11" class="mt-1 text-[11px] text-gray-600 hidden">
        Providing feedback, instruction, and development guidance to help others excel in their current or future job responsibilities, planning and supporting the development of individual skills and abilities.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Juniors seek help on drawings and trial tasks.<br>
  <strong>[B]</strong> I guide them, but feedback is informal and not consistent.<br>
  <strong>[I]</strong> Growth varies; I need to coach more systematically.
</td>
  </tr>

  <!-- 12 Driving Innovation -->
  <tr>
    <td class="px-3 py-2 text-center align-center">12</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c12')">
        Driving Innovation
      </button>
      <div id="c12" class="mt-1 text-[11px] text-gray-600 hidden">
        Creating an environment (culture) that inspires people to generate novel solutions with measurable value for existing and potential customers (internal or external), encouraging experimentation with new ways to solve work problems and seize opportunities that result in unique and differentiated solutions.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Most of my ideas improve existing processes.<br>
  <strong>[B]</strong> I rarely suggest new or experimental approaches.<br>
  <strong>[I]</strong> Innovation is limited; I aim to test small new methods.
</td>
  </tr>

  <!-- 13 Driving for Results -->
  <tr>
    <td class="px-3 py-2 text-center align-center">13</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c13')">
        Driving for Results
      </button>
      <div id="c13" class="mt-1 text-[11px] text-gray-600 hidden">
        Setting high goals for personal and group accomplishment, using measurement methods to monitor progress toward goals, tenaciously working to meet or exceed goals while deriving satisfaction from that achievement and continuous improvement.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 
                   text-[11px] font-semibold text-orange-900">
        3
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Deadlines get tight before pilot builds.<br>
  <strong>[B]</strong> I track progress closely and escalate issues early.<br>
  <strong>[I]</strong> Keeps timelines stable; prioritization can still improve.
</td>
  </tr>

  <!-- 14 Facilitating Change -->
  <tr>
    <td class="px-3 py-2 text-center align-center">14</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c14')">
        Facilitating Change
      </button>
      <div id="c14" class="mt-1 text-[11px] text-gray-600 hidden">
        Encouraging others to implement better approaches to address problems and opportunities, leading the implementation and acceptance of change within the workplace.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> Teams often have concerns about new processes.<br>
  <strong>[B]</strong> I support changes but don‚Äôt lead discussions or clarify the ‚Äúwhy.‚Äù<br>
  <strong>[I]</strong> Adoption slows; I need to address concerns more proactively.
</td>
  </tr>

  <!-- 15 Delegation and Empowerment -->
  <tr>
    <td class="px-3 py-2 text-center align-center">15</td>
    <td class="px-3 py-2 align-center">
      <button type="button"
              class="text-ashley-orange font-semibold hover:underline"
              onclick="toggleCompetencyDesc('c15')">
        Delegation and Empowerment
      </button>
      <div id="c15" class="mt-1 text-[11px] text-gray-600 hidden">
        Identifying and leveraging opportunities to accelerate results and build capability by assigning tasks and decision-making responsibilities to individuals or teams with clear boundaries, expectations, support, and follow-up.
      </div>
    </td>
    <td class="px-3 py-2 text-center align-center">
      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 
                   text-[11px] font-semibold text-orange-800">
        2
      </span>
    </td>
<td class="px-3 py-2 align-center">
  <strong>[S]</strong> I often keep detailed tasks to ensure accuracy.<br>
  <strong>[B]</strong> When delegating, I sometimes miss clear expectations and follow-ups.<br>
  <strong>[I]</strong> Causes rework; improving delegation structure will help.
</td>
  </tr>

</tbody>


            </table>
          </div>

          <p class="mt-3 text-xs text-gray-600 italic">
            üî∏ The examples above demonstrate how to apply the SBI method when explaining ratings. 
			AHR reminds candidates to base their self-ratings on <strong>consistent, demonstrated behavior </strong>, 
			and encourages HoDs to validate scores using the same standard‚Äîavoiding judgments 
			based on single incidents or exceptional situations.
          </p>
        </section>

      </div>

      <!-- Footer -->
      <div class="px-6 py-3 bg-gray-50 border-t flex justify-end">
        <button class="inline-flex items-center gap-2 bg-gray-200 hover:bg-gray-300 
                       text-gray-800 px-4 py-1.5 rounded-lg"
                data-close="modalCompetency">Close</button>
      </div>

    </div>
  </div>
</div>

<script>
  // toggle t·ª´ng competency (b·∫•m v√†o t√™n)
  function toggleCompetencyDesc(id) {
    const el = document.getElementById(id);
    if (!el) return;
    el.classList.toggle('hidden');
  }

  // toggle t·∫•t c·∫£ description
  let allShown = false; // tr·∫°ng th√°i hi·ªán / ·∫©n

  function toggleAllCompetencies() {
    allShown = !allShown;
    const btn = document.getElementById("toggleAllBtn");

    // l·∫•y t·∫•t c·∫£ competency description c1..c15
    const descs = document.querySelectorAll('div[id^="c"]');

    descs.forEach(div => {
      if (allShown) {
        div.classList.remove("hidden");
      } else {
        div.classList.add("hidden");
      }
    });

    // ƒë·ªïi text n√∫t
    btn.textContent = allShown ? "Hide all" : "Show all";
  }
</script>




<!-- ===== MODAL: Job Qualifications ‚Äì Self-Assessment ===== -->
<div id="modalJQ" class="fixed inset-0 z-50 hidden overflow-y-auto">
  
  <!-- Backdrop -->
  <div class="fixed inset-0 bg-black/40" data-close="modalJQ"></div>

  <!-- Wrapper -->
  <div class="relative z-10 flex min-h-full items-start justify-center px-4 py-8">

    <!-- Modal -->
    <div class="relative bg-white rounded-2xl shadow-2xl border border-orange-200 overflow-hidden max-w-5xl w-full">

      <!-- Header -->
      <div class="flex items-center justify-between px-6 py-3 bg-orange-50 border-b border-orange-100">
        <h3 class="text-base font-semibold text-orange-700">
          Job Qualifications Self-Assessment ‚Äì Instruction
        </h3>
        <button class="w-8 h-8 rounded-lg hover:bg-orange-100 text-orange-700" data-close="modalJQ">‚úñ</button>
      </div>

      <!-- Body -->
      <div class="p-6 text-sm text-gray-800 space-y-5">
   
	    
        <!-- QUESTION -->
        <section>
			<div class="font-medium text-gray-900 mb-2">
			Instruction Scale (1‚Äì3): Candidate self-rating their 
            <span class="text-ashley-orange">current experience vs. target successor position</span>.
			<p class="mt-2 text-[11px] text-gray-700">
            Describe how the candidate‚Äôs current experience aligns with the job qualifications defined in the 
            <strong>Successor Profile</strong> of the intended successor role (e.g., education, years of experience, 
            certifications, tools, and communication skills).
          </p>
        </section>

        <!-- SCALE 1‚Äì3 -->
        <section>
          <div class="grid grid-cols-3 gap-3">

            <!-- Rating 1 -->
            <div class="rounded-lg border border-orange-200 bg-orange-50 p-3 text-center">
              <div class="text-lg font-bold text-gray-900">1</div>
              <div class="text-xs font-semibold text-gray-700 mb-1">Far Below Expectations</div>
              <div class="text-[11px] text-gray-600 leading-snug">
                The candidate has limited or no relevant experience, education, or skills for this requirement.
              </div>
            </div>

            <!-- Rating 2 -->
            <div class="rounded-lg border border-orange-200 bg-orange-50 p-3 text-center">
              <div class="text-lg font-bold text-gray-900">2</div>
              <div class="text-xs font-semibold text-gray-700 mb-1">Below Expectations</div>
              <div class="text-[11px] text-gray-600 leading-snug">
                The candidate partially meets the requirement but still has noticeable gaps or requires 
				more consistent and demonstrated experience.
              </div>
            </div>

            <!-- Rating 3 -->
            <div class="rounded-lg border border-orange-300 bg-orange-100 p-3 text-center">
              <div class="text-lg font-bold text-gray-900">3</div>
              <div class="text-xs font-semibold text-gray-700 mb-1">Meets Expectations</div>
              <div class="text-[11px] text-gray-600 leading-snug">
                The candidate meets the requirement for the targeted successor role, 
				with clear and relevant experience or qualifications already demonstrated.
              </div>
            </div>

          </div>
        </section>

        <!-- EXPLANATION REQUIREMENT -->
        <section class="mt-4">
          <div class="font-medium text-gray-900 mb-2">What to explain for each rating</div>

          <div class="grid grid-cols-3 gap-3">

            <!-- If 1‚Äì2 -->
            <div class="col-span-2 rounded-lg border border-orange-200 bg-orange-50 p-4 text-center">
              <div class="font-semibold mb-1">If 1‚Äì2</div>
              <div class="text-gray-800 text-xs leading-snug">
                The candidate should describe the main gaps or challenges they currently face 
				(e.g., missing experience, limited exposure, or skills they still need to build).
              </div>
            </div>

            <!-- If 3 -->
            <div class="col-span-1 rounded-lg border border-orange-300 bg-orange-100 p-4 text-center">
              <div class="font-semibold mb-1">If 3</div>
              <div class="text-gray-800 text-xs leading-snug">
                The candidate should explain how they meet the requirement (e.g., years of relevant 
				experience, specific tools or contexts) and note any areas they still want to improve.
              </div>
            </div>

          </div>

        </section>

        <!-- EXAMPLE TABLE -->
        <section class="mt-4">
          <div class="font-medium text-gray-900 mb-2">
            <span class="text-ashley-orange">Example</span> ‚Äì How to explain rating for the
            <span class="text-ashley-orange">Job Qualifications</span>  Self-Assessment 
          </div>
          <p class="text-xs text-gray-700 mb-2">
            This table uses the Team Leader of Product Engineering role as a sample to illustrate 
			how a candidate may self-rate and explain their readiness.
          </p>

          <div class="overflow-x-auto">
            <table class="min-w-full text-xs bg-white border border-orange-300 rounded-lg table-fixed">
              <thead class="bg-orange-200 text-gray-900">
                <tr>
                  <th class="px-3 py-2 text-left border-b border-orange-300 w-[10%]">Field</th>
                  <th class="px-3 py-2 text-left border-b border-orange-300 w-[30%]">Requirement (Sample)</th>
                  <th class="px-3 py-2 text-center border-b border-orange-300 w-[5%]">Self-Rating</th>
                  <th class="px-3 py-2 text-left border-b border-orange-300 w-[55%]">Example Explanation (Candidate)</th>
                </tr>
              </thead>
		<tbody class="divide-y divide-orange-200">
		
		  <!-- Years of Experience Required -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Years of Experience Required</td>
		    <td class="px-3 py-2 align-center">
		      At least 5 years of experience in Engineering, Lean, or project management; furniture manufacturing background required; leadership experience required.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 text-[11px] font-semibold text-orange-800">
		        2
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      I have 4 years of experience in engineering and process improvement, mainly supporting manufacturing optimization projects. 
		      I have coordinated small task groups but have not held a formal leadership role. I still need broader exposure to furniture manufacturing 
		      and more structured people-leadership responsibilities.
		    </td>
		  </tr>
		
		  <!-- Educational Background -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Educational Background</td>
		    <td class="px-3 py-2 align-center">
		      College and above; major in Engineering, Lean, or Industrial Management.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 text-[11px] font-semibold text-orange-900">
		        3
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      I hold a Bachelor‚Äôs degree in Industrial Engineering. The major aligns directly with the role requirements, 
		      and I regularly apply engineering concepts in process improvement and technical problem-solving.
		    </td>
		  </tr>
		
		  <!-- Certifications -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Certifications</td>
		    <td class="px-3 py-2 align-center">
		      Not specified in JD.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 text-[11px] font-semibold text-orange-900">
		        3
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      The role does not require specific certifications. I have completed internal courses on Lean, problem solving, and factory processes, 
		      and I plan to pursue a Lean certification to further strengthen my technical foundation.
		    </td>
		  </tr>
		
		  <!-- Functional/Technical Knowledge -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Functional/Technical Knowledge</td>
		    <td class="px-3 py-2 align-center">
		      NEWGO process; PPR reviews; drawings evaluation; AIS, CTN, RPDF review; vendor communication; 
		      PPR tracking; quality/process projects; AutoCAD; MS Office.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-300 bg-orange-50 text-[11px] font-semibold text-orange-800">
		        2
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      I have strong experience with AutoCAD, MS Office, and quality/process improvement projects. 
		      However, I still need more hands-on practice with NEWGO, CTN/RPDF reviews, and independent drawing evaluation. 
		      I am also developing deeper vendor communication skills for more technical discussions.
		    </td>
		  </tr>
		
		  <!-- Language/Communication Skills -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Language/ Communication Skills</td>
		    <td class="px-3 py-2 align-center">
		      Effective English communication skills.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 text-[11px] font-semibold text-orange-900">
		        3
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      I use English regularly when preparing reports and communicating with cross-functional teams. 
		      I can explain technical issues clearly, though I continue to improve my fluency for discussions 
		      with overseas suppliers and more complex topics.
		    </td>
		  </tr>
		
		  <!-- Other Role-Specific Requirements -->
		  <tr>
		    <td class="px-3 py-2 font-medium align-center">Other Role-Specific Requirements</td>
		    <td class="px-3 py-2 align-center">
		      Work under high demands; manage multiple tasks; empathy; factory environment; lifting up to 50 lbs; 
		      bending/stooping; exposure to dirt, dust, chemicals, and noise.
		    </td>
		    <td class="px-3 py-2 text-center align-center">
		      <span class="inline-flex items-center justify-center px-2 py-1 border border-orange-400 bg-orange-100 text-[11px] font-semibold text-orange-900">
		        3
		      </span>
		    </td>
		    <td class="px-3 py-2 align-center">
		      I work daily on the production floor and am comfortable operating in a fast-paced, high-demand environment. 
		      I manage multiple engineering tasks simultaneously and communicate with operators and supervisors with empathy. 
		      I meet the physical requirements, including lifting and mobility in factory conditions.
		    </td>
		  </tr>
		
		</tbody>

            </table>
          </div>
        </section>

        <p class="text-xs text-gray-600 italic mt-3">
          üî∏ This self-assessment is for <strong>development planning only</strong> and does <strong>not</strong> guarantee promotion.
          Please rate yourself honestly so that your HoD and AHR can design realistic development support and close the right gaps.
        </p>

      </div>

      <!-- Footer -->
      <div class="px-6 py-3 bg-gray-50 border-t flex justify-end">
        <button class="inline-flex items-center gap-2 bg-gray-200 hover:bg-gray-300 
                       text-gray-800 px-4 py-1.5 rounded-lg"
                data-close="modalJQ">Close</button>
      </div>

    </div>
  </div>
</div>



<!-- ===== Scripts: open/close + toggle info ===== -->
<script>
  // Open modals
  document.getElementById('btnOpenCompetency')?.addEventListener('click', () => {
    document.getElementById('modalCompetency')?.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  });
  document.getElementById('btnOpenJQ')?.addEventListener('click', () => {
    document.getElementById('modalJQ')?.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  });

  // Close modals (by button or backdrop)
  document.querySelectorAll('[data-close="modalCompetency"]').forEach(el =>
    el.addEventListener('click', () => {
      document.getElementById('modalCompetency')?.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    })
  );
  document.querySelectorAll('[data-close="modalJQ"]').forEach(el =>
    el.addEventListener('click', () => {
      document.getElementById('modalJQ')?.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    })
  );

  // ESC to close
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      document.getElementById('modalCompetency')?.classList.add('hidden');
      document.getElementById('modalJQ')?.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }
  });

  // Toggle JQ info box
  document.getElementById('toggleJQInfo')?.addEventListener('click', () => {
    const box = document.getElementById('jqInfoBox');
    if (!box) return;
    box.classList.toggle('hidden');
  });
</script>

<!-- PART B -->
<details class="group bg-green-50 border-l-4 border-green-500 rounded-r-lg mb-4">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-green-700 text-base flex items-center gap-2">
      ‚úÖ Part B ‚Äì HoD / Manager Validation
    </span>
    <svg class="h-5 w-5 text-green-600 transition-transform duration-200 ease-out group-open:rotate-90">
      <path fill="currentColor"
        d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z" />
    </svg>
  </summary>

  <div class="px-5 pb-4 pt-1 text-sm text-gray-800">
    <p class="mb-3">
      <strong>HoD validates the candidate‚Äôs self-ratings</strong>, provides comments, and may adjust the numerical score (1‚Äì5) if needed.
      Then use the <strong>Readiness Scale</strong> to classify:
    </p>

    <!-- Readiness selector + Training box in same grid -->
    <div id="readinessGridB" class="grid md:grid-cols-2 gap-3">

      <!-- ‚úÖ Ready Now -->
      <button type="button"
        class="readiness-card group text-left rounded-xl border border-emerald-300 bg-emerald-100 hover:bg-emerald-200 transition p-4 shadow-sm"
        data-readiness="Ready Now (‚â§ 6 months)">
        <div class="flex items-start gap-2">
          <span class="shrink-0 inline-flex items-center justify-center w-6 h-6 text-base">‚úÖ</span>
          <div class="flex-1">
            <div class="font-semibold text-emerald-900">
              Ready Now <span class="font-normal text-xs text-emerald-800">(‚â§ 6 months)</span>
            </div>
            <div class="text-gray-800 text-xs">Shows full readiness; can step into the role with minimal transition.</div>
            <div class="readiness-detail mt-2 hidden text-xs text-gray-800">
              Candidate already demonstrates the skills, behaviors, and maturity required for the target role. 
			  Can step into the position with minimal transition time and support required.
            </div>
          </div>
          <svg class="hidden readiness-check w-5 h-5 text-emerald-700" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 00-1.414 0L8 12.586 4.707 9.293A1 1 0 103.293 10.707l4 4a1 1 0 001.414 0l8-8a1 1 0 000-1.414z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </button>

      <!-- ‚è≥ Ready Soon -->
      <button type="button"
        class="readiness-card group text-left rounded-xl border border-green-300 bg-green-100 hover:bg-green-200 transition p-4 shadow-sm"
        data-readiness="Ready Soon (‚â§ 2 years)">
        <div class="flex items-start gap-2">
          <span class="shrink-0 inline-flex items-center justify-center w-6 h-6 text-base">‚è≥</span>
          <div class="flex-1">
            <div class="font-semibold text-green-900">
              Ready Soon <span class="font-normal text-xs text-green-800">(‚â§ 2 years)</span>
            </div>
            <div class="text-gray-800 text-xs">Strong potential; needs focused development to close remaining gaps.</div>
            <div class="readiness-detail mt-2 hidden text-xs text-gray-800">
              Shows strong potential but still has observable gaps
			  (e.g., leadership exposure, technical depth, or cross-functional experience).
			  Likely to be ready if given focused development opportunities within the next 1‚Äì2 years.
            </div>
          </div>
          <svg class="hidden readiness-check w-5 h-5 text-emerald-700" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 00-1.414 0L8 12.586 4.707 9.293A1 1 0 103.293 10.707l4 4a1 1 0 001.414 0l8-8a1 1 0 000-1.414z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </button>

      <!-- üå± Ready Later -->
      <button type="button"
        class="readiness-card group text-left rounded-xl border border-lime-300 bg-lime-100 hover:bg-lime-200 transition p-4 shadow-sm"
        data-readiness="Ready Later (> 2 years)">
        <div class="flex items-start gap-2">
          <span class="shrink-0 inline-flex items-center justify-center w-6 h-6 text-base">üå±</span>
          <div class="flex-1">
            <div class="font-semibold text-lime-900">
              Ready Later <span class="font-normal text-xs text-lime-800">(> 2 years)</span>
            </div>
            <div class="text-gray-800 text-xs">Motivated and growing; requires significant time and structured support.</div>
            <div class="readiness-detail mt-2 hidden text-xs text-gray-800">
              Shows motivation and some relevant strengths but requires significant development 
			  before being considered for the role. More than 2 years of growth expected before readiness.
            </div>
          </div>
          <svg class="hidden readiness-check w-5 h-5 text-emerald-700" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 00-1.414 0L8 12.586 4.707 9.293A1 1 0 103.293 10.707l4 4a1 1 0 001.414 0l8-8a1 1 0 000-1.414z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </button>

      <!-- üö´ Not Ready -->
      <button type="button"
        class="readiness-card group text-left rounded-xl border border-gray-300 bg-gray-100 hover:bg-gray-200 transition p-4 shadow-sm"
        data-readiness="Not Ready for Succession Planning">
        <div class="flex items-start gap-2">
          <span class="shrink-0 inline-flex items-center justify-center w-6 h-6 text-base">üö´</span>
          <div class="flex-1">
            <div class="font-semibold text-gray-900">Not Ready for Succession Planning</div>
            <div class="text-gray-800 text-xs">Low readiness or incomplete assessment seriously; needs constructive feedback and growth.</div>
            <div class="readiness-detail mt-2 hidden text-xs text-gray-800">
              Includes individuals who either did not complete the Gap Assessment seriously or 
			  are not currently demonstrating motivation or relevant strengths for the intended successor role. 
			  Constructive feedback should still be provided to support long-term development.
            </div>
          </div>
          <svg class="hidden readiness-check w-5 h-5 text-emerald-700" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M16.707 5.293a1 1 0 00-1.414 0L8 12.586 4.707 9.293A1 1 0 103.293 10.707l4 4a1 1 0 001.414 0l8-8a1 1 0 000-1.414z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </button>

<!-- Footnotes (aligned flush with cards, balanced spacing) -->
<div class="md:col-span-2 pt-1 text-sm text-gray-800">
  <p class="mb-0.5">
    üî∏ Each readiness level should reflect <strong>consistent, observable behavior over time</strong> ‚Äî not a single event.
  </p>
  <p class="mb-0.5">
    üî∏ Candidates can view comments and adjusted ratings; the readiness level is visible to AHR & HoD only.
  </p>
</div>

      <!-- üìò Training Box -->
      <div class="md:col-span-2 border border-green-300 bg-white rounded-lg p-4 mt-1">
        <p class="font-medium text-green-700 mb-2">Training sessions planned for this stage:</p>
        <ul class="list-disc pl-5 space-y-1 text-sm text-gray-800">
          <li>
            <strong>AHR hosts a Candidate Orientation Workshop</strong> before the Gap Assessment stage to introduce program goals,
            equip candidates to complete self-assessment & understand expectations, and train them to provide
            structured explanations using the <strong>SBI (Situation‚ÄìBehavior‚ÄìImpact)</strong> method.
          </li>
          <li>
            An optional <strong>Manager Validation Workshop</strong> is also conducted to instruct HoDs and managers
            on how to validate assessments, provide constructive written feedback, and apply the
            <strong>Readiness Scale</strong> consistently across departments.
          </li>
        </ul>
      </div>
    </div>

    <input type="hidden" id="readinessSelectedB" name="readiness_selected" value="">
  </div>
</details>

<script>
  // Interactivity for readiness cards
  (function () {
    const grid = document.getElementById('readinessGridB');
    if (!grid) return;
    const cards = grid.querySelectorAll('.readiness-card');
    const hidden = document.getElementById('readinessSelectedB');

    // H√†m thu g·ªçn t·∫•t c·∫£ card v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu
    function resetCards() {
      cards.forEach(c => {
        c.classList.remove('ring-2', 'ring-emerald-600', 'bg-green-50');
        c.querySelector('.readiness-detail')?.classList.add('hidden');
        c.querySelector('.readiness-check')?.classList.add('hidden');
      });
      if (hidden) hidden.value = '';
    }

    // Ch·ªçn m·ªôt card
    cards.forEach(card => {
      card.addEventListener('click', (ev) => {
        // NgƒÉn s·ª± ki·ªán lan ra document (tr√°nh b·ªã reset ngay l·∫≠p t·ª©c)
        ev.stopPropagation();
        cards.forEach(c => {
          c.classList.remove('ring-2', 'ring-emerald-600', 'bg-green-50');
          c.querySelector('.readiness-detail')?.classList.add('hidden');
          c.querySelector('.readiness-check')?.classList.add('hidden');
        });
        card.classList.add('ring-2', 'ring-emerald-600', 'bg-green-50');
        card.querySelector('.readiness-detail')?.classList.remove('hidden');
        card.querySelector('.readiness-check')?.classList.remove('hidden');
        if (hidden) hidden.value = card.dataset.readiness || '';
      });
    });

    // B·∫•m ra ngo√†i 4 n√∫t ‚Üí thu g·ªçn l·∫°i
    document.addEventListener('click', (e) => {
      // N·∫øu click KH√îNG n·∫±m trong m·ªôt .readiness-card th√¨ reset
      if (!e.target.closest('.readiness-card')) {
        resetCards();
      }
    });
  })();
</script>


<!-- PART C -->
<details class="group bg-blue-50 border-l-4 border-blue-500 rounded-r-lg mb-4">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-blue-700 text-base flex items-center gap-2">
      üìä Part C ‚Äì Gap Summary & Talent Pool Confirmation
    </span>
    <svg class="h-5 w-5 text-blue-600 transition-transform duration-200 ease-out group-open:rotate-90">
      <path fill="currentColor"
        d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z" />
    </svg>
  </summary>

  <div class="px-5 pb-4 pt-1 text-sm text-gray-800 space-y-4">
    <p>
      AHR consolidates all validated assessments into a clear visualization of 
      <strong>competency gaps</strong>, <strong>qualification alignment</strong>, and 
      <strong>behavioral evidence</strong> across departments.
      These insights help leaders recognize strengths, pinpoint development themes, 
      and prioritize investment areas for capability building.
    </p>
    <p>
      Based on the <strong>Readiness Scale </strong>applied in Part B, 
	  candidates are classified and subsequently grouped into <strong>three talent categories</strong>
	  each with clear development focus and corresponding next-step actions as outlined below:
    </p>

 <!-- RESULTING GROUPS (colored backgrounds + badges below title) -->
<div class="grid md:grid-cols-3 gap-3 mt-4">

  <!-- üü¢ Official Talent Pool -->
  <div class="rounded-lg border border-emerald-300 bg-emerald-100 hover:bg-emerald-200 transition p-4 shadow-sm cursor-pointer">
    <div>
      <div class="flex items-center gap-2">
        <p class="font-semibold text-green-800">üü¢ Official Talent Pool</p>
      </div>
      <!-- badges below -->
      <div class="flex flex-wrap gap-1 mt-1">
        <span class="inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full border bg-white
                     border-emerald-300 text-emerald-700">
          ‚úÖ <span>Ready Now <span class="opacity-70">(‚â§ 6 months)</span></span>
        </span>
        <span class="inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full border bg-white
                     border-green-300 text-green-700">
          ‚è≥ <span>Ready Soon <span class="opacity-70">(‚â§ 2 years)</span></span>
        </span>
      </div>
    </div>
    <ul class="list-disc pl-5 space-y-1 text-sm mt-3">
      <li>Proceed to <strong>Stage 4 ‚Äì IDP Execution</strong>.</li>
      <li>Enroll in structured development plan.</li>
      <li>Prepare for the <strong>Talent Review Event</strong>.</li>
    </ul>
  </div>

  <!-- üü° Talent Watch List -->
  <div class="rounded-lg border border-lime-300 bg-lime-100 hover:bg-lime-200 transition p-4 shadow-sm cursor-pointer">
    <div>
      <div class="flex items-center gap-2">
        <p class="font-semibold text-lime-800">üü° Talent Watch List</p>
      </div>
      <!-- badge below -->
      <div class="flex flex-wrap gap-1 mt-1">
        <span class="inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full border bg-white
                     border-lime-300 text-lime-700">
          üå± <span>Ready Later<span class="opacity-70">(> 2 years)</span></span>
        </span>
      </div>
    </div>
    <ul class="list-disc pl-5 space-y-1 text-sm mt-3">
      <li>Longer-term coaching & tracking with department leaders.</li>
      <li>Targeted exposure to build readiness.</li>
      <li>Consider in next succession cycle.</li>
    </ul>
  </div>

  <!-- üî¥ Development Hold Group -->
  <div class="rounded-lg border border-gray-300 bg-gray-100 hover:bg-gray-200 transition p-4 shadow-sm cursor-pointer">
    <div>
      <div class="flex items-center gap-2">
        <p class="font-semibold text-gray-800">üî¥ Development Hold Group</p>
      </div>
      <!-- badge below -->
      <div class="flex flex-wrap gap-1 mt-1">
        <span class="inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full border bg-white
                     border-red-300 text-red-700">
          üö´ <span>Not Ready for Succession Planning</span>
        </span>
      </div>
    </div>
    <ul class="list-disc pl-5 space-y-1 text-sm mt-3">
      <li>Provide constructive feedback & guidance.</li>
      <li>Encourage self-development and re-entry later.</li>
      <li>Receive a thank-you email for participation.</li>
    </ul>
  </div>
</div>


	<!-- üîπ Outcome Box -->
	<div class="md:col-span-2 border border-blue-300 bg-white rounded-lg p-4 mt-2">
	  <p class="font-medium text-blue-700 mb-2">Outcome:</p>
	  <p class="text-sm text-gray-800 leading-relaxed">
	    The <strong>Talent Pool</strong> forms the primary focus group and foundation for 
	    Stage 4 ‚Äì IDP Execution and upcoming Stage 5 ‚Äì Talent Review Presentations.
	    The <strong>Talent Watch List</strong> serves as the near-term feeder group, supported for sustained growth 
	    and future readiness in the next cycle.
	  </p>
	</div>		
	</details>



    <!-- STAGE 3 SUMMARY LINE -->
    <div class="border-2 border-ashley-orange rounded-2xl p-4 bg-white text-sm text-gray-800 shadow-sm">
      <span class="font-bold text-ashley-orange">Part A</span>
      <span class="font-bold"> captures candidate self-assessment evidence, </span>
      <span class="font-bold text-green-700">Part B</span>
      <span class="font-bold"> validates and assigns readiness, </span>
      <span class="font-bold text-blue-700">Part C</span>
      <span class="font-bold"> consolidates gap findings and finalizes the Talent Pool &amp; Watch List for Stage 4 ‚Äì IDP Execution.</span>
    </div>
  </div>
</div>

<!-- ============ STAGE 4: IDP Execution ‚Äì Closing the Gap ============ -->
<div id="step-4" class="step-content hidden">
  <div class="bg-white rounded-xl border p-6 mb-6">
    <h3 class="text-2xl font-bold text-gray-900 mb-2">STAGE 4: IDP Execution ‚Äì Closing the Gap</h3>
    <p class="text-gray-600 mb-4">
      Enable successors to <strong>address identified gaps and strengthen readiness</strong>
      through a personalized development plan, guided <strong>by the 70-20-10 learning model.</strong>
      The plan emphasizes <strong>strong support and regular follow-up by managers</strong> and quarterly reviews
      to ensure accountability and progress along the development path.
    </p>

    <!-- Sub-tabs -->
    <div class="border-b mb-4">
	<nav class="flex flex-wrap gap-5">
		<button data-tab="overview" onclick="s4ShowTab('overview', event)" class="s4-tab-btn border-b-2 border-ashley-orange text-ashley-orange py-2 px-1 text-sm font-medium">Overview</button>
		<button data-tab="idp"      onclick="s4ShowTab('idp', event)"      class="s4-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">IDP Design Process</button>
		<button data-tab="tracking" onclick="s4ShowTab('tracking', event)" class="s4-tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">Tracking & Review Cycle</button>
	</nav>
    </div>

    <!-- ================= Panel: OVERVIEW ================= -->
    <div id="s4_panel_overview" class="s4-panel">
      <!-- General definition -->
<!-- WHAT‚ÄìWHY‚ÄìWHO ¬∑ Clean version (no emojis or small labels) -->
<div class="grid sm:grid-cols-3 gap-3 text-sm mb-6"> <!-- th√™m mb-6 ƒë·ªÉ t·∫°o kho·∫£ng c√°ch d∆∞·ªõi -->
  
  <!-- WHAT -->
  <div class="rounded-xl border bg-white shadow-sm p-5 relative">
    <div class="absolute left-0 top-0 h-1 w-full rounded-t-xl bg-gradient-to-r from-amber-500/80 to-transparent"></div>
    <h4 class="text-base sm:text-lg font-semibold text-amber-700 mb-1">
      What is an IDP?
    </h4>
    <p class="text-gray-700">
      A living plan of <em>skills, goals, and 70-20-10 actions</em> guiding successors toward target roles.
    </p>
  </div>

  <!-- WHY -->
  <div class="rounded-xl border bg-white shadow-sm p-5 relative">
    <div class="absolute left-0 top-0 h-1 w-full rounded-t-xl bg-gradient-to-r from-indigo-500/80 to-transparent"></div>
    <h4 class="text-base sm:text-lg font-semibold text-indigo-700 mb-1">
      Why do we use it?
    </h4>
    <p class="text-gray-700">
      It turns Step 3 gaps into a clear, trackable development roadmap with quarterly review & accountability.
    </p>
  </div>

  <!-- WHO -->
  <div class="rounded-xl border bg-white shadow-sm p-5 relative">
    <div class="absolute left-0 top-0 h-1 w-full rounded-t-xl bg-gradient-to-r from-emerald-500/80 to-transparent"></div>
    <h4 class="text-base sm:text-lg font-semibold text-emerald-700 mb-1">
      Who uses it in this program?
    </h4>
    <p class="text-gray-700">
      <em>Successors</em> draft & update ¬∑ <em>HoDs / Leaders</em> coach & review ¬∑ <em>AHR</em> tracks & supports.
    </p>
  </div>
</div>


      <!-- Overview accordions (aligned look) -->
<details class="group rounded-r-lg mb-4 bg-orange-50 border-l-4 border-orange-500">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-orange-700 text-base flex items-center gap-2">üß© IDP Design Process</span>
    <svg class="h-5 w-5 text-orange-600 transition-transform duration-200 ease-out group-open:rotate-90">
      <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
    </svg>
  </summary>
	  <div class="px-5 pb-4 pt-1 text-sm text-gray-900">
	    <ol class="list-decimal pl-6 space-y-1.5">
	      <li>
	        <strong>AHR conducts workshop</strong> on the IDP template, 70‚Äì20‚Äì10 framework, milestones, and evidence standards.
	      </li>
	      <li>
	        <strong>Successors draft IDP</strong> aligned with readiness level and Success Profile, defining milestones, evidence, support, and risks.
	      </li>
	      <li>
	        <strong>Managers & AHR review drafts</strong> for feasibility and learning balance before <strong>HoD approval</strong>.
	      </li>
	      <li>
	        <strong>Successors execute & track</strong> their 70‚Äì20‚Äì10 actions quarterly, with progress reviewed and consolidated for the annual bootcamp program.
	      </li>
	    </ol>
	  </div>
	</details>

<details class="group rounded-r-lg mb-4 bg-green-50 border-l-4 border-green-500">
  <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
    <span class="font-semibold text-green-700 text-base flex items-center gap-2">
      üèïÔ∏è CVRO Talent NextGen Bootcamp
    </span>
    <svg class="h-5 w-5 text-green-600 transition-transform duration-200 ease-out group-open:rotate-90" viewBox="0 0 20 20" aria-hidden="true">
      <path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/>
    </svg>
  </summary>

  <div class="px-5 pb-4 pt-1 text-sm text-gray-900 leading-relaxed">
    <!-- Badge 70‚Äì20‚Äì10 (n·ªïi b·∫≠t nh∆∞ng v·∫´n ‚Äúxanh‚Äù) -->
    <div class="flex flex-wrap gap-2 mb-4">
      <span class="inline-flex items-center gap-1 text-[12px] px-3 py-1 rounded-full border bg-white/70 border-emerald-300 text-emerald-800 font-semibold shadow-[0_0_0_2px_rgba(16,185,129,0.08)]">
        70% ¬∑ Experiential
      </span>
      <span class="inline-flex items-center gap-1 text-[12px] px-3 py-1 rounded-full border bg-white/60 border-sky-300 text-sky-900 font-semibold shadow-[0_0_0_2px_rgba(2,132,199,0.08)]">
        20% ¬∑ Social
      </span>
      <span class="inline-flex items-center gap-1 text-[12px] px-3 py-1 rounded-full border bg-white/60 border-amber-300 text-amber-900 font-semibold shadow-[0_0_0_2px_rgba(245,158,11,0.10)]">
        10% ¬∑ Formal
      </span>
    </div>

    <!-- Intro ng·∫Øn g·ªçn, l√¥i cu·ªën -->
    <p class="mb-4 text-gray-800">
      A high-energy, multi-day journey blending <strong>case-based simulations</strong>, <strong>peer-learning circles</strong>, and <strong>expert mini-workshops</strong>‚Äîbuilt on the 70‚Äì20‚Äì10 model to accelerate leadership, collaboration, and strategic thinking while boosting visibility with management.
    </p>


<!-- Benefit cards (centered, color-coded titles, top aligned) -->
<div class="grid sm:grid-cols-3 gap-4 mb-4 text-center justify-items-center items-start">
  <!-- Impact -->
  <div class="w-full rounded-lg border border-gray-200 bg-white/80 p-4 flex flex-col h-full">
    <p class="text-[13px] font-bold text-emerald-600 mb-2 uppercase tracking-wide">Impact</p>
    <p class="text-gray-800 text-sm leading-relaxed">
      Real business challenges turn learning into <strong>practical readiness</strong> and influence beyond authority.
    </p>
  </div>

  <!-- Visibility -->
  <div class="w-full rounded-lg border border-gray-200 bg-white/80 p-4 flex flex-col h-full">
    <p class="text-[13px] font-bold text-sky-600 mb-2 uppercase tracking-wide">Visibility</p>
    <p class="text-gray-800 text-sm leading-relaxed">
      Pitch to management, gain <strong>confidence & recognition</strong> through direct feedback.
    </p>
  </div>

  <!-- IDP & Talent Review -->
  <div class="w-full rounded-lg border border-gray-200 bg-white/80 p-4 flex flex-col h-full">
    <p class="text-[13px] font-bold text-amber-600 mb-2 uppercase tracking-wide">IDP & Talent Review</p>
    <p class="text-gray-800 text-sm leading-relaxed">
Equips successors with essential presentation skills to excel in the <strong>Talent Review Event (Stage 5)</strong> and showcase their growth. </p>
  </div>
</div>


    <!-- N·ªôi dung c·ªët l√µi c√¥ ƒë·ªçng -->
    <p class="mb-1 text-gray-800">
      Focused on closing <strong>common gaps</strong> from the Gap Analysis Summary, the Bootcamp translates learning into <strong>actionable outcomes</strong>‚Äîwith AHR & HoDs guiding mentoring, project assignments, and exposure opportunities across the year.
    </p>
  </div>
</details>






      <details class="group rounded-r-lg bg-blue-50 border-l-4 border-blue-500">
        <summary class="flex items-center justify-between cursor-pointer select-none px-5 py-3">
          <span class="font-semibold text-blue-700 text-base flex items-center gap-2">üîÅ Tracking & Review Cycle</span>
          <svg class="h-5 w-5 text-blue-600 transition-transform duration-200 ease-out group-open:rotate-90"><path fill="currentColor" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.12l3.71-2.89a.75.75 0 1 1 1.04 1.08l-4.24 3.31a.75.75 0 0 1-.93 0L5.21 8.31a.75.75 0 0 1 .02-1.1z"/></svg>
        </summary>
        <div class="px-5 pb-4 pt-1 text-sm text-gray-900">
          <ol class="list-decimal pl-6 space-y-1">
		  <li><strong>Draft</strong> ‚Äî define quarterly milestones, target dates, and evidence.</li>
		  <li><strong>Review</strong> ‚Äî leader validates priorities; HoD approves plan.</li>
		  <li><strong>Update</strong> ‚Äî submit progress and next actions by last Friday of each quarter.</li>
		  <li><strong>Monitor</strong> ‚Äî AHR tracks submissions, readiness movement, and flags overdue items.</li>
          </ol>
        </div>
      </details>
	  
	 <!-- STAGE 4 summary line -->
		<div class="border-2 border-ashley-orange rounded-2xl p-4 bg-white text-sm text-gray-800 shadow-sm mt-5">
		  <span class="font-bold text-ashley-orange">The IDP Design Process</span>
		  <span class="font-bold"> guides successors and HoDs to co-create personalized development plans aligned with Success Profile gaps</span>;
		  <span class="font-bold text-blue-700"> the Tracking & Review Cycle</span>
		  <span class="font-bold"> ensures quarterly progress reviews, accountability, and targeted learning support driven by AHR.</span>
		</div>	  
    </div>

    <!-- ================= Panel: IDP DESIGN PROCESS ================= -->
    <div id="s4_panel_idp" class="s4-panel hidden">
      <div class="bg-white rounded-xl border p-4">
        <h4 class="text-lg font-semibold text-gray-900 mb-4">End-to-End IDP Execution Flow</h4>

<!-- Timeline -->
<ol class="relative border-s border-gray-200 ps-5 space-y-7 text-gray-800">
  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-amber-500"></div>
    <p class="font-semibold">AHR-led IDP Workshop
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200">AHR</span>
    </p>
    <p class="text-gray-700">
      AHR conducts a workshop on the IDP template, 70‚Äì20‚Äì10 framework, milestones, and evidence standards.
    </p>
  </li>

  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-blue-500"></div>
    <p class="font-semibold">Successor Drafts IDP
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200">Successor</span>
    </p>
    <p class="text-gray-700">
      Successors draft their IDP aligned with readiness level and Success Profile, defining quarterly milestones,
      evidence, support, and risks.
    </p>

    <!-- Open stage4 link from assets/links.csv -->
    <div class="mt-2">
      <a
        data-link-id="stage4"
        href="#"
        target="_blank"
        class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-ashley-orange text-white font-semibold text-sm hover:bg-ashley-orange-dark">
        View IDP Template & Example
      </a>
    </div>
  </li>

  <!-- üü£ Direct Manager Reviews (NEW, required before HoD) -->
  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-purple-500"></div>
    <p class="font-semibold">Direct Manager Reviews
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-purple-50 text-purple-700 border border-purple-200">Leader</span>
    </p>
    <p class="text-gray-700">
      The direct manager reviews the draft with the successor to confirm priorities, resourcing, and alignment with team plans;
      revisions are made before sending forward.
    </p>
  </li>

  <!-- üü† AHR Reviews & Suggests (moved after Manager; wording tweaked) -->
  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-amber-500"></div>
    <p class="font-semibold">AHR Reviews & Suggests
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200">AHR</span>
    </p>
    <p class="text-gray-700">
      Upon request (recommended), AHR provides consultative feedback to refine the 70/20/10 balance, feasibility,
      evidence standards, and risk/support plan‚Äîhelping finalize the IDP before HoD approval.
    </p>
  </li>

  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-purple-500"></div>
    <p class="font-semibold">HoD Approves
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-purple-50 text-purple-700 border border-purple-200">HoD</span>
    </p>
    <p class="text-gray-700">
      HoD validates priorities, confirms resources, and formally approves the IDP via email confirmation.
    </p>
  </li>

  <li>
    <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-green-500"></div>
    <p class="font-semibold">Quarterly Tracking & Reporting (TBD)
      <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-green-50 text-green-700 border border-green-200">Successor + HoD + AHR</span>
    </p>
    <p class="text-gray-700">
      Successors update progress and evidence quarterly (due: last Friday of each quarter); HoDs review and approve;
      AHR consolidates results in Power BI and flags overdue items.
    </p>
  </li>

  <li>
<li>
  <div class="absolute -start-1.5 mt-1.5 h-3 w-3 rounded-full bg-emerald-500"></div>
  <p class="font-semibold text-ashley-orange">
    Bootcamp Program Planning & Execution
    <span class="ml-2 text-[11px] font-semibold px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200">
      Successor + HoD + AHR
    </span>
  </p>
  <p class="text-gray-700">
    Based on the Gap Analysis Summary Report, AHR designs and delivers a structured, multi-day ‚Äúbootcamp‚Äù once per year.  
    This program focuses on the most common competency or skill gaps shared across the successor group through hands-on workshops, mentoring circles, and experiential learning sessions.
  </p>
</li>
</ol>


        <!-- 70‚Äì20‚Äì10 pills -->
        <div class="mt-12">
          <h4 class="text-lg font-semibold text-gray-900 mb-2">70‚Äì20‚Äì10 Learning Framework</h4>

          <div class="inline-flex rounded-lg overflow-hidden border">
            <button class="s4-pill active px-3 py-1.5 text-xs font-semibold bg-ashley-orange text-white" data-pill="p70">70% Doing</button>
            <button class="s4-pill px-3 py-1.5 text-xs font-semibold bg-white text-gray-700" data-pill="p20">20% Others</button>
            <button class="s4-pill px-3 py-1.5 text-xs font-semibold bg-white text-gray-700" data-pill="p10">10% Formal</button>
          </div>

          <div class="mt-3 relative min-h-[230px]">

            <div id="p70" class="s4-pill-panel rounded-xl border p-4">
              <div class="text-base font-semibold text-ashley-orange mb-1">Learning by Doing ‚Äî Practical, hands-on experience in real work settings</div>
              <ul class="list-disc pl-5 space-y-1 text-sm text-gray-800">
                <li>Lead/support a cross-functional strategic project.</li>
                <li>Temporarily take on a managerial role during a manager‚Äôs absence <em>(acting role/ stretch assignment).</em></li>
                <li>Participate in short-term rotations or job shadowing in other teams <em>(without formal transfer).</em></li>
                <li>Join leadership meetings or prepare materials.</li>
                <li>Facilitate mid-year/year-end review discussions for the team.</li>
                <li>Take ownership of a real, unresolved issue in the team and present a proposed solution.</li>
                <li>Contribute to building the team‚Äôs people plan or budget.</li>
              </ul>
            </div>

            <div id="p20" class="s4-pill-panel rounded-xl border p-4 hidden">
              <div class="text-base font-semibold text-ashley-orange mb-1">Learning through Others ‚Äî Development via feedback, mentoring, coaching, and relationships</div>
              <ul class="list-disc pl-5 space-y-1 text-sm text-gray-800">
                <li>Buddy with a more senior or experienced peer.</li>
                <li>Mentoring from a senior leader.</li>
                <li>Join a peer learning group with other successors or high-potential colleagues.</li>
                <li>1:1 coaching from internal or external experts.</li>
                <li>Participate in interactive workshops and engage in peer group reflections or discussions.</li>
                <li>Receive regular leadership-focused feedback from your direct manager <em>(bi-weekly or monthly)</em>.</li>
              </ul>
            </div>

            <div id="p10" class="s4-pill-panel rounded-xl border p-4 hidden">
              <div class="text-base font-semibold text-ashley-orange mb-1">Formal Learning ‚Äî Structured learning activities like classes, workshops, and reading.</div>
              <ul class="list-disc pl-5 space-y-1 text-sm text-gray-800">
                <li>Attend leadership development courses (internal or external).</li>
				<li>Join deep-dive internal training sessions (e.g. on performance management or strategic thinking).</li>
				<li>Receive company support to pursue professional certifications (e.g. PMP, HRBP, CFA...).</li>
				<li>Enroll in short-term executive programs.</li>
				<li>Take curated learning paths on platforms like Udemy.</li>
				<li>Get 1:1 coaching <em>(face-to-face or via MS Teams)</em> from international experts (e.g. AFI) on a structured coaching program.</li>
				<li>Ashley Learning Center Resources.</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Reminder -->
        <div class="mt-6 bg-amber-50 border border-amber-200 rounded-xl p-4">
          <h5 class="font-semibold text-amber-800">‚ö† Ô∏èReminder</h5> 
          <ul class="list-disc pl-5 text-amber-900 text-sm space-y-1 mt-1">
            <li>Ensure successors promptly notify you and AHR of any changes to goals, milestones, timelines, support, or risks.</li>
			<li>Review quarterly updates only when evidence (links/files) is attached and clearly mapped to milestones.</li>
			<li>Provide feedback, confirm priorities/resources, and approve the IDP each quarter (due: last Friday of the quarter).</li>
			<li>Follow up on overdue or low-quality submissions; escalate support/resource gaps to AHR as needed.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ================= Panel: TRACKING & REVIEW ================= -->
    <div id="s4_panel_tracking" class="s4-panel hidden">
      <div class="bg-white rounded-xl border p-4">
<div id="s4_trkFlow" class="grid md:grid-cols-4 gap-4">

  <!-- STEP 1 ¬∑ Successor -->
  <button data-step="1" onclick="s4SetActiveStep(1)"
    class="s4-card relative text-left rounded-xl border border-gray-200 p-4 hover:shadow min-h-[168px]">
    <!-- badge c·ªë ƒë·ªãnh g√≥c ph·∫£i-tr√™n -->
    <span class="absolute top-2.5 right-3 text-[11px] font-semibold px-2 py-0.5 rounded-full border
                 bg-blue-50 text-blue-700 border-blue-200">Successor</span>
    <!-- dot vai tr√≤ -->
    <div class="absolute -top-2 left-4 h-3 w-3 rounded-full bg-blue-500"></div>
    <!-- header: STEP x + title (ch·ª´a ch·ªó badge) -->
    <div class="pt-0.5 pr-16">
      <p class="text-[11px] font-semibold uppercase tracking-wider text-gray-500 leading-none">STEP 1</p>
      <h5 class="font-semibold text-gray-900 mt-1 leading-tight">Draft</h5>
    </div>
    <ul class="list-disc pl-5 text-gray-700 mt-2 space-y-1 text-sm">
      <li>Define quarterly milestones, target dates, and key evidence.</li>
      <li>Align actions with Success Profile gaps and 70‚Äì20‚Äì10 framework.</li>
    </ul>
  </button>

  <!-- STEP 2 ¬∑ HoD -->
  <button data-step="2" onclick="s4SetActiveStep(2)"
    class="s4-card relative text-left rounded-xl border border-gray-200 p-4 hover:shadow min-h-[168px]">
    <span class="absolute top-2.5 right-3 text-[11px] font-semibold px-2 py-0.5 rounded-full border
                 bg-purple-50 text-purple-700 border-purple-200">HoD</span>
    <div class="absolute -top-2 left-4 h-3 w-3 rounded-full bg-purple-500"></div>
    <div class="pt-0.5 pr-16">
      <p class="text-[11px] font-semibold uppercase tracking-wider text-gray-500 leading-none">STEP 2</p>
      <h5 class="font-semibold text-gray-900 mt-1 leading-tight">Review (HoD)</h5>
    </div>
    <ul class="list-disc pl-5 text-gray-700 mt-2 space-y-1 text-sm">
      <li>Validate draft for feasibility, priorities, and resources.</li>
      <li>Provide feedback and approve initial & quarterly plans.</li>
    </ul>
  </button>

  <!-- STEP 3 ¬∑ Successor -->
  <button data-step="3" onclick="s4SetActiveStep(3)"
    class="s4-card relative text-left rounded-xl border border-gray-200 p-4 hover:shadow min-h-[168px]">
    <span class="absolute top-2.5 right-3 text-[11px] font-semibold px-2 py-0.5 rounded-full border
                 bg-blue-50 text-blue-700 border-blue-200">Successor</span>
    <div class="absolute -top-2 left-4 h-3 w-3 rounded-full bg-blue-500"></div>
    <div class="pt-0.5 pr-16">
      <p class="text-[11px] font-semibold uppercase tracking-wider text-gray-500 leading-none">STEP 3</p>
      <h5 class="font-semibold text-gray-900 mt-1 leading-tight">Update (Successor)</h5>
    </div>
    <ul class="list-disc pl-5 text-gray-700 mt-2 space-y-1 text-sm">
      <li>Submit quarterly progress update (by last Friday of each quarter).</li>
      <li>Attach evidence and propose next-quarter actions.</li>
    </ul>
  </button>

<!-- STEP 4 ¬∑ AHR -->
<button data-step="4" onclick="s4SetActiveStep(4)"
  class="s4-card relative text-left rounded-xl border border-gray-200 p-4 hover:shadow min-h-[168px]">
  <span class="absolute top-2.5 right-3 text-[11px] font-semibold px-2 py-0.5 rounded-full border
               bg-amber-50 text-amber-700 border-amber-200">AHR</span>
  <div class="absolute -top-2 left-4 h-3 w-3 rounded-full bg-amber-500"></div>
  <div class="pt-0.5 pr-16">
    <p class="text-[11px] font-semibold uppercase tracking-wider text-gray-500 leading-none">STEP 4</p>
    <h5 class="font-semibold text-gray-900 mt-1 leading-tight">Track & Enable (AHR)</h5>
  </div>
  <ul class="list-disc pl-5 text-gray-700 mt-2 space-y-1 text-sm">
    <li>Monitor IDP submissions and readiness progress in Power BI.
	<li>Plan in-house learning programs for shared development needs.</li>
  </ul>
</button>
</div>


        <!-- Dynamic panel -->
        <div id="s4_stepPanel" class="mt-6 grid md:grid-cols-2 gap-4"></div>
      </div>
    </div>
  </div>

 
  <!-- ================= Scripts (scoped to Stage 4) ================= -->
  <script>
  // ===== Stage 4: Sub-tab switcher (new) =====
function s4ShowTab(key, evt){
  const panels = {
    overview: 's4_panel_overview',
    idp:      's4_panel_idp',
    tracking: 's4_panel_tracking'
  };

  Object.values(panels).forEach(id => document.getElementById(id)?.classList.add('hidden'));
  document.getElementById(panels[key])?.classList.remove('hidden');

  const root = document.getElementById('step-4');
  const btns = root.querySelectorAll('.s4-tab-btn');

  let targetBtn = evt?.currentTarget || null;
  if (!targetBtn) targetBtn = root.querySelector(`.s4-tab-btn[data-tab="${key}"]`);

  btns.forEach(b=>{
    b.classList.remove('border-ashley-orange','text-ashley-orange');
    b.classList.add('border-transparent','text-gray-500');
  });
  if (targetBtn){
    targetBtn.classList.remove('border-transparent','text-gray-500');
    targetBtn.classList.add('border-ashley-orange','text-ashley-orange');
  }

  // ‚úÖ Khi m·ªü subtab Tracking & Review Cycle, auto ch·ªçn Step 1
  if (key === 'tracking') {
    s4SetActiveStep(1);
  }
}


    /* ---------- 70‚Äì20‚Äì10 pills ---------- */
    document.addEventListener('click', (e)=>{
      if(!e.target.classList.contains('s4-pill')) return;
      const target = e.target.getAttribute('data-pill');
      document.querySelectorAll('.s4-pill').forEach(p=>{
        p.classList.remove('bg-ashley-orange','text-white'); p.classList.add('bg-white','text-gray-700');
      });
      e.target.classList.remove('bg-white','text-gray-700'); e.target.classList.add('bg-ashley-orange','text-white');
      document.querySelectorAll('.s4-pill-panel').forEach(p=>p.classList.add('hidden'));
      document.getElementById(target)?.classList.remove('hidden');
    });

    /* ---------- Tracking: dynamic content per step ---------- */
/* ---------- Tracking: dynamic content per step (UPDATED) ---------- */
const CC_LIST = 'anguyen@ashleyfurniture.com,HPhamHong@Ashleyfurniture.com,LTranKhanh@Ashleyfurniture.com';

const STEP_CONTENT = {
  1:{ 
    reminders:{
      title:'‚ö†Ô∏è Important Reminders (Draft)',
      items:[
        'Remind successors to define specific and measurable goals.',
        'Encourage them to plan mentors, exposure projects, or learning resources early in the quarter.',
        'Ensure milestones address real performance or readiness gaps, not generic training.'
      ]
    },
    tips:{
      title:'üí° Tips for HoDs (Draft)',
      items:[
        'Begin each quarter with a short alignment discussion (15‚Äì20 mins).',
        'Ask coaching questions such as:',
        '‚ÄúWhich experience will challenge you most this quarter?‚Äù',
        '‚ÄúWhat support do you need from me or the team?‚Äù'
      ]
    },
    email:{
      title:'üíå Sample 1 ‚Äì Quarterly Kick-off Reminder (HoD ‚Üí Successors)',
      subject:'[Quarter X] IDP Update ‚Äì Set Your Quarterly Milestones',
      body:`Subject: [Quarter X] IDP Update ‚Äì Set Your Quarterly Milestones

Dear Team,
As we start a new quarter, please review your Individual Development Plan (IDP) and set your quarterly milestones based on your Success Profile and current priorities.

Kindly complete and resubmit your updated IDP by [Date ‚Äì last Friday of the quarter].

Focus on 2‚Äì3 key actions this quarter (aligned with 70‚Äì20‚Äì10) and define what evidence will show your progress.

I‚Äôll schedule a brief check-in to review and approve your updates.

Best regards,
[Your Name]
Head of Department`
    }
  },

  2:{ 
    reminders:{
      title:'‚ö†Ô∏è Important Reminders (Review)',
      items:[
        'Focus on quality of learning, not number of actions.',
        'Keep discussions future-oriented and constructive.',
        'Schedule short monthly 1:1 check-ins to monitor progress and remove barriers.'
      ]
    },
    tips:{
      title:'üí° Tips for HoDs (Review)',
      items:[
        'Use SBI feedback (Situation ‚Äì Behavior ‚Äì Impact) to make points concrete.',
        'Document a short summary note in the IDP tracker for transparency.'
      ]
    },
    email:{
      title:'üíå Sample 2 ‚Äì IDP Review & Feedback (HoD ‚Üí Successor, cc AHR)',
      subject:'[Quarter X] IDP Review ‚Äì Feedback and Approval',
      body:`Subject: [Quarter X] IDP Review ‚Äì Feedback and Approval

Hi [Name],
Thank you for submitting your updated IDP.

I‚Äôve reviewed your quarterly plan and appreciate your progress on [specific area]. Please continue focusing on [key priority] this quarter.

Your IDP is now approved for implementation. AHR will include it in the next tracking report.

Regards,
[Your Name]`
    }
  },

  3:{ 
    reminders:{
      title:'‚ö†Ô∏è Important Reminders (Update)',
      items:[
        'Check if progress reflects actual behavioral change or impact.',
        'Encourage successors to share lessons learned in 1:1s or team meetings.',
        'Reinforce the link between updates and Talent Review preparation.'
      ]
    },
    tips:{
      title:'üí° Tips for HoDs (Update)',
      items:[
        'Recognize and celebrate small wins to sustain motivation.',
        'Use quarterly notes to prepare for Mid-Year and Annual Talent Reviews.'
      ]
    },
    email:{
      title:'üíå Sample 3 ‚Äì Quarterly Update Reminder (HoD ‚Üí Successors)',
      subject:'Reminder ‚Äì Submit Your Quarterly IDP Progress by [Date]',
      body:`Subject: Reminder ‚Äì Submit Your Quarterly IDP Progress by [Date]

Dear all,
This is a gentle reminder to update your IDP progress and attach relevant evidence before [Date].

Please summarize your key learnings, results, and proposed focus for the next quarter.

Timely submission ensures your progress is reflected in our departmental readiness dashboard.

Thank you for your cooperation.

Best,
[Your Name]`
    }
  },

  4:{ 
    reminders:{
      title:'‚ö†Ô∏è Important Reminders (AHR ‚Äì Track & Enable)',
      items:[
        'Share quarterly highlights or key blockers with AHR.',
        'Nominate successors for AHR in-house programs matching their IDP focus.',
        'Encourage successors to actively participate when AHR announces new learning activities.'
      ]
    },
    tips:{
      title:'üí° Tips for HoDs (AHR ‚Äì Track & Enable)',
      items:[
        'Use AHR reports to spot high-potential growth or risk cases.',
        'Reinforce attendance and follow-through after each program or mentoring activity.'
      ]
    },
    email:{
      title:'üíå Sample 4 ‚Äì Departmental Progress & Next Learning Opportunities (HoD ‚Üí Team)',
      subject:'IDP Progress Highlights & Learning Programs ‚Äì [Quarter X]',
      body:`Subject: IDP Progress Highlights & Learning Programs ‚Äì [Quarter X]

Dear Team,
A big thank-you for keeping your IDP updates consistent this quarter. Based on our progress report from AHR, our department achieved [XX% on-time submission / readiness improvement].

AHR will announce upcoming in-house learning programs and cross-functional initiatives later this quarter to address shared development needs.
You are encouraged to actively participate and apply the learnings to strengthen your readiness and IDP progress.

Keep up the great work!

Regards,
[Your Name]`
    }
  }
};

/* ---------- Render: LEFT = Reminders + Tips | RIGHT = Email template + mailto ---------- */
function s4SetActiveStep(step){
  // highlight card
  document.querySelectorAll('#s4_trkFlow .s4-card').forEach(c=>{
    c.classList.remove('ring-2','ring-ashley-orange','border-ashley-orange','bg-orange-50/30');
  });
  document.querySelector(`#s4_trkFlow [data-step="${step}"]`)?.classList.add('ring-2','ring-ashley-orange','border-ashley-orange','bg-orange-50/30');

  const data = STEP_CONTENT[step];
  if(!data) return;

  // ‚úÖ Th√™m ƒëo·∫°n x·ª≠ l√Ω n·ªôi dung email ƒë·ªÉ kh√¥ng b·ªã m·∫•t khi m·ªü
  const rawBody = data.email.body.replace(/^Subject:.*\n+/i, ''); // b·ªè d√≤ng Subject
  const bodyForMailto = rawBody.replace(/\n/g, '\r\n'); // gi·ªØ format xu·ªëng d√≤ng chu·∫©n

  const TO_LIST = 'please_replace_by_your_successor_email_list'; // thay b·∫±ng email th·ª±c t·∫ø
  const mailtoHref =
    `mailto:${TO_LIST}` +
    `?cc=${encodeURIComponent(CC_LIST)}` +
    `&subject=${encodeURIComponent(data.email.subject)}` +
    `&body=${encodeURIComponent(bodyForMailto)}`;

  // render n·ªôi dung
  const panel = document.getElementById('s4_stepPanel');
  panel.innerHTML = `
    <!-- LEFT COLUMN: Reminders + Tips -->
    <div class="space-y-3">
      <div class="rounded-xl border border-orange-200 bg-orange-50 p-4 text-orange-800">
        <h6 class="font-semibold mb-2">${data.reminders.title}</h6>
        <ul class="list-disc pl-5 text-sm space-y-1">
          ${data.reminders.items.map(i=>`<li>${i}</li>`).join('')}
        </ul>
      </div>
      <div class="rounded-xl border border-blue-200 bg-blue-50 p-4 text-blue-800">
        <h6 class="font-semibold mb-2">${data.tips.title}</h6>
        <ul class="list-disc pl-5 text-sm space-y-1">
          ${data.tips.items.map(i=>`<li>${i}</li>`).join('')}
        </ul>
      </div>
    </div>

    <!-- RIGHT COLUMN: Email template -->
    <div class="rounded-xl border border-gray-200 bg-gray-50 p-4">
      <h6 class="font-semibold mb-2">${data.email.title}</h6>
      <pre class="bg-white border border-gray-200 rounded-lg p-3 text-xs overflow-auto whitespace-pre-wrap">${rawBody}</pre>
      <a href="${mailtoHref}" class="inline-flex items-center gap-2 mt-2 text-sm font-medium text-blue-700 hover:underline">üìß Open in your email app</a>
    </div>
  `;
}
</script>
</div>


<!-- STAGE 5 CONTENT -->
<div id="step-5" class="step-content hidden">
  <div class="bg-white rounded-xl border p-6 mb-6">
    <!-- Title + timing chip -->
    <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
      <h3 class="text-2xl font-bold text-gray-900">STAGE 5: Talent Review Presentation</h3>
      <span class="inline-flex items-center gap-2 text-sm px-3 py-1 rounded-full border border-amber-300 bg-amber-50 text-amber-700">
        üåº Annual ¬∑ suggested: August
      </span>
    </div>

    <!-- Intro -->
    <p class="text-gray-600 mb-10">
      Provide successors with <strong>a formal platform to present development progress directly to senior leadership</strong>, demonstrate growth,
      share future plans, and receive constructive feedback. This session reinforces accountability, increases successor visibility at senior levels,
      and strengthens long-term commitment to development.
    </p>

    <!-- 3 Columns -->
    <div class="grid md:grid-cols-3 gap-5">
      <!-- Col 1: Purpose -->
      <div class="relative bg-white border rounded-2xl p-5 shadow-sm transition
                  hover:shadow-md hover:border-ashley-orange">
        <!-- Badge number -->
        <div class="absolute -top-6 left-5 h-10 w-10 rounded-full bg-gradient-to-br from-ashley-orange to-orange-400 text-white
                    grid place-items-center text-lg font-extrabold shadow">
          1
        </div>
        <!-- Icon -->
        <div class="mt-6 text-3xl mb-2">üìä</div>

        <h4 class="font-semibold text-gray-900 mb-2">Purpose</h4>
        <p class="text-sm leading-6 text-gray-700">
          Give successors a visible, structured forum to present IDP progress, lessons learned, and next-period plan to a leadership panel.
        </p>

        <!-- Timing highlight -->
        <div class="mt-4 rounded-lg border-l-4 border-ashley-orange bg-gray-50 p-3">
          <p class="text-sm text-gray-800"><span class="font-semibold text-ashley-orange">Timing:</span> Held annually ‚Äî suggested August.</p>
        </div>
      </div>

      <!-- Col 2: Key Moment -->
      <div class="relative bg-white border rounded-2xl p-5 shadow-sm transition
                  hover:shadow-md hover:border-ashley-orange">
        <!-- Badge number -->
        <div class="absolute -top-6 left-5 h-10 w-10 rounded-full bg-gradient-to-br from-ashley-orange to-orange-400 text-white
                    grid place-items-center text-lg font-extrabold shadow">
          2
        </div>
        <!-- Icon -->
        <div class="mt-6 text-3xl mb-2">üé§</div>

        <h4 class="font-semibold text-gray-900 mb-2">Key Moment: The Talent Review Presentation</h4>
        <p class="text-sm text-gray-700 mb-3">Successors share lessons learned, development evidence, and a refined action plan with the panel.</p>

        <h5 class="font-semibold text-gray-900 mb-1">Event Format</h5>
        <ul class="text-sm text-gray-700 space-y-2">
          <li>‚Üí Successor presents IDP progress directly to the panel (Direct Leader, HoD, AHR, senior leaders if available).</li>
          <li>‚Üí Presentation covers <em>lessons learned</em>, <em>key actions</em>, <em>evidence</em>, and <em>next-period IDP</em>.</li>
          <li>‚Üí Panel provides developmental feedback and guidance for next steps.</li>
        </ul>
      </div>

      <!-- Col 3: Ongoing Reporting + Reminders -->
      <div class="relative bg-white border rounded-2xl p-5 shadow-sm transition
                  hover:shadow-md hover:border-ashley-orange">
        <!-- Badge number -->
        <div class="absolute -top-6 left-5 h-10 w-10 rounded-full bg-gradient-to-br from-ashley-orange to-orange-400 text-white
                    grid place-items-center text-lg font-extrabold shadow">
          3
        </div>
        <!-- Icon -->
        <div class="mt-6 text-3xl mb-2">üë•</div>

        <h4 class="font-semibold text-gray-900 mb-2">Ongoing Reporting</h4>
        <p class="text-sm text-gray-700">
          After the presentation, successors revise their IDP based on panel feedback. Quarterly updates feed the AHR dashboard / Power BI tracking.
        </p>

        <!-- Reminder box -->
        <div class="mt-4 rounded-xl border-2 border-amber-300 bg-amber-50 p-4">
          <div class="flex items-center gap-2 mb-2">
            <svg class="w-5 h-5 text-amber-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd"
                d="M9.401 1.592a1.5 1.5 0 012.598 0l6.59 11.667A1.5 1.5 0 0117.34 15H2.66a1.5 1.5 0 01-1.249-2.741L8 1.592zM11 13a1 1 0 10-2 0 1 1 0 002 0zm-.25-6.75a.75.75 0 00-1.5 0v3.5a.75.75 0 001.5 0v-3.5z"
                clip-rule="evenodd"/>
            </svg>
            <h5 class="text-amber-800 font-bold">Important Reminders</h5>
          </div>
          <ul class="space-y-2">
            <li class="flex gap-2">
              <svg class="w-5 h-5 mt-0.5 shrink-0 text-amber-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414l2.293 2.293 6.543-6.543a1 1 0 011.414 0z" clip-rule="evenodd"/>
              </svg>
              <span class="text-[15px] leading-6 text-amber-900">Update IDP immediately after the Talent Review Presentation.</span>
            </li>
            <li class="flex gap-2">
              <svg class="w-5 h-5 mt-0.5 shrink-0 text-amber-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-7.25 7.25a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414l2.293 2.293 6.543-6.543a1 1 0 011.414 0z" clip-rule="evenodd"/>
              </svg>
              <span class="text-[15px] leading-6 text-amber-900">Submit quarterly IDP progress by the last Friday of each quarter.</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- STAGE 6 CONTENT -->
<div id="step-6" class="step-content hidden">
  <div class="bg-white rounded-xl border p-6 mb-6">
    <h3 class="text-2xl font-bold text-gray-900 mb-2">STAGE 6: Continuous Review & Yearly Refresh</h3>
    <p class="text-gray-600 mb-6">
      Sustain the momentum of succession planning by continuously <strong>tracking progress, measuring development impact, and refreshing the Talent Pool annually</strong> to align with evolving business needs and employee readiness.
    </p>

    <!-- KPI TRACKING (blue cards like slide) -->
    <div class="grid md:grid-cols-2 gap-6">
      <!-- Semi-Annual -->
      <div class="bg-white rounded-3xl border-2 border-blue-300 p-5 shadow-sm">
        <!-- centered title with side lines -->
        <div class="flex items-center justify-center gap-3 mb-3">
          <span class="h-px bg-blue-200 flex-1"></span>
          <h4 class="text-blue-800 font-semibold text-lg">Semi-Annual</h4>
          <span class="h-px bg-blue-200 flex-1"></span>
        </div>
        <ul class="text-sm text-gray-800 space-y-2 pl-1">
          <li>‚Ä¢ % of critical roles with at least one identified successor</li>
          <li>‚Ä¢ % of successors submitting IDP updates on time</li>
          <li>‚Ä¢ % of IDP action items completed as planned</li>
          <li>‚Ä¢ Talent Pool participation rate in development activities (workshops, bootcamps, coaching, etc.)</li>
        </ul>
      </div>

      <!-- Annual -->
      <div class="bg-white rounded-3xl border-2 border-blue-300 p-5 shadow-sm">
        <div class="flex items-center justify-center gap-3 mb-3">
          <span class="h-px bg-blue-200 flex-1"></span>
          <h4 class="text-blue-800 font-semibold text-lg">Annual</h4>
          <span class="h-px bg-blue-200 flex-1"></span>
        </div>
        <ul class="text-sm text-gray-800 space-y-2 pl-1">
          <li>‚Ä¢ % of critical positions successfully filled by Talent Pool successors (internal promotion rate)</li>
          <li>‚Ä¢ % of successors progressing in readiness level (e.g., from Ready Later ‚Üí Ready Soon or Ready Immediate)</li>
          <li>‚Ä¢ Talent Pool retention rate (how many remain engaged and active over 12‚Äì18 months)</li>
        </ul>
      </div>
    </div>

    <!-- FEEDBACK & CONTINUOUS IMPROVEMENT (orange cards like slide) -->
    <div class="grid md:grid-cols-2 gap-6 mt-6">
      <!-- Post-Talent Review Feedback -->
      <div class="bg-white rounded-3xl border-2 border-ashley-orange p-5 shadow-sm">
        <div class="flex items-center gap-3 mb-3">
          <h4 class="text-ashley-orange font-semibold text-lg">Post-Talent Review Feedback:</h4>
          <span class="h-px bg-orange-200 flex-1"></span>
        </div>
        <ul class="text-sm text-gray-800 space-y-2 pl-1">
          <li>‚Ä¢ Successor feedback on development experience</li>
          <li>‚Ä¢ HoD satisfaction with successor progress</li>
          <li>‚Ä¢ Training effectiveness based on post-event evaluation</li>
          <li>‚Ä¢ Feedback collected from managers and candidates</li>
        </ul>
      </div>

      <!-- Continuous Improvement -->
      <div class="bg-white rounded-3xl border-2 border-ashley-orange p-5 shadow-sm">
        <div class="flex items-center gap-3 mb-3">
          <h4 class="text-ashley-orange font-semibold text-lg">Continuous Improvement:</h4>
          <span class="h-px bg-orange-200 flex-1"></span>
        </div>
        <ul class="text-sm text-gray-800 space-y-2 pl-1">
          <li>‚Ä¢ Adjust process, tools, and readiness framework based on feedback</li>
          <li>‚Ä¢ Refresh Talent Pool members after annual performance evaluation</li>
          <li>‚Ä¢ Communicate the updated Talent Pool to leadership</li>
          <li>‚Ä¢ Re-enter cycle for the following year</li>
        </ul>
      </div>
    </div>
  </div>
</div>


        <!-- Prev/Next -->
        <div class="flex justify-between">
          <button onclick="previousStep()" id="prev-btn" class="bg-gray-300 text-gray-500 px-6 py-2 rounded-xl cursor-not-allowed" disabled>‚Üê Previous Stage</button>
          <button onclick="nextStep()" id="next-btn" class="bg-ashley-orange text-white px-6 py-2 rounded-xl hover:bg-ashley-orange-dark">Next Stage ‚Üí</button>
        </div>
      </div>
    </section>

<!-- MANAGEMENT HUB TAB -->
<section id="tools-tab" class="tab-content hidden">
  <div class="mb-8">
    <h2 class="text-3xl font-bold text-gray-900 mb-2">Management Hub</h2>
    <p class="text-gray-600 mb-6">Centralized management area ¬∑ Department document folders & IDP Chat Box access</p>

    <!-- ====== ACTIONS: DOC HUB + IDP CHATBOX ====== -->
    <div class="grid md:grid-cols-2 gap-4">
      <!-- Department Document Hub -->
      <div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-ashley-orange rounded-lg flex items-center justify-center">
              <span class="text-white text-xl">üìÅ</span>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">Department Document Hub</h3>
              <p class="text-sm text-gray-500">Access your department‚Äôs SharePoint folder by stage</p>
            </div>
          </div>
        </div>

        <div class="mt-4 grid sm:grid-cols-[1fr_auto] gap-2">
<div class="relative">
  <select id="deptSelect"
    class="w-full rounded-xl border-gray-300 focus:ring-ashley-orange focus:border-ashley-orange 
           py-2.5 px-3 pr-8 text-gray-800 leading-tight appearance-none">
    <option value="" selected>‚Äî Select Department ‚Äî</option>
    <option value="AHR">Asia Human Resources</option>
    <option value="CGI">CGI</option>
    <option value="ENG">Engineering</option>
    <option value="HRA">HR and Administration</option>
    <option value="PD">Product Development</option>
    <option value="QA">Quality Assurance</option>
    <option value="SQE">Sample Quality Engineering</option>
    <option value="SS">Strategic Sourcing</option>
    <option value="SE">Strategy Execution</option>
  </select>
  <!-- custom arrow -->
  <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none">‚ñº</span>
</div>

<a id="deptFolderLink"
   href="#"
   target="_blank"
   rel="noopener"
   class="inline-flex items-center justify-center gap-2 h-[44px] px-4 rounded-xl text-white 
          bg-ashley-orange hover:bg-ashley-orange-dark transition pointer-events-none opacity-50 cursor-not-allowed">
  <span class="text-lg">üîó</span>
  <span class="font-medium">Open Folder</span>
</a>


        </div>

        <p id="deptHint" class="mt-2 text-xs text-gray-500">
          * Each HoD can access only their assigned department folder (SharePoint permissions applied).
        </p>
      </div>

<!-- IDP Chat Box (Coming Soon) -->
<div class="bg-white border rounded-xl p-6 hover:shadow-md transition-shadow">
  <div class="flex items-center gap-3">
    <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
      <span class="text-white text-xl">ü§ñ</span>
    </div>
    <div>
      <div class="flex items-center gap-2">
        <h3 class="font-semibold text-gray-900">IDP Chat Box</h3>
        <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border bg-blue-50 text-blue-700 border-blue-200">
          Coming Soon
        </span>
      </div>
      <p class="text-sm text-gray-500">
        Auto-suggest 70-20-10 activities based on Success Profile & GAP
      </p>
    </div>
  </div>

  <div class="mt-4">
    <button class="w-full px-4 py-2 rounded-xl bg-gray-200 text-gray-500 cursor-not-allowed" disabled>
      üõ†Ô∏è Launch IDP Chat Box
    </button>
    <p class="mt-2 text-xs text-gray-500">* Will connect JD, Success Profile, and GAP data (Step 3) to auto-suggest learning activities.</p>
  </div>
</div>

    </div>
  </div>

<!-- ====== FAQ ‚Äì HoD Responsibilities ====== -->
<div class="mb-10">
  <h2 class="text-2xl font-bold text-gray-900 mb-2">FAQ ‚Äì HoD Responsibilities in Succession Planning</h2>
  <p class="text-gray-600 mb-6">Frequently asked questions to help Heads of Department understand their key actions across each stage.</p>

  <div class="space-y-3">
    <!-- Item 1 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-1', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q1. What am I expected to do regarding identifying critical roles (Stage 1)?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-1" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Review all your team‚Äôs current positions with the scoring criteria provided and combine it with your own experience and judgment‚Äîconsider the positions categorized as High Importance to be involved in the succession planning program.
        </p>
      </div>
    </div>

    <!-- Item 2 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-2', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q2. What am I expected to do regarding identifying talent pool (Stage 2)?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-2" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          You are expected to actively participate in Round 1 ‚Äì HoD Nomination by reviewing the Green Zone participants in the 9-Box Grid. Asia HR will handle Round 2 ‚Äì Candidate Self-Application. Then again, you are expected to actively participate in HoD Review & Position Matching to review applications and match candidates to their suitable positions for Stage 3 ‚Äì Gap Assessment.
        </p>
      </div>
    </div>

    <!-- Item 3 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-3', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q3. How do I participate in the readiness and gap assessment process?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-3" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          You‚Äôll review each candidate‚Äôs self-assessment on competencies and qualifications, provide comments, and determine readiness categories such as ‚ÄúReady Now (‚â§6 months)‚Äù, ‚ÄúReady Soon (‚â§2 years)‚Äù, or ‚ÄúReady Later (‚â•2 years)‚Äù. Those in ‚ÄúReady Now‚Äù or ‚ÄúReady Soon‚Äù move forward to the Talent Pool and IDP development program.
        </p>
      </div>
    </div>

    <!-- Item 4 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-4', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q4. What‚Äôs my role in supporting individual development?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-4" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Help team members set realistic goals through Individual Development Plans (IDPs)‚Äîassigning appropriate work projects, mentorship, or training opportunities. Asia HR will co-facilitate workshops and provide guidance for both HoDs and team members to ensure successful IDP development.
        </p>
      </div>
    </div>

    <!-- Item 5 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-5', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q5. Do I have to attend meetings or workshops about succession planning?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-5" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Yes. You are expected to join scheduled briefings, training sessions, and review meetings organized by HR or program facilitators to stay updated and aligned with the correct process.
        </p>
      </div>
    </div>

    <!-- Item 6 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-6', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q6. What are my communication responsibilities?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-6" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Clearly communicate the framework, expectations, and timelines to your team. Help them understand how to participate and the benefits of being part of the succession planning journey.
        </p>
      </div>
    </div>

    <!-- Item 7 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-7', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q7. As a Head of Department, am I responsible for program administration or just decision-making?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-7" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Your main duties are decision-making and talent development. Administrative work such as tracking and reminders is handled primarily by the Asia HR program organizers.
        </p>
      </div>
    </div>

    <!-- Item 8 -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition">
      <button onclick="toggleAccordion('faq-8', event)" class="w-full flex justify-between items-center text-left p-5 rounded-t-xl bg-gray-50 hover:bg-ashley-orange/10 transition">
        <h4 class="font-semibold text-gray-900">Q8. Will I need to provide feedback about the program?</h4>
        <span class="accordion-icon text-ashley-orange text-lg transition-transform duration-200">‚ñº</span>
      </button>
      <div id="faq-8" class="accordion-content hidden p-5 border-t border-ashley-orange/20 bg-white rounded-b-xl">
        <p class="text-gray-700 leading-relaxed">
          Yes. You are encouraged to share feedback and report issues with program organizers. Your input helps improve the process and resolve challenges affecting your department‚Äôs participation.
        </p>
      </div>
    </div>
  </div>
</div>
</section>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const TAB = document.getElementById("tools-tab"); // scope to THIS tab
  if (!TAB) return;

  const deptLinks = {
    AHR: 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgBWIzxwxUaXRoDCjoEDj_dpAaQun2bgJpm78Ny9LsGtoCo?e=DpbNWR', 
    CGI: 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgCajNj4Z3n-SZPM3rfAWmxUAVBY1tm5GOZMFaDRCuAH7DU?e=jbSfmw',
    ENG: 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgB0Fy46O-t5T5-tYNkOf9_KARsZZgJypbsEglYS7mKpLTg?e=hvZp7d',
    HRA: 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgBJVnW3Eb9KTo0u-8IQX54bAXuPUXgdk5-fbMQPQru0Im8?e=aEfv7E',
    PD : 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgCquSnsK9b5QorYGrRaGLMHAYOSTUqNsdLkvLP8qBt4Tjs?e=Kthyhp',
    QA : 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgCrROQgeKp1Ra9O-JPT3siQAejU5IS3ushLGhk8O358B1c?e=7qjh3E',
    SQE: 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgBg3gz5OsNSTLKVH04dvulXAaqlOhYrskV2PGaRQ6ztjko?e=2vZspD',
    SS : 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgDshiGmTkr0TbsW_5AGO5HHASYDQcj69wm0FNqSthF9xZw?e=zMSzqH',
    SE : 'https://masterashley.sharepoint.com/:f:/s/AsiaTalentManagementCenter-ATMCInternalDocumentManagement/IgCHH1AuunuLS6INrmuwy3vUAbIV3ia07nBAyu1hSCepaPA?e=6xffgG'
  };

  const select   = TAB.querySelector("#deptSelect");
  const openBtn  = TAB.querySelector("#deptFolderLink");

  if (!select || !openBtn) return;

  // Ensure button sits above any overlapping neighbors
  openBtn.classList.add("relative","z-10");

  const getUrl = () => deptLinks[select.value] || "";

  const applyState = () => {
    const url = getUrl();
    if (url) {
      openBtn.href = url;
      openBtn.removeAttribute("aria-disabled");
      openBtn.classList.remove("pointer-events-none","opacity-50","cursor-not-allowed");
      openBtn.target = "_blank";
      openBtn.rel = "noopener";
    } else {
      openBtn.href = "#";
      openBtn.setAttribute("aria-disabled","true");
      openBtn.classList.add("pointer-events-none","opacity-50","cursor-not-allowed");
    }
  };

  // Keep href fresh for right-click/open-new-tab
  ["change","input"].forEach(evt => select.addEventListener(evt, applyState));

  // Always open via JS too (works even if href wasn't updated)
  openBtn.addEventListener("click", (e) => {
    const url = getUrl();
    if (!url) {
      e.preventDefault();
      return;
    }
    e.preventDefault();
    window.open(url, "_blank", "noopener");
  });

  // Initial state
  applyState();
});
function toggleAccordion(id, event) {
  const content = document.getElementById(id);
  const icon = event.currentTarget.querySelector('.accordion-icon');

  // ƒê√≥ng t·∫•t c·∫£ tr·ª´ c√°i ƒëang click
  document.querySelectorAll('.accordion-content').forEach(el => {
    if (el.id !== id) el.classList.add('hidden');
  });
  document.querySelectorAll('.accordion-icon').forEach(el => {
    if (el !== icon) el.textContent = '‚ñº';
  });

  // Toggle hi·ªÉn th·ªã v√† bi·ªÉu t∆∞·ª£ng
  const isHidden = content.classList.contains('hidden');
  content.classList.toggle('hidden');
  icon.textContent = isHidden ? '‚ñ≤' : '‚ñº';
}

// N·∫øu click ra ngo√†i to√†n v√πng FAQ th√¨ g·∫≠p l·∫°i h·∫øt
document.addEventListener('click', (e) => {
  const isInsideFAQ = e.target.closest('.bg-white.border');
  if (!isInsideFAQ) {
    document.querySelectorAll('.accordion-content').forEach(el => el.classList.add('hidden'));
    document.querySelectorAll('.accordion-icon').forEach(el => el.textContent = '‚ñº');
  }
});
</script>
  </main>

 <!-- QUESTION MODAL -->
<div id="questionModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-[60]">
  <div class="bg-white w-full max-w-lg rounded-2xl p-6 shadow-xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold">I have a question!</h3>
      <button onclick="closeQuestionModal()" class="text-gray-500 hover:text-gray-700">‚úñ</button>
    </div>
    <p class="text-sm text-gray-600 mb-3">Type your question below and click send.</p>

    <!-- Form g·ª≠i email (ti·∫øng Vi·ªát kh√¥ng l·ªói) -->
<form onsubmit="sendEmail(event)">
  <textarea id="questionInput" 
            class="w-full border rounded-xl px-3 py-2 mb-3 h-32" 
            placeholder="Submit your question here to send email to our team..."></textarea>
  <div class="flex justify-end gap-2">
    <button type="button" onclick="closeQuestionModal()" 
            class="bg-white border px-3 py-2 rounded-xl">Cancel</button>
    <button type="submit" 
            class="bg-ashley-orange text-white px-3 py-2 rounded-xl">Send</button>
  </div>
</form>

<script>
function sendEmail(e) {
  e.preventDefault();

  const question = document.getElementById("questionInput")?.value.trim() || "";
  if (!question) {
    alert("Please type your question before clicking Send.");
    return;
  }

  // Recipients
  const to = "anguyen@ashleyfurniture.com,HPhamHong@Ashleyfurniture.com,LTranKhanh@Ashleyfurniture.com";

  // Fixed subject (kh√¥ng k√®m Stage hay Tab)
  const subject = encodeURIComponent("[CVRO Succession Playbook] Question from User");

  // Friendly email body
  const body = encodeURIComponent(
`Hello AHR Team,

I have a question regarding the CVRO Succession Planning Playbook.

Question:
"${question}"

Sent on: ${new Date().toLocaleString()}

(Please click Send to share your question with the AHR team.)

Best regards,
[Your Name]`
  );

  // Open default mail app
  window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
}
</script>

  </div>
</div>
<script>
  function showQuestionModal() {
    document.getElementById('questionModal').classList.remove('hidden');
    document.getElementById('questionModal').classList.add('flex');
  }
  function closeQuestionModal() {
    document.getElementById('questionModal').classList.add('hidden');
    document.getElementById('questionModal').classList.remove('flex');
  }
</script>

  <script>
    // ========== State ==========
let currentStep = 1;
let facilitatorMode = false;

    // ========== Tabs (Top-level) ==========
    function showTab(tabName, e){
      // hide all tabs
      document.querySelectorAll('.tab-content').forEach(t=>t.classList.add('hidden'));
      // show selected
      const target = document.getElementById(`${tabName}-tab`);
      if(target){ target.classList.remove('hidden'); }
      // update nav highlight by data attribute
      document.querySelectorAll('.nav-tab').forEach(btn=>{
        if(btn.dataset.tab === tabName){
          btn.classList.add('border-b-2','border-ashley-orange');
        } else {
          btn.classList.remove('border-b-2','border-ashley-orange');
        }
      });
      // if called from CTAs (no event), still highlight via data attribute
      if(e && e.preventDefault) e.preventDefault();
    }


    // ========== Accordions ==========
    function toggleAccordion(id, e){
      const content=document.getElementById(id);
      const icon=e.currentTarget.querySelector('.accordion-icon');
      if(content.classList.contains('hidden')){ content.classList.remove('hidden'); content.classList.add('fade-in'); icon.textContent='‚ñ≤'; }
      else { content.classList.add('hidden'); icon.textContent='‚ñº'; }
    }
	
    // ========== Framework Stepper ==========
    function showStep(stepNum, e){
      currentStep=stepNum;
      document.querySelectorAll('.step-content').forEach(c=>c.classList.add('hidden'));
      const cur = document.getElementById(`step-${stepNum}`); if(cur) cur.classList.remove('hidden');
      document.querySelectorAll('.step-btn').forEach(b=>{ b.classList.remove('bg-ashley-orange','text-white'); b.classList.add('bg-gray-200','text-gray-700'); });
      if(e){ e.target.classList.remove('bg-gray-200','text-gray-700'); e.target.classList.add('bg-ashley-orange','text-white'); }
      const indicators=document.querySelectorAll('.step-indicator'); const lines=document.querySelectorAll('.step-line');
      indicators.forEach((el,i)=>{ if(i<stepNum){ el.classList.remove('bg-gray-300','text-gray-600'); el.classList.add('bg-ashley-orange','text-white'); } else { el.classList.remove('bg-ashley-orange','text-white'); el.classList.add('bg-gray-300','text-gray-600'); } });
      lines.forEach((ln,i)=>{ if(i<stepNum-1){ ln.classList.remove('bg-gray-300'); ln.classList.add('bg-ashley-orange'); } else { ln.classList.remove('bg-ashley-orange'); ln.classList.add('bg-gray-300'); } });
	  document.getElementById('stepLabel').textContent = `Stage ${stepNum} of 6`;
      const prevBtn=document.getElementById('prev-btn'); const nextBtn=document.getElementById('next-btn');
      if(stepNum===1){ prevBtn.disabled=true; prevBtn.classList.add('cursor-not-allowed','bg-gray-300','text-gray-500'); }
      else { prevBtn.disabled=false; prevBtn.classList.remove('cursor-not-allowed','bg-gray-300','text-gray-500'); prevBtn.classList.add('bg-ashley-orange','text-white'); }
      nextBtn.textContent=(stepNum===6)?'Complete':'Next ‚Üí';
    }
	function nextStep(){ if(currentStep<6) showStep(currentStep+1);window.scrollTo({ top: 0, behavior: 'smooth' });
}
	function previousStep(){ if(currentStep>1) showStep(currentStep-1); window.scrollTo({ top: 0, behavior: 'smooth' });
}

    // ========== STAGE 1 inner tabs (IDs prefixed to avoid collisions) ==========
    function showStepTab(tabName, e){
      const scope = document.getElementById('step-1');
      scope.querySelectorAll('.step-tab-content').forEach(t=>t.classList.add('hidden'));
      const id = `s1-${tabName}-tab`;
      const tgt = document.getElementById(id);
      if(tgt){ tgt.classList.remove('hidden'); }
      scope.querySelectorAll('.step-tab-btn').forEach(b=>{ b.classList.remove('border-ashley-orange','text-ashley-orange'); b.classList.add('border-transparent','text-gray-500'); });
      if(e){ e.target.classList.remove('border-transparent','text-gray-500'); e.target.classList.add('border-ashley-orange','text-ashley-orange'); }
    }


  function goToFrameworkStep(stepNum) {
    // Ch·ªâ m·ªü tab Framework
    if (typeof showTab === "function") {
      showTab('framework');
    }

    // Hi·ªÉn th·ªã ƒë√∫ng Stage
    if (typeof showStep === "function") {
      showStep(stepNum);
    }

    // Kh√¥ng scroll, kh√¥ng move viewport
  }

    // ========== QR Board ==========
    function question(){ const m=document.getElementById('qrModal'); m.classList.remove('hidden'); m.classList.add('flex'); }
    function closeQRBoard(){ const m=document.getElementById('qrModal'); m.classList.add('hidden'); m.classList.remove('flex'); }
    function copyQRLink(){ const i=document.getElementById('qrInput'); if(!i.value) return alert('Paste a link first'); navigator.clipboard.writeText(i.value).then(()=>alert('Link copied')); }

 // ========== Init ==========
  document.addEventListener('DOMContentLoaded', ()=>{ showTab('home'); });
</script>

<!-- =================== SEARCH MODAL (HTML) =================== -->
<div id="searchModal" 
     class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-[100]">
  <div class="bg-white w-full max-w-lg rounded-2xl p-6 shadow-xl">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold text-gray-800">üîé Search Playbook</h3>
      <button onclick="closeSearchModal()" class="text-gray-500 hover:text-gray-700">‚úñ</button>
    </div>
    <input id="searchInput"
           type="text"
           placeholder="Enter keyword (e.g. Stage 3, IDP, Criteria...)"
           class="w-full border rounded-xl px-3 py-2 mb-4 focus:ring-2 focus:ring-orange-300 focus:outline-none" />
    <div id="searchResults" class="max-h-64 overflow-y-auto text-sm space-y-2 text-gray-700"></div>
  </div>
</div>

<!-- =================== SEARCH MODAL (JS) =================== -->
<script>
  /* Open / Close */
  function openSearchModal() {
    const m = document.getElementById('searchModal');
    m.classList.remove('hidden'); m.classList.add('flex');
    const ip = document.getElementById('searchInput');
    ip.value = '';
    document.getElementById('searchResults').innerHTML = '';
    ip.focus();
  }
  function closeSearchModal() {
    const m = document.getElementById('searchModal');
    m.classList.add('hidden'); m.classList.remove('flex');
    clearHighlights();
  }
  /* ====== Utils ====== */
  function getTextNoCode(el){
  if(!el) return '';
  const clone = el.cloneNode(true);
  clone.querySelectorAll('code,pre,script,style').forEach(n=>n.remove());
  return (clone.innerText || clone.textContent || '').trim();
}

  function escReg(s){ return s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }

  function buildSnippet(text, query, pad=80){
    const q = query.trim();
    if(!q) return '';
    const re = new RegExp(escReg(q), 'i');
    const m = text.match(re);
    if(!m) return '';
    const i = m.index;
    const start = Math.max(0, i - pad);
    const end   = Math.min(text.length, i + q.length + pad);
    let snippet = text.slice(start, end);
    // th√™m d·∫•u ‚Ä¶ n·∫øu c·∫Øt ƒë·∫ßu/cu·ªëi
    if(start>0) snippet = '‚Ä¶' + snippet;
    if(end<text.length) snippet = snippet + '‚Ä¶';
    // highlight trong snippet
    snippet = snippet.replace(new RegExp(escReg(q), 'ig'), (s)=>`<mark>${s}</mark>`);
    return snippet;
  }

  function clearHighlights(){
    document.querySelectorAll('mark.search-highlight').forEach(mark=>{
      const text = document.createTextNode(mark.textContent);
      mark.parentNode.replaceChild(text, mark);
    });
  }

  function highlightIn(container, query){
    if(!container || !query) return;
    const selector = 'h1,h2,h3,h4,h5,h6,p,li,span,td,th';
    const re = new RegExp(escReg(query), 'ig');
    let firstHit = null;

    container.querySelectorAll(selector).forEach(el=>{
      // b·ªè qua c√°c v√πng c√≥ qu√° nhi·ªÅu t∆∞∆°ng t√°c/HTML
      if(el.closest('button, a, input, textarea, select, code, pre, script, style')) return;
      const html = el.innerHTML;
      if(!html) return;
      if(!re.test(el.textContent)) return;
      // thay th·∫ø tr√™n innerHTML (ƒë∆°n gi·∫£n, ƒë·ªß an to√†n cho text/heading)
      const replaced = html.replace(re, (s)=>{
        if(!firstHit) firstHit = true; // ƒë√°nh d·∫•u ƒë√£ c√≥ hit ƒë·∫ßu ti√™n
        return `<mark class="search-highlight">${s}</mark>`;
      });
      el.innerHTML = replaced;
    });

    // cu·ªôn ƒë·∫øn highlight ƒë·∫ßu ti√™n
    const first = container.querySelector('mark.search-highlight');
    if(first && first.scrollIntoView){
      first.scrollIntoView({ behavior:'smooth', block:'center' });
    } else {
      window.scrollTo({ top:0, behavior:'smooth' });
    }
  }

  /* ====== Push result item ====== */
  function addResult(list, label, tab, step, anchorSelector, snippet){
    list.push({ label, tab, step, anchorSelector, snippet });
  }

  /* ====== Build results with snippets (c√≥ c·∫£ inner tabs c·ªßa Step 1) ====== */
  function buildSearchResults(query){
    const q = (query||'').trim().toLowerCase();
    const results = [];
    if(!q) return results;

    // HOME
    const home = document.getElementById('home-tab');
    if(home && getTextNoCode(home).toLowerCase().includes(q)){
      addResult(
        results,
        'Home',
        'home',
        null,
        '#home-tab h1',
        buildSnippet(getTextNoCode(home), query)
      );
    }

    // FRAMEWORK: Step 1-6
    for(let i=1;i<=6;i++){
      const stepEl = document.getElementById(`step-${i}`);
      if(stepEl && getTextNoCode(stepEl).toLowerCase().includes(q)){
        const h = stepEl.querySelector('h2,h3,h4');
        addResult(
          results,
          `Framework ‚Üí Stage ${i}`,
          'framework',
          i,
          h ? null : null, // anchor s·∫Ω t·ª± t√¨m h2/h3/h4 trong click
          buildSnippet(getTextNoCode(stepEl), query)
        );
      }
    }

    // Step 1 inner tabs (Overview, Criteria, Scoring, Profile, Tools)
    const innerTabs = [
      { key: 'overview', id: 's1-overview-tab', label: 'Framework ‚Üí Stage 1 ‚Üí Overview' },
      { key: 'criteria', id: 's1-criteria-tab', label: 'Framework ‚Üí Stage 1 ‚Üí Criteria' },
      { key: 'profile',  id: 's1-profile-tab',  label: 'Framework ‚Üí Stage 1 ‚Üí Success Profile' },
    ];

    innerTabs.forEach(t=>{
      const el = document.getElementById(t.id);
      if(el && getTextNoCode(el).toLowerCase().includes(q)){
        addResult(
          results,
          t.label,
          'framework',
          1,
          `#${t.id}`,
          buildSnippet(getTextNoCode(el), query)
        );
      }
    });

    // TOOLS
    const tools = document.getElementById('tools-tab');
    if(tools && getTextNoCode(tools).toLowerCase().includes(q)){
      addResult(
        results,
        'Management Hub',
        'tools',
        null,
        '#tools-tab h2',
        buildSnippet(getTextNoCode(tools), query)
      );
    }

    return results;
  }

  /* ====== Render list + click to navigate & highlight ====== */
  function renderSearchResults(results, query){
    const box = document.getElementById('searchResults');
    box.innerHTML = '';

    if(!results.length){
      box.innerHTML = '<p class="text-gray-500 italic">No matches found.</p>';
      return;
    }

    results.forEach((r, idx)=>{
      const item = document.createElement('button');
      item.type = 'button';
      item.className = 'w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 border';
      const snippetHtml = r.snippet ? `<div class="text-xs text-gray-600 search-snippet mt-1">${r.snippet}</div>` : '';
      item.innerHTML = `
        <div class="font-medium">${r.label}</div>
        <div class="text-[11px] text-gray-500">Go to ${r.tab}${r.step ? ' ¬∑ Stage ' + r.step : ''}</div>
        ${snippetHtml}
      `;

      item.addEventListener('click', ()=>{
        // 1) m·ªü ƒë√∫ng tab
        showTab(r.tab);

        // 2) n·∫øu l√† Framework v√† c√≥ step ‚Üí m·ªü step
        if(r.tab==='framework' && r.step){
          showStep(r.step);
        }

        // 3) x√°c ƒë·ªãnh container ƒë·ªÉ highlight
        let container = null;
        if(r.tab==='framework' && r.step){
          container = document.getElementById(`step-${r.step}`);
          // n·∫øu l√† inner tab
          if(r.anchorSelector && r.anchorSelector.startsWith('#s1-')){
            // m·ªü inner tab t∆∞∆°ng ·ª©ng
            const key = r.anchorSelector.replace(/^#s1-/, '').replace(/-tab$/,'');
            if(typeof showStepTab === 'function'){
              showStepTab(key);
            }
          }
        } else {
          container = document.getElementById(`${r.tab}-tab`);
        }

        // 4) highlight + scroll
        setTimeout(()=>{
          clearHighlights();
          if(container){
            highlightIn(container, document.getElementById('searchInput').value);
          } else {
            window.scrollTo({ top:0, behavior:'smooth' });
          }
        }, 0);

        // 5) ƒë√≥ng modal
        closeSearchModal();
      });

      box.appendChild(item);

      if(idx < results.length-1){
        const hr = document.createElement('div');
        hr.className = 'border-b my-1';
        box.appendChild(hr);
      }
    });
  }

  /* ====== Live search ====== */
  document.getElementById('searchInput').addEventListener('input', function(e){
    const q = e.target.value || '';
    const results = buildSearchResults(q);
    renderSearchResults(results, q);
  });
</script>
<script>
/* ========== Search highlight: ch·ªâ ch·∫°y khi click k·∫øt qu·∫£ ========== */
(function(){
  let highlightTimer = null;

  function escapeRegex(s){
    return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }

  // Th√°o to√†n b·ªô <mark class="search-highlight"> trong scope (ho·∫∑c to√†n trang)
  function clearHighlights(scope){
    const root = scope || document;
    const marks = root.querySelectorAll('mark.search-highlight');
    marks.forEach(m => {
      const text = document.createTextNode(m.textContent);
      m.parentNode.replaceChild(text, m);
    });
    // G·ªôp text node li·ªÅn k·ªÅ cho s·∫°ch DOM
    (root.normalize && root.normalize());
  }

  // B·ªçc t·ª´ kho√° b·∫±ng <mark> trong container ch·ªâ ƒë·ªãnh
  function highlightIn(container, term){
    if (!container || !term) return 0;
    const words = term.trim().split(/\s+/).filter(Boolean);
    if (!words.length) return 0;

    const rx = new RegExp('(' + words.map(escapeRegex).join('|') + ')', 'gi');

    // Duy·ªát text node v√† b·ªçc match
    const walker = document.createTreeWalker(
      container,
      NodeFilter.SHOW_TEXT,
      {
        acceptNode(node){
          if (!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
          const p = node.parentNode;
          if (!p) return NodeFilter.FILTER_REJECT;
          const tag = p.nodeName.toLowerCase();
          if (tag === 'script' || tag === 'style' || tag === 'noscript' || tag === 'mark') {
            return NodeFilter.FILTER_REJECT;
          }
          return rx.test(node.nodeValue) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
        }
      }
    );

    let count = 0;
    const toProcess = [];
    while (walker.nextNode()) toProcess.push(walker.currentNode);

    toProcess.forEach(textNode => {
      const frag = document.createDocumentFragment();
      const parts = textNode.nodeValue.split(rx); // [text, match, text, match...]
      for (let i = 0; i < parts.length; i++){
        const seg = parts[i];
        if (!seg) continue;
        if (rx.test(seg) && i % 2 === 1){
          const mark = document.createElement('mark');
          mark.className = 'search-highlight';
          mark.textContent = seg;
          frag.appendChild(mark);
          count++;
        } else {
          frag.appendChild(document.createTextNode(seg));
        }
      }
      textNode.parentNode.replaceChild(frag, textNode);
    });

    return count;
  }

  // Cu·ªôn t·ªõi highlight ƒë·∫ßu ti√™n trong container
  function scrollFirstHighlight(container){
    const first = container.querySelector('mark.search-highlight');
    if (first){
      first.scrollIntoView({behavior:'smooth', block:'center'});
    }
  }

  // Public API: g·ªçi h√†m n√†y khi click 1 k·∫øt qu·∫£ search
  // opts = { tab?: 'home'|'framework'|'tools'|'metrics'|'faq', step?: 1..6, container: 'CSS selector', term: 't·ª´ kho√°' }
  window.goToAndHighlight = function(opts){
    if (!opts || !opts.container || !opts.term) return;

    // H·ªßy timer & g·ª° highlight c≈© tr∆∞·ªõc khi ƒëi·ªÅu h∆∞·ªõng
    if (highlightTimer){ clearTimeout(highlightTimer); highlightTimer = null; }
    clearHighlights(document);

    // ƒêi·ªÅu h∆∞·ªõng: tab -> step (n·∫øu c√≥)
    if (opts.tab) window.showTab && window.showTab(opts.tab);
    if (opts.step) window.showStep && window.showStep(Number(opts.step));

    // Ch·ªù DOM render sau showTab/showStep r·ªìi m·ªõi highlight
    requestAnimationFrame(() => {
      const container = document.querySelector(opts.container);
      if (!container) return;

      // Ch·ªâ highlight trong ƒë√∫ng container c·ªßa k·∫øt qu·∫£
      const total = highlightIn(container, opts.term);
      if (total > 0){
        scrollFirstHighlight(container);
        // T·ª± g·ª° sau 5s (th√°o h·∫≥n <mark>)
        highlightTimer = setTimeout(() => {
          clearHighlights(container);
          highlightTimer = null;
        }, 5000);
      }
    });
  };

  // G·ª° highlight khi ƒë·ªïi TAB (ƒë·ªÉ kh√¥ng ‚Äús√°ng‚Äù l·∫°i khi quay l·∫°i)
  if (window.showTab){
    const _showTab = window.showTab;
    window.showTab = function(tabName, e){
      if (highlightTimer){ clearTimeout(highlightTimer); highlightTimer = null; }
      clearHighlights(document);
      return _showTab.call(this, tabName, e);
    };
  }

  // G·ª° highlight khi ƒë·ªïi STEP trong Framework
  if (window.showStep){
    const _showStep = window.showStep;
    window.showStep = function(stepNum, e){
      if (highlightTimer){ clearTimeout(highlightTimer); highlightTimer = null; }
      // Ch·ªâ c·∫ßn s·∫°ch trong khu v·ª±c framework ƒë·ªÉ nhanh
      const fw = document.getElementById('framework-tab');
      clearHighlights(fw || document);
      return _showStep.call(this, stepNum, e);
    };
  }
})();
</script>
<script>
  // ƒê∆∞·ªùng d·∫´n CSV (ch·ªâ ch·ª©a link)
  const CSV_URL = "./assets/links.csv";

  // Parser CSV g·ªçn (kh√¥ng c·∫ßn th∆∞ vi·ªán)
  function parseCSV(text) {
    const lines = text.replace(/^\uFEFF/, "").trim().split(/\r?\n/);
    const headers = lines[0].split(",").map(s => s.trim());
    return lines.slice(1).filter(Boolean).map(line => {
      // t√°ch ƒë∆°n gi·∫£n; n·∫øu c√≥ nhi·ªÅu d·∫•u ph·∫©y trong d·∫•u ngo·∫∑c k√©p, h√£y d√πng parser n√¢ng cao
      const cols = [];
      let cur = "", q = false;
      for (let i = 0; i < line.length; i++) {
        const ch = line[i];
        if (ch === '"') {
          if (q && line[i+1] === '"') { cur += '"'; i++; } else { q = !q; }
        } else if (ch === ',' && !q) { cols.push(cur); cur = ""; }
        else cur += ch;
      }
      cols.push(cur);
      const obj = {};
      headers.forEach((h, i) => obj[h] = (cols[i] ?? "").replace(/^"|"$/g,"").trim());
      return obj;
    });
  }

  async function wireLinksFromCSV() {
    try {
      const res = await fetch(`${CSV_URL}?v=${Date.now()}`, { cache: 'no-store' });
      if (!res.ok) throw new Error(`CSV fetch failed ${res.status}`);
      const text = await res.text();
      const rows = parseCSV(text);

      // T·∫°o map theo id trong CSV
      const mapById = Object.fromEntries(rows.map(r => [r.id, r]));

      // T√¨m t·∫•t c·∫£ ph·∫ßn t·ª≠ c√≥ data-link-id
      document.querySelectorAll("[data-link-id]").forEach(el => {
        const key = el.getAttribute("data-link-id");
        const item = mapById[key];
        if (!item || !item.url) return;
        el.setAttribute("href", item.url);
        // Kh√¥ng ƒë·ª•ng target/style/text ‚Äî b·∫°n ƒë√£ ki·ªÉm so√°t trong HTML
      });

    } catch (err) {
      console.error("Wire CSV links error:", err);
      // (tu·ª≥ ch·ªçn) hi·ªÉn th·ªã th√¥ng b√°o l·ªói ·ªü ƒë√¢u ƒë√≥ n·∫øu b·∫°n mu·ªën
    }
  }

  window.linksReady = wireLinksFromCSV();
</script>
</body>
</html>